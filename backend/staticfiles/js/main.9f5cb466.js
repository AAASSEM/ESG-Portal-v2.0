/*! For license information please see main.9f5cb466.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,a)=>{e.exports=a(202)},153:(e,t,a)=>{var n=a(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,a){var n,s={},c=null,d=null;for(n in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)l.call(t,n)&&!o.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:r,type:e,key:c,ref:d,props:s,_owner:i.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var a=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,x={};function h(e,t,a){this.props=e,this.context=t,this.refs=x,this.updater=a||p}function y(){}function b(e,t,a){this.props=e,this.context=t,this.refs=x,this.updater=a||p}h.prototype.isReactComponent={},h.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},h.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=h.prototype;var v=b.prototype=new y;v.constructor=b,g(v,h.prototype),v.isPureReactComponent=!0;var j=Array.isArray,w=Object.prototype.hasOwnProperty,N={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,n){var r,s={},l=null,i=null;if(null!=t)for(r in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(l=""+t.key),t)w.call(t,r)&&!k.hasOwnProperty(r)&&(s[r]=t[r]);var o=arguments.length-2;if(1===o)s.children=n;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===s[r]&&(s[r]=o[r]);return{$$typeof:a,type:e,key:l,ref:i,props:s,_owner:N.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===a}var C=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function P(e,t,r,s,l){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var o=!1;if(null===e)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case a:case n:o=!0}}if(o)return l=l(o=e),e=""===s?"."+E(o,0):s,j(l)?(r="",null!=e&&(r=e.replace(C,"$&/")+"/"),P(l,t,r,"",function(e){return e})):null!=l&&(_(l)&&(l=function(e,t){return{$$typeof:a,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(l,r+(!l.key||o&&o.key===l.key?"":(""+l.key).replace(C,"$&/")+"/")+e)),t.push(l)),1;if(o=0,s=""===s?".":s+":",j(e))for(var c=0;c<e.length;c++){var d=s+E(i=e[c],c);o+=P(i,t,r,d,l)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(i=e.next()).done;)o+=P(i=i.value,t,r,d=s+E(i,c++),l);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function M(e,t,a){if(null==e)return e;var n=[],r=0;return P(e,n,"","",function(e){return t.call(a,e,r++)}),n}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},D={transition:null},R={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:D,ReactCurrentOwner:N};function F(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:M,forEach:function(e,t,a){M(e,function(){t.apply(this,arguments)},a)},count:function(e){var t=0;return M(e,function(){t++}),t},toArray:function(e){return M(e,function(e){return e})||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=h,t.Fragment=r,t.Profiler=l,t.PureComponent=b,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=F,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),s=e.key,l=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(l=t.ref,i=N.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)w.call(t,c)&&!k.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==o?o[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=n;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];r.children=o}return{$$typeof:a,type:e.type,key:s,ref:l,props:r,_owner:i}},t.createContext=function(e){return(e={$$typeof:o,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:m,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=F,t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,a){return A.current.useImperativeHandle(e,t,a)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,a){return A.current.useReducer(e,t,a)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,a){return A.current.useSyncExternalStore(e,t,a)},t.useTransition=function(){return A.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function a(e,t){var a=e.length;e.push(t);e:for(;0<a;){var n=a-1>>>1,r=e[n];if(!(0<s(r,t)))break e;e[n]=t,e[a]=r,a=n}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],a=e.pop();if(a!==t){e[0]=a;e:for(var n=0,r=e.length,l=r>>>1;n<l;){var i=2*(n+1)-1,o=e[i],c=i+1,d=e[c];if(0>s(o,a))c<r&&0>s(d,o)?(e[n]=d,e[c]=a,n=c):(e[n]=o,e[i]=a,n=i);else{if(!(c<r&&0>s(d,a)))break e;e[n]=d,e[c]=a,n=c}}}return t}function s(e,t){var a=e.sortIndex-t.sortIndex;return 0!==a?a:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var l=performance;t.unstable_now=function(){return l.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var c=[],d=[],u=1,m=null,f=3,p=!1,g=!1,x=!1,h="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function v(e){for(var t=n(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,a(c,t)}t=n(d)}}function j(e){if(x=!1,v(e),!g)if(null!==n(c))g=!0,D(w);else{var t=n(d);null!==t&&R(j,t.startTime-e)}}function w(e,a){g=!1,x&&(x=!1,y(_),_=-1),p=!0;var s=f;try{for(v(a),m=n(c);null!==m&&(!(m.expirationTime>a)||e&&!P());){var l=m.callback;if("function"===typeof l){m.callback=null,f=m.priorityLevel;var i=l(m.expirationTime<=a);a=t.unstable_now(),"function"===typeof i?m.callback=i:m===n(c)&&r(c),v(a)}else r(c);m=n(c)}if(null!==m)var o=!0;else{var u=n(d);null!==u&&R(j,u.startTime-a),o=!1}return o}finally{m=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,k=!1,S=null,_=-1,C=5,E=-1;function P(){return!(t.unstable_now()-E<C)}function M(){if(null!==S){var e=t.unstable_now();E=e;var a=!0;try{a=S(!0,e)}finally{a?N():(k=!1,S=null)}}else k=!1}if("function"===typeof b)N=function(){b(M)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,A=T.port2;T.port1.onmessage=M,N=function(){A.postMessage(null)}}else N=function(){h(M,0)};function D(e){S=e,k||(k=!0,N())}function R(e,a){_=h(function(){e(t.unstable_now())},a)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,D(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var a=f;f=t;try{return e()}finally{f=a}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=f;f=e;try{return t()}finally{f=a}},t.unstable_scheduleCallback=function(e,r,s){var l=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?l+s:l:s=l,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:s,expirationTime:i=s+i,sortIndex:-1},s>l?(e.sortIndex=s,a(d,e),null===n(c)&&e===n(d)&&(x?(y(_),_=-1):x=!0,R(j,s-l))):(e.sortIndex=i,a(c,e),g||p||(g=!0,D(w))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=f;return function(){var a=f;f=t;try{return e.apply(this,arguments)}finally{f=a}}}},391:(e,t,a)=>{var n=a(950);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},579:(e,t,a)=>{e.exports=a(153)},730:(e,t,a)=>{var n=a(43),r=a(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,i={};function o(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(i[e]=t,e=0;e<t.length;e++)l.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,a,n,r,s,l){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=a,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=l}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){x[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];x[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){x[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){x[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){x[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){x[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){x[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){x[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){x[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var h=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,a,n){var r=x.hasOwnProperty(t)?x[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,a,n){if(null===t||"undefined"===typeof t||function(e,t,a,n){if(null!==a&&0===a.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==a?!a.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,a,n))return!0;if(n)return!1;if(null!==a)switch(a.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,a,r,n)&&(a=null),n||null===r?function(e){return!!u.call(p,e)||!u.call(f,e)&&(m.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===a?e.removeAttribute(t):e.setAttribute(t,""+a)):r.mustUseProperty?e[r.propertyName]=null===a?3!==r.type&&"":a:(t=r.attributeName,n=r.attributeNamespace,null===a?e.removeAttribute(t):(a=3===(r=r.type)||4===r&&!0===a?"":""+a,n?e.setAttributeNS(n,t,a):e.setAttribute(t,a))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(h,y);x[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(h,y);x[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(h,y);x[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){x[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),x.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){x[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var v=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),C=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var O,L=Object.assign;function U(e){if(void 0===O)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var z=!1;function I(e,t){if(!e||z)return"";z=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=n.stack.split("\n"),l=r.length-1,i=s.length-1;1<=l&&0<=i&&r[l]!==s[i];)i--;for(;1<=l&&0<=i;l--,i--)if(r[l]!==s[i]){if(1!==l||1!==i)do{if(l--,0>--i||r[l]!==s[i]){var o="\n"+r[l].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}}while(1<=l&&0<=i);break}}}finally{z=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?U(e):""}function G(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=I(e.type,!1);case 11:return e=I(e.type.render,!1);case 1:return e=I(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case w:return"Portal";case S:return"Profiler";case k:return"StrictMode";case P:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return W(e(t))}catch(a){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function B(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof a&&"function"===typeof a.get&&"function"===typeof a.set){var r=a.get,s=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),n="";return e&&(n=q(e)?e.checked?"true":"false":e.value),(e=n)!==a&&(t.setValue(e),!0)}function $(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var a=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=a?a:e._wrapperState.initialChecked})}function Y(e,t){var a=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;a=B(null!=t.value?t.value:a),e._wrapperState={initialChecked:n,initialValue:a,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){J(e,t);var a=B(t.value),n=t.type;if(null!=a)"number"===n?(0===a&&""===e.value||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,a):t.hasOwnProperty("defaultValue")&&ee(e,t.type,B(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,a){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,a||t===e.value||(e.value=t),e.defaultValue=t}""!==(a=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==a&&(e.name=a)}function ee(e,t,a){"number"===t&&$(e.ownerDocument)===e||(null==a?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var te=Array.isArray;function ae(e,t,a,n){if(e=e.options,t){t={};for(var r=0;r<a.length;r++)t["$"+a[r]]=!0;for(a=0;a<e.length;a++)r=t.hasOwnProperty("$"+e[a].value),e[a].selected!==r&&(e[a].selected=r),r&&n&&(e[a].defaultSelected=!0)}else{for(a=""+B(a),t=null,r=0;r<e.length;r++){if(e[r].value===a)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var a=t.value;if(null==a){if(a=t.children,t=t.defaultValue,null!=a){if(null!=t)throw Error(s(92));if(te(a)){if(1<a.length)throw Error(s(93));a=a[0]}t=a}null==t&&(t=""),a=t}e._wrapperState={initialValue:B(a)}}function se(e,t){var a=B(t.value),n=B(t.defaultValue);null!=a&&((a=""+a)!==e.value&&(e.value=a),null==t.defaultValue&&e.defaultValue!==a&&(e.defaultValue=a)),null!=n&&(e.defaultValue=""+n)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,a,n){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function me(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&3===a.nodeType)return void(a.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,a){return null==t||"boolean"===typeof t||""===t?"":a||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function xe(e,t){for(var a in e=e.style,t)if(t.hasOwnProperty(a)){var n=0===a.indexOf("--"),r=ge(a,t[a],n);"float"===a&&(a="cssFloat"),n?e.setProperty(a,r):e[a]=r}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var he=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(he[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function je(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ne=null,ke=null;function Se(e){if(e=br(e)){if("function"!==typeof we)throw Error(s(280));var t=e.stateNode;t&&(t=jr(t),we(e.stateNode,e.type,t))}}function _e(e){Ne?ke?ke.push(e):ke=[e]:Ne=e}function Ce(){if(Ne){var e=Ne,t=ke;if(ke=Ne=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ee(e,t){return e(t)}function Pe(){}var Me=!1;function Te(e,t,a){if(Me)return e(t,a);Me=!0;try{return Ee(e,t,a)}finally{Me=!1,(null!==Ne||null!==ke)&&(Pe(),Ce())}}function Ae(e,t){var a=e.stateNode;if(null===a)return null;var n=jr(a);if(null===n)return null;a=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(a&&"function"!==typeof a)throw Error(s(231,t,typeof a));return a}var De=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){De=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){De=!1}function Fe(e,t,a,n,r,s,l,i,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(a,c)}catch(d){this.onError(d)}}var Oe=!1,Le=null,Ue=!1,ze=null,Ie={onError:function(e){Oe=!0,Le=e}};function Ge(e,t,a,n,r,s,l,i,o){Oe=!1,Le=null,Fe.apply(Ie,arguments)}function We(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Be(e){if(We(e)!==e)throw Error(s(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(s(188));return t!==e?null:e}for(var a=e,n=t;;){var r=a.return;if(null===r)break;var l=r.alternate;if(null===l){if(null!==(n=r.return)){a=n;continue}break}if(r.child===l.child){for(l=r.child;l;){if(l===a)return Be(r),e;if(l===n)return Be(r),t;l=l.sibling}throw Error(s(188))}if(a.return!==n.return)a=r,n=l;else{for(var i=!1,o=r.child;o;){if(o===a){i=!0,a=r,n=l;break}if(o===n){i=!0,n=r,a=l;break}o=o.sibling}if(!i){for(o=l.child;o;){if(o===a){i=!0,a=l,n=r;break}if(o===n){i=!0,n=l,a=r;break}o=o.sibling}if(!i)throw Error(s(189))}}if(a.alternate!==n)throw Error(s(190))}if(3!==a.tag)throw Error(s(188));return a.stateNode.current===a?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Qe=r.unstable_scheduleCallback,$e=r.unstable_cancelCallback,Ke=r.unstable_shouldYield,Ye=r.unstable_requestPaint,Je=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,at=r.unstable_LowPriority,nt=r.unstable_IdlePriority,rt=null,st=null;var lt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(it(e)/ot|0)|0},it=Math.log,ot=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mt(e,t){var a=e.pendingLanes;if(0===a)return 0;var n=0,r=e.suspendedLanes,s=e.pingedLanes,l=268435455&a;if(0!==l){var i=l&~r;0!==i?n=ut(i):0!==(s&=l)&&(n=ut(s))}else 0!==(l=a&~r)?n=ut(l):0!==s&&(n=ut(s));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&r)&&((r=n&-n)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&n)&&(n|=16&a),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(a=31-lt(t)),n|=e[a],t&=~r;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function xt(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function ht(e,t,a){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-lt(t)]=a}function yt(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var n=31-lt(a),r=1<<n;r&t|e[n]&t&&(e[n]|=t),a&=~r}}var bt=0;function vt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var jt,wt,Nt,kt,St,_t=!1,Ct=[],Et=null,Pt=null,Mt=null,Tt=new Map,At=new Map,Dt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function Ot(e,t,a,n,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:a,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&wt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Lt(e){var t=yr(e.target);if(null!==t){var a=We(t);if(null!==a)if(13===(t=a.tag)){if(null!==(t=Ve(a)))return e.blockedOn=t,void St(e.priority,function(){Nt(a)})}else if(3===t&&a.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===a.tag?a.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var a=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==a)return null!==(t=br(a))&&wt(t),e.blockedOn=a,!1;var n=new(a=e.nativeEvent).constructor(a.type,a);ve=n,a.target.dispatchEvent(n),ve=null,t.shift()}return!0}function zt(e,t,a){Ut(e)&&a.delete(t)}function It(){_t=!1,null!==Et&&Ut(Et)&&(Et=null),null!==Pt&&Ut(Pt)&&(Pt=null),null!==Mt&&Ut(Mt)&&(Mt=null),Tt.forEach(zt),At.forEach(zt)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,It)))}function Wt(e){function t(t){return Gt(t,e)}if(0<Ct.length){Gt(Ct[0],e);for(var a=1;a<Ct.length;a++){var n=Ct[a];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Et&&Gt(Et,e),null!==Pt&&Gt(Pt,e),null!==Mt&&Gt(Mt,e),Tt.forEach(t),At.forEach(t),a=0;a<Dt.length;a++)(n=Dt[a]).blockedOn===e&&(n.blockedOn=null);for(;0<Dt.length&&null===(a=Dt[0]).blockedOn;)Lt(a),null===a.blockedOn&&Dt.shift()}var Vt=v.ReactCurrentBatchConfig,Bt=!0;function qt(e,t,a,n){var r=bt,s=Vt.transition;Vt.transition=null;try{bt=1,Qt(e,t,a,n)}finally{bt=r,Vt.transition=s}}function Ht(e,t,a,n){var r=bt,s=Vt.transition;Vt.transition=null;try{bt=4,Qt(e,t,a,n)}finally{bt=r,Vt.transition=s}}function Qt(e,t,a,n){if(Bt){var r=Kt(e,t,a,n);if(null===r)Bn(e,t,n,$t,a),Ft(e,n);else if(function(e,t,a,n,r){switch(t){case"focusin":return Et=Ot(Et,e,t,a,n,r),!0;case"dragenter":return Pt=Ot(Pt,e,t,a,n,r),!0;case"mouseover":return Mt=Ot(Mt,e,t,a,n,r),!0;case"pointerover":var s=r.pointerId;return Tt.set(s,Ot(Tt.get(s)||null,e,t,a,n,r)),!0;case"gotpointercapture":return s=r.pointerId,At.set(s,Ot(At.get(s)||null,e,t,a,n,r)),!0}return!1}(r,e,t,a,n))n.stopPropagation();else if(Ft(e,n),4&t&&-1<Rt.indexOf(e)){for(;null!==r;){var s=br(r);if(null!==s&&jt(s),null===(s=Kt(e,t,a,n))&&Bn(e,t,n,$t,a),s===r)break;r=s}null!==r&&n.stopPropagation()}else Bn(e,t,n,null,a)}}var $t=null;function Kt(e,t,a,n){if($t=null,null!==(e=yr(e=je(n))))if(null===(t=We(e)))e=null;else if(13===(a=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===a){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $t=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case at:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function ea(){if(Zt)return Zt;var e,t,a=Xt,n=a.length,r="value"in Jt?Jt.value:Jt.textContent,s=r.length;for(e=0;e<n&&a[e]===r[e];e++);var l=n-e;for(t=1;t<=l&&a[n-t]===r[s-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function ta(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function aa(){return!0}function na(){return!1}function ra(e){function t(t,a,n,r,s){for(var l in this._reactName=t,this._targetInst=n,this.type=a,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(l)&&(t=e[l],this[l]=t?t(r):r[l]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?aa:na,this.isPropagationStopped=na,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=aa)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=aa)},persist:function(){},isPersistent:aa}),t}var sa,la,ia,oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ca=ra(oa),da=L({},oa,{view:0,detail:0}),ua=ra(da),ma=L({},da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ka,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ia&&(ia&&"mousemove"===e.type?(sa=e.screenX-ia.screenX,la=e.screenY-ia.screenY):la=sa=0,ia=e),sa)},movementY:function(e){return"movementY"in e?e.movementY:la}}),fa=ra(ma),pa=ra(L({},ma,{dataTransfer:0})),ga=ra(L({},da,{relatedTarget:0})),xa=ra(L({},oa,{animationName:0,elapsedTime:0,pseudoElement:0})),ha=L({},oa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ya=ra(ha),ba=ra(L({},oa,{data:0})),va={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ja={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Na(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wa[e])&&!!t[e]}function ka(){return Na}var Sa=L({},da,{key:function(e){if(e.key){var t=va[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ta(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ja[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ka,charCode:function(e){return"keypress"===e.type?ta(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ta(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_a=ra(Sa),Ca=ra(L({},ma,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ea=ra(L({},da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ka})),Pa=ra(L({},oa,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ma=L({},ma,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ta=ra(Ma),Aa=[9,13,27,32],Da=d&&"CompositionEvent"in window,Ra=null;d&&"documentMode"in document&&(Ra=document.documentMode);var Fa=d&&"TextEvent"in window&&!Ra,Oa=d&&(!Da||Ra&&8<Ra&&11>=Ra),La=String.fromCharCode(32),Ua=!1;function za(e,t){switch(e){case"keyup":return-1!==Aa.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ia(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ga=!1;var Wa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Va(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wa[e.type]:"textarea"===t}function Ba(e,t,a,n){_e(n),0<(t=Hn(t,"onChange")).length&&(a=new ca("onChange","change",null,a,n),e.push({event:a,listeners:t}))}var qa=null,Ha=null;function Qa(e){Un(e,0)}function $a(e){if(Q(vr(e)))return e}function Ka(e,t){if("change"===e)return t}var Ya=!1;if(d){var Ja;if(d){var Xa="oninput"in document;if(!Xa){var Za=document.createElement("div");Za.setAttribute("oninput","return;"),Xa="function"===typeof Za.oninput}Ja=Xa}else Ja=!1;Ya=Ja&&(!document.documentMode||9<document.documentMode)}function en(){qa&&(qa.detachEvent("onpropertychange",tn),Ha=qa=null)}function tn(e){if("value"===e.propertyName&&$a(Ha)){var t=[];Ba(t,Ha,e,je(e)),Te(Qa,t)}}function an(e,t,a){"focusin"===e?(en(),Ha=a,(qa=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $a(Ha)}function rn(e,t){if("click"===e)return $a(t)}function sn(e,t){if("input"===e||"change"===e)return $a(t)}var ln="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function on(e,t){if(ln(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;for(n=0;n<a.length;n++){var r=a[n];if(!u.call(t,r)||!ln(e[r],t[r]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dn(e,t){var a,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function un(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?un(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function mn(){for(var e=window,t=$();t instanceof e.HTMLIFrameElement;){try{var a="string"===typeof t.contentWindow.location.href}catch(n){a=!1}if(!a)break;t=$((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pn(e){var t=mn(),a=e.focusedElem,n=e.selectionRange;if(t!==a&&a&&a.ownerDocument&&un(a.ownerDocument.documentElement,a)){if(null!==n&&fn(a))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in a)a.selectionStart=t,a.selectionEnd=Math.min(e,a.value.length);else if((e=(t=a.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=a.textContent.length,s=Math.min(n.start,r);n=void 0===n.end?s:Math.min(n.end,r),!e.extend&&s>n&&(r=n,n=s,s=r),r=dn(a,s);var l=dn(a,n);r&&l&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}for(t=[],e=a;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<t.length;a++)(e=t[a]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gn=d&&"documentMode"in document&&11>=document.documentMode,xn=null,hn=null,yn=null,bn=!1;function vn(e,t,a){var n=a.window===a?a.document:9===a.nodeType?a:a.ownerDocument;bn||null==xn||xn!==$(n)||("selectionStart"in(n=xn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&on(yn,n)||(yn=n,0<(n=Hn(hn,"onSelect")).length&&(t=new ca("onSelect","select",null,t,a),e.push({event:t,listeners:n}),t.target=xn)))}function jn(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var wn={animationend:jn("Animation","AnimationEnd"),animationiteration:jn("Animation","AnimationIteration"),animationstart:jn("Animation","AnimationStart"),transitionend:jn("Transition","TransitionEnd")},Nn={},kn={};function Sn(e){if(Nn[e])return Nn[e];if(!wn[e])return e;var t,a=wn[e];for(t in a)if(a.hasOwnProperty(t)&&t in kn)return Nn[e]=a[t];return e}d&&(kn=document.createElement("div").style,"AnimationEvent"in window||(delete wn.animationend.animation,delete wn.animationiteration.animation,delete wn.animationstart.animation),"TransitionEvent"in window||delete wn.transitionend.transition);var _n=Sn("animationend"),Cn=Sn("animationiteration"),En=Sn("animationstart"),Pn=Sn("transitionend"),Mn=new Map,Tn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function An(e,t){Mn.set(e,t),o(t,[e])}for(var Dn=0;Dn<Tn.length;Dn++){var Rn=Tn[Dn];An(Rn.toLowerCase(),"on"+(Rn[0].toUpperCase()+Rn.slice(1)))}An(_n,"onAnimationEnd"),An(Cn,"onAnimationIteration"),An(En,"onAnimationStart"),An("dblclick","onDoubleClick"),An("focusin","onFocus"),An("focusout","onBlur"),An(Pn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),On=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fn));function Ln(e,t,a){var n=e.type||"unknown-event";e.currentTarget=a,function(e,t,a,n,r,l,i,o,c){if(Ge.apply(this,arguments),Oe){if(!Oe)throw Error(s(198));var d=Le;Oe=!1,Le=null,Ue||(Ue=!0,ze=d)}}(n,t,void 0,e),e.currentTarget=null}function Un(e,t){t=0!==(4&t);for(var a=0;a<e.length;a++){var n=e[a],r=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var l=n.length-1;0<=l;l--){var i=n[l],o=i.instance,c=i.currentTarget;if(i=i.listener,o!==s&&r.isPropagationStopped())break e;Ln(r,i,c),s=o}else for(l=0;l<n.length;l++){if(o=(i=n[l]).instance,c=i.currentTarget,i=i.listener,o!==s&&r.isPropagationStopped())break e;Ln(r,i,c),s=o}}}if(Ue)throw e=ze,Ue=!1,ze=null,e}function zn(e,t){var a=t[gr];void 0===a&&(a=t[gr]=new Set);var n=e+"__bubble";a.has(n)||(Vn(t,e,2,!1),a.add(n))}function In(e,t,a){var n=0;t&&(n|=4),Vn(a,e,n,t)}var Gn="_reactListening"+Math.random().toString(36).slice(2);function Wn(e){if(!e[Gn]){e[Gn]=!0,l.forEach(function(t){"selectionchange"!==t&&(On.has(t)||In(t,!1,e),In(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Gn]||(t[Gn]=!0,In("selectionchange",!1,t))}}function Vn(e,t,a,n){switch(Yt(t)){case 1:var r=qt;break;case 4:r=Ht;break;default:r=Qt}a=r.bind(null,t,a,e),r=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,a,{capture:!0,passive:r}):e.addEventListener(t,a,!0):void 0!==r?e.addEventListener(t,a,{passive:r}):e.addEventListener(t,a,!1)}function Bn(e,t,a,n,r){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var l=n.tag;if(3===l||4===l){var i=n.stateNode.containerInfo;if(i===r||8===i.nodeType&&i.parentNode===r)break;if(4===l)for(l=n.return;null!==l;){var o=l.tag;if((3===o||4===o)&&((o=l.stateNode.containerInfo)===r||8===o.nodeType&&o.parentNode===r))return;l=l.return}for(;null!==i;){if(null===(l=yr(i)))return;if(5===(o=l.tag)||6===o){n=s=l;continue e}i=i.parentNode}}n=n.return}Te(function(){var n=s,r=je(a),l=[];e:{var i=Mn.get(e);if(void 0!==i){var o=ca,c=e;switch(e){case"keypress":if(0===ta(a))break e;case"keydown":case"keyup":o=_a;break;case"focusin":c="focus",o=ga;break;case"focusout":c="blur",o=ga;break;case"beforeblur":case"afterblur":o=ga;break;case"click":if(2===a.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=fa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=pa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=Ea;break;case _n:case Cn:case En:o=xa;break;case Pn:o=Pa;break;case"scroll":o=ua;break;case"wheel":o=Ta;break;case"copy":case"cut":case"paste":o=ya;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=Ca}var d=0!==(4&t),u=!d&&"scroll"===e,m=d?null!==i?i+"Capture":null:i;d=[];for(var f,p=n;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==m&&(null!=(g=Ae(p,m))&&d.push(qn(p,g,f)))),u)break;p=p.return}0<d.length&&(i=new o(i,c,null,a,r),l.push({event:i,listeners:d}))}}if(0===(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||a===ve||!(c=a.relatedTarget||a.fromElement)||!yr(c)&&!c[pr])&&(o||i)&&(i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window,o?(o=n,null!==(c=(c=a.relatedTarget||a.toElement)?yr(c):null)&&(c!==(u=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(o=null,c=n),o!==c)){if(d=fa,g="onMouseLeave",m="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=Ca,g="onPointerLeave",m="onPointerEnter",p="pointer"),u=null==o?i:vr(o),f=null==c?i:vr(c),(i=new d(g,p+"leave",o,a,r)).target=u,i.relatedTarget=f,g=null,yr(r)===n&&((d=new d(m,p+"enter",c,a,r)).target=f,d.relatedTarget=u,g=d),u=g,o&&c)e:{for(m=c,p=0,f=d=o;f;f=Qn(f))p++;for(f=0,g=m;g;g=Qn(g))f++;for(;0<p-f;)d=Qn(d),p--;for(;0<f-p;)m=Qn(m),f--;for(;p--;){if(d===m||null!==m&&d===m.alternate)break e;d=Qn(d),m=Qn(m)}d=null}else d=null;null!==o&&$n(l,i,o,d,!1),null!==c&&null!==u&&$n(l,u,c,d,!0)}if("select"===(o=(i=n?vr(n):window).nodeName&&i.nodeName.toLowerCase())||"input"===o&&"file"===i.type)var x=Ka;else if(Va(i))if(Ya)x=sn;else{x=nn;var h=an}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(x=rn);switch(x&&(x=x(e,n))?Ba(l,x,a,r):(h&&h(e,i,n),"focusout"===e&&(h=i._wrapperState)&&h.controlled&&"number"===i.type&&ee(i,"number",i.value)),h=n?vr(n):window,e){case"focusin":(Va(h)||"true"===h.contentEditable)&&(xn=h,hn=n,yn=null);break;case"focusout":yn=hn=xn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,vn(l,a,r);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":vn(l,a,r)}var y;if(Da)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Ga?za(e,a)&&(b="onCompositionEnd"):"keydown"===e&&229===a.keyCode&&(b="onCompositionStart");b&&(Oa&&"ko"!==a.locale&&(Ga||"onCompositionStart"!==b?"onCompositionEnd"===b&&Ga&&(y=ea()):(Xt="value"in(Jt=r)?Jt.value:Jt.textContent,Ga=!0)),0<(h=Hn(n,b)).length&&(b=new ba(b,e,null,a,r),l.push({event:b,listeners:h}),y?b.data=y:null!==(y=Ia(a))&&(b.data=y))),(y=Fa?function(e,t){switch(e){case"compositionend":return Ia(t);case"keypress":return 32!==t.which?null:(Ua=!0,La);case"textInput":return(e=t.data)===La&&Ua?null:e;default:return null}}(e,a):function(e,t){if(Ga)return"compositionend"===e||!Da&&za(e,t)?(e=ea(),Zt=Xt=Jt=null,Ga=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Oa&&"ko"!==t.locale?null:t.data}}(e,a))&&(0<(n=Hn(n,"onBeforeInput")).length&&(r=new ba("onBeforeInput","beforeinput",null,a,r),l.push({event:r,listeners:n}),r.data=y))}Un(l,t)})}function qn(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Hn(e,t){for(var a=t+"Capture",n=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Ae(e,a))&&n.unshift(qn(e,s,r)),null!=(s=Ae(e,t))&&n.push(qn(e,s,r))),e=e.return}return n}function Qn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function $n(e,t,a,n,r){for(var s=t._reactName,l=[];null!==a&&a!==n;){var i=a,o=i.alternate,c=i.stateNode;if(null!==o&&o===n)break;5===i.tag&&null!==c&&(i=c,r?null!=(o=Ae(a,s))&&l.unshift(qn(a,o,i)):r||null!=(o=Ae(a,s))&&l.push(qn(a,o,i))),a=a.return}0!==l.length&&e.push({event:t,listeners:l})}var Kn=/\r\n?/g,Yn=/\u0000|\uFFFD/g;function Jn(e){return("string"===typeof e?e:""+e).replace(Kn,"\n").replace(Yn,"")}function Xn(e,t,a){if(t=Jn(t),Jn(e)!==t&&a)throw Error(s(425))}function Zn(){}var er=null,tr=null;function ar(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var nr="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,lr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(ir)}:nr;function ir(e){setTimeout(function(){throw e})}function or(e,t){var a=t,n=0;do{var r=a.nextSibling;if(e.removeChild(a),r&&8===r.nodeType)if("/$"===(a=r.data)){if(0===n)return e.removeChild(r),void Wt(t);n--}else"$"!==a&&"$?"!==a&&"$!"!==a||n++;a=r}while(a);Wt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("$"===a||"$!"===a||"$?"===a){if(0===t)return e;t--}else"/$"===a&&t++}e=e.previousSibling}return null}var ur=Math.random().toString(36).slice(2),mr="__reactFiber$"+ur,fr="__reactProps$"+ur,pr="__reactContainer$"+ur,gr="__reactEvents$"+ur,xr="__reactListeners$"+ur,hr="__reactHandles$"+ur;function yr(e){var t=e[mr];if(t)return t;for(var a=e.parentNode;a;){if(t=a[pr]||a[mr]){if(a=t.alternate,null!==t.child||null!==a&&null!==a.child)for(e=dr(e);null!==e;){if(a=e[mr])return a;e=dr(e)}return t}a=(e=a).parentNode}return null}function br(e){return!(e=e[mr]||e[pr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function jr(e){return e[fr]||null}var wr=[],Nr=-1;function kr(e){return{current:e}}function Sr(e){0>Nr||(e.current=wr[Nr],wr[Nr]=null,Nr--)}function _r(e,t){Nr++,wr[Nr]=e.current,e.current=t}var Cr={},Er=kr(Cr),Pr=kr(!1),Mr=Cr;function Tr(e,t){var a=e.type.contextTypes;if(!a)return Cr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in a)s[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ar(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Dr(){Sr(Pr),Sr(Er)}function Rr(e,t,a){if(Er.current!==Cr)throw Error(s(168));_r(Er,t),_r(Pr,a)}function Fr(e,t,a){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return a;for(var r in n=n.getChildContext())if(!(r in t))throw Error(s(108,V(e)||"Unknown",r));return L({},a,n)}function Or(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cr,Mr=Er.current,_r(Er,e),_r(Pr,Pr.current),!0}function Lr(e,t,a){var n=e.stateNode;if(!n)throw Error(s(169));a?(e=Fr(e,t,Mr),n.__reactInternalMemoizedMergedChildContext=e,Sr(Pr),Sr(Er),_r(Er,e)):Sr(Pr),_r(Pr,a)}var Ur=null,zr=!1,Ir=!1;function Gr(e){null===Ur?Ur=[e]:Ur.push(e)}function Wr(){if(!Ir&&null!==Ur){Ir=!0;var e=0,t=bt;try{var a=Ur;for(bt=1;e<a.length;e++){var n=a[e];do{n=n(!0)}while(null!==n)}Ur=null,zr=!1}catch(r){throw null!==Ur&&(Ur=Ur.slice(e+1)),Qe(Ze,Wr),r}finally{bt=t,Ir=!1}}return null}var Vr=[],Br=0,qr=null,Hr=0,Qr=[],$r=0,Kr=null,Yr=1,Jr="";function Xr(e,t){Vr[Br++]=Hr,Vr[Br++]=qr,qr=e,Hr=t}function Zr(e,t,a){Qr[$r++]=Yr,Qr[$r++]=Jr,Qr[$r++]=Kr,Kr=e;var n=Yr;e=Jr;var r=32-lt(n)-1;n&=~(1<<r),a+=1;var s=32-lt(t)+r;if(30<s){var l=r-r%5;s=(n&(1<<l)-1).toString(32),n>>=l,r-=l,Yr=1<<32-lt(t)+r|a<<r|n,Jr=s+e}else Yr=1<<s|a<<r|n,Jr=e}function es(e){null!==e.return&&(Xr(e,1),Zr(e,1,0))}function ts(e){for(;e===qr;)qr=Vr[--Br],Vr[Br]=null,Hr=Vr[--Br],Vr[Br]=null;for(;e===Kr;)Kr=Qr[--$r],Qr[$r]=null,Jr=Qr[--$r],Qr[$r]=null,Yr=Qr[--$r],Qr[$r]=null}var as=null,ns=null,rs=!1,ss=null;function ls(e,t){var a=Tc(5,null,null,0);a.elementType="DELETED",a.stateNode=t,a.return=e,null===(t=e.deletions)?(e.deletions=[a],e.flags|=16):t.push(a)}function is(e,t){switch(e.tag){case 5:var a=e.type;return null!==(t=1!==t.nodeType||a.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,as=e,ns=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,as=e,ns=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(a=null!==Kr?{id:Yr,overflow:Jr}:null,e.memoizedState={dehydrated:t,treeContext:a,retryLane:1073741824},(a=Tc(18,null,null,0)).stateNode=t,a.return=e,e.child=a,as=e,ns=null,!0);default:return!1}}function os(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=ns;if(t){var a=t;if(!is(e,t)){if(os(e))throw Error(s(418));t=cr(a.nextSibling);var n=as;t&&is(e,t)?ls(n,a):(e.flags=-4097&e.flags|2,rs=!1,as=e)}}else{if(os(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,as=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;as=e}function us(e){if(e!==as)return!1;if(!rs)return ds(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ar(e.type,e.memoizedProps)),t&&(t=ns)){if(os(e))throw ms(),Error(s(418));for(;t;)ls(e,t),t=cr(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var a=e.data;if("/$"===a){if(0===t){ns=cr(e.nextSibling);break e}t--}else"$"!==a&&"$!"!==a&&"$?"!==a||t++}e=e.nextSibling}ns=null}}else ns=as?cr(e.stateNode.nextSibling):null;return!0}function ms(){for(var e=ns;e;)e=cr(e.nextSibling)}function fs(){ns=as=null,rs=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var gs=v.ReactCurrentBatchConfig;function xs(e,t,a){if(null!==(e=a.ref)&&"function"!==typeof e&&"object"!==typeof e){if(a._owner){if(a=a._owner){if(1!==a.tag)throw Error(s(309));var n=a.stateNode}if(!n)throw Error(s(147,e));var r=n,l=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===l?t.ref:(t=function(e){var t=r.refs;null===e?delete t[l]:t[l]=e},t._stringRef=l,t)}if("string"!==typeof e)throw Error(s(284));if(!a._owner)throw Error(s(290,e))}return e}function hs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,a){if(e){var n=t.deletions;null===n?(t.deletions=[a],t.flags|=16):n.push(a)}}function a(a,n){if(!e)return null;for(;null!==n;)t(a,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function l(t,a,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<a?(t.flags|=2,a):n:(t.flags|=2,a):(t.flags|=1048576,a)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,a,n){return null===t||6!==t.tag?((t=Lc(a,e.mode,n)).return=e,t):((t=r(t,a)).return=e,t)}function c(e,t,a,n){var s=a.type;return s===N?u(e,t,a.props.children,n,a.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===A&&ys(s)===t.type)?((n=r(t,a.props)).ref=xs(e,t,a),n.return=e,n):((n=Rc(a.type,a.key,a.props,null,e.mode,n)).ref=xs(e,t,a),n.return=e,n)}function d(e,t,a,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==a.containerInfo||t.stateNode.implementation!==a.implementation?((t=Uc(a,e.mode,n)).return=e,t):((t=r(t,a.children||[])).return=e,t)}function u(e,t,a,n,s){return null===t||7!==t.tag?((t=Fc(a,e.mode,n,s)).return=e,t):((t=r(t,a)).return=e,t)}function m(e,t,a){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,a)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case j:return(a=Rc(t.type,t.key,t.props,null,e.mode,a)).ref=xs(e,null,t),a.return=e,a;case w:return(t=Uc(t,e.mode,a)).return=e,t;case A:return m(e,(0,t._init)(t._payload),a)}if(te(t)||F(t))return(t=Fc(t,e.mode,a,null)).return=e,t;hs(e,t)}return null}function f(e,t,a,n){var r=null!==t?t.key:null;if("string"===typeof a&&""!==a||"number"===typeof a)return null!==r?null:o(e,t,""+a,n);if("object"===typeof a&&null!==a){switch(a.$$typeof){case j:return a.key===r?c(e,t,a,n):null;case w:return a.key===r?d(e,t,a,n):null;case A:return f(e,t,(r=a._init)(a._payload),n)}if(te(a)||F(a))return null!==r?null:u(e,t,a,n,null);hs(e,a)}return null}function p(e,t,a,n,r){if("string"===typeof n&&""!==n||"number"===typeof n)return o(t,e=e.get(a)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case j:return c(t,e=e.get(null===n.key?a:n.key)||null,n,r);case w:return d(t,e=e.get(null===n.key?a:n.key)||null,n,r);case A:return p(e,t,a,(0,n._init)(n._payload),r)}if(te(n)||F(n))return u(t,e=e.get(a)||null,n,r,null);hs(t,n)}return null}function g(r,s,i,o){for(var c=null,d=null,u=s,g=s=0,x=null;null!==u&&g<i.length;g++){u.index>g?(x=u,u=null):x=u.sibling;var h=f(r,u,i[g],o);if(null===h){null===u&&(u=x);break}e&&u&&null===h.alternate&&t(r,u),s=l(h,s,g),null===d?c=h:d.sibling=h,d=h,u=x}if(g===i.length)return a(r,u),rs&&Xr(r,g),c;if(null===u){for(;g<i.length;g++)null!==(u=m(r,i[g],o))&&(s=l(u,s,g),null===d?c=u:d.sibling=u,d=u);return rs&&Xr(r,g),c}for(u=n(r,u);g<i.length;g++)null!==(x=p(u,r,g,i[g],o))&&(e&&null!==x.alternate&&u.delete(null===x.key?g:x.key),s=l(x,s,g),null===d?c=x:d.sibling=x,d=x);return e&&u.forEach(function(e){return t(r,e)}),rs&&Xr(r,g),c}function x(r,i,o,c){var d=F(o);if("function"!==typeof d)throw Error(s(150));if(null==(o=d.call(o)))throw Error(s(151));for(var u=d=null,g=i,x=i=0,h=null,y=o.next();null!==g&&!y.done;x++,y=o.next()){g.index>x?(h=g,g=null):h=g.sibling;var b=f(r,g,y.value,c);if(null===b){null===g&&(g=h);break}e&&g&&null===b.alternate&&t(r,g),i=l(b,i,x),null===u?d=b:u.sibling=b,u=b,g=h}if(y.done)return a(r,g),rs&&Xr(r,x),d;if(null===g){for(;!y.done;x++,y=o.next())null!==(y=m(r,y.value,c))&&(i=l(y,i,x),null===u?d=y:u.sibling=y,u=y);return rs&&Xr(r,x),d}for(g=n(r,g);!y.done;x++,y=o.next())null!==(y=p(g,r,x,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?x:y.key),i=l(y,i,x),null===u?d=y:u.sibling=y,u=y);return e&&g.forEach(function(e){return t(r,e)}),rs&&Xr(r,x),d}return function e(n,s,l,o){if("object"===typeof l&&null!==l&&l.type===N&&null===l.key&&(l=l.props.children),"object"===typeof l&&null!==l){switch(l.$$typeof){case j:e:{for(var c=l.key,d=s;null!==d;){if(d.key===c){if((c=l.type)===N){if(7===d.tag){a(n,d.sibling),(s=r(d,l.props.children)).return=n,n=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===A&&ys(c)===d.type){a(n,d.sibling),(s=r(d,l.props)).ref=xs(n,d,l),s.return=n,n=s;break e}a(n,d);break}t(n,d),d=d.sibling}l.type===N?((s=Fc(l.props.children,n.mode,o,l.key)).return=n,n=s):((o=Rc(l.type,l.key,l.props,null,n.mode,o)).ref=xs(n,s,l),o.return=n,n=o)}return i(n);case w:e:{for(d=l.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===l.containerInfo&&s.stateNode.implementation===l.implementation){a(n,s.sibling),(s=r(s,l.children||[])).return=n,n=s;break e}a(n,s);break}t(n,s),s=s.sibling}(s=Uc(l,n.mode,o)).return=n,n=s}return i(n);case A:return e(n,s,(d=l._init)(l._payload),o)}if(te(l))return g(n,s,l,o);if(F(l))return x(n,s,l,o);hs(n,l)}return"string"===typeof l&&""!==l||"number"===typeof l?(l=""+l,null!==s&&6===s.tag?(a(n,s.sibling),(s=r(s,l)).return=n,n=s):(a(n,s),(s=Lc(l,n.mode,o)).return=n,n=s),i(n)):a(n,s)}}var vs=bs(!0),js=bs(!1),ws=kr(null),Ns=null,ks=null,Ss=null;function _s(){Ss=ks=Ns=null}function Cs(e){var t=ws.current;Sr(ws),e._currentValue=t}function Es(e,t,a){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===a)break;e=e.return}}function Ps(e,t){Ns=e,Ss=ks=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yi=!0),e.firstContext=null)}function Ms(e){var t=e._currentValue;if(Ss!==e)if(e={context:e,memoizedValue:t,next:null},null===ks){if(null===Ns)throw Error(s(308));ks=e,Ns.dependencies={lanes:0,firstContext:e}}else ks=ks.next=e;return t}var Ts=null;function As(e){null===Ts?Ts=[e]:Ts.push(e)}function Ds(e,t,a,n){var r=t.interleaved;return null===r?(a.next=a,As(t)):(a.next=r.next,r.next=a),t.interleaved=a,Rs(e,n)}function Rs(e,t){e.lanes|=t;var a=e.alternate;for(null!==a&&(a.lanes|=t),a=e,e=e.return;null!==e;)e.childLanes|=t,null!==(a=e.alternate)&&(a.childLanes|=t),a=e,e=e.return;return 3===a.tag?a.stateNode:null}var Fs=!1;function Os(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Us(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zs(e,t,a){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Eo)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,Rs(e,a)}return null===(r=n.interleaved)?(t.next=t,As(n)):(t.next=r.next,r.next=t),n.interleaved=t,Rs(e,a)}function Is(e,t,a){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&a))){var n=t.lanes;a|=n&=e.pendingLanes,t.lanes=a,yt(e,a)}}function Gs(e,t){var a=e.updateQueue,n=e.alternate;if(null!==n&&a===(n=n.updateQueue)){var r=null,s=null;if(null!==(a=a.firstBaseUpdate)){do{var l={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};null===s?r=s=l:s=s.next=l,a=a.next}while(null!==a);null===s?r=s=t:s=s.next=t}else r=s=t;return a={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},void(e.updateQueue=a)}null===(e=a.lastBaseUpdate)?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}function Ws(e,t,a,n){var r=e.updateQueue;Fs=!1;var s=r.firstBaseUpdate,l=r.lastBaseUpdate,i=r.shared.pending;if(null!==i){r.shared.pending=null;var o=i,c=o.next;o.next=null,null===l?s=c:l.next=c,l=o;var d=e.alternate;null!==d&&((i=(d=d.updateQueue).lastBaseUpdate)!==l&&(null===i?d.firstBaseUpdate=c:i.next=c,d.lastBaseUpdate=o))}if(null!==s){var u=r.baseState;for(l=0,d=c=o=null,i=s;;){var m=i.lane,f=i.eventTime;if((n&m)===m){null!==d&&(d=d.next={eventTime:f,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var p=e,g=i;switch(m=t,f=a,g.tag){case 1:if("function"===typeof(p=g.payload)){u=p.call(f,u,m);break e}u=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(m="function"===typeof(p=g.payload)?p.call(f,u,m):p)||void 0===m)break e;u=L({},u,m);break e;case 2:Fs=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(m=r.effects)?r.effects=[i]:m.push(i))}else f={eventTime:f,lane:m,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===d?(c=d=f,o=u):d=d.next=f,l|=m;if(null===(i=i.next)){if(null===(i=r.shared.pending))break;i=(m=i).next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}if(null===d&&(o=u),r.baseState=o,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{l|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Oo|=l,e.lanes=l,e.memoizedState=u}}function Vs(e,t,a){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=a,"function"!==typeof r)throw Error(s(191,r));r.call(n)}}}var Bs={},qs=kr(Bs),Hs=kr(Bs),Qs=kr(Bs);function $s(e){if(e===Bs)throw Error(s(174));return e}function Ks(e,t){switch(_r(Qs,t),_r(Hs,e),_r(qs,Bs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sr(qs),_r(qs,t)}function Ys(){Sr(qs),Sr(Hs),Sr(Qs)}function Js(e){$s(Qs.current);var t=$s(qs.current),a=oe(t,e.type);t!==a&&(_r(Hs,e),_r(qs,a))}function Xs(e){Hs.current===e&&(Sr(qs),Sr(Hs))}var Zs=kr(0);function el(e){for(var t=e;null!==t;){if(13===t.tag){var a=t.memoizedState;if(null!==a&&(null===(a=a.dehydrated)||"$?"===a.data||"$!"===a.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var tl=[];function al(){for(var e=0;e<tl.length;e++)tl[e]._workInProgressVersionPrimary=null;tl.length=0}var nl=v.ReactCurrentDispatcher,rl=v.ReactCurrentBatchConfig,sl=0,ll=null,il=null,ol=null,cl=!1,dl=!1,ul=0,ml=0;function fl(){throw Error(s(321))}function pl(e,t){if(null===t)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!ln(e[a],t[a]))return!1;return!0}function gl(e,t,a,n,r,l){if(sl=l,ll=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nl.current=null===e||null===e.memoizedState?Xl:Zl,e=a(n,r),dl){l=0;do{if(dl=!1,ul=0,25<=l)throw Error(s(301));l+=1,ol=il=null,t.updateQueue=null,nl.current=ei,e=a(n,r)}while(dl)}if(nl.current=Jl,t=null!==il&&null!==il.next,sl=0,ol=il=ll=null,cl=!1,t)throw Error(s(300));return e}function xl(){var e=0!==ul;return ul=0,e}function hl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ol?ll.memoizedState=ol=e:ol=ol.next=e,ol}function yl(){if(null===il){var e=ll.alternate;e=null!==e?e.memoizedState:null}else e=il.next;var t=null===ol?ll.memoizedState:ol.next;if(null!==t)ol=t,il=e;else{if(null===e)throw Error(s(310));e={memoizedState:(il=e).memoizedState,baseState:il.baseState,baseQueue:il.baseQueue,queue:il.queue,next:null},null===ol?ll.memoizedState=ol=e:ol=ol.next=e}return ol}function bl(e,t){return"function"===typeof t?t(e):t}function vl(e){var t=yl(),a=t.queue;if(null===a)throw Error(s(311));a.lastRenderedReducer=e;var n=il,r=n.baseQueue,l=a.pending;if(null!==l){if(null!==r){var i=r.next;r.next=l.next,l.next=i}n.baseQueue=r=l,a.pending=null}if(null!==r){l=r.next,n=n.baseState;var o=i=null,c=null,d=l;do{var u=d.lane;if((sl&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var m={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(o=c=m,i=n):c=c.next=m,ll.lanes|=u,Oo|=u}d=d.next}while(null!==d&&d!==l);null===c?i=n:c.next=o,ln(n,t.memoizedState)||(yi=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,a.lastRenderedState=n}if(null!==(e=a.interleaved)){r=e;do{l=r.lane,ll.lanes|=l,Oo|=l,r=r.next}while(r!==e)}else null===r&&(a.lanes=0);return[t.memoizedState,a.dispatch]}function jl(e){var t=yl(),a=t.queue;if(null===a)throw Error(s(311));a.lastRenderedReducer=e;var n=a.dispatch,r=a.pending,l=t.memoizedState;if(null!==r){a.pending=null;var i=r=r.next;do{l=e(l,i.action),i=i.next}while(i!==r);ln(l,t.memoizedState)||(yi=!0),t.memoizedState=l,null===t.baseQueue&&(t.baseState=l),a.lastRenderedState=l}return[l,n]}function wl(){}function Nl(e,t){var a=ll,n=yl(),r=t(),l=!ln(n.memoizedState,r);if(l&&(n.memoizedState=r,yi=!0),n=n.queue,Fl(_l.bind(null,a,n,e),[e]),n.getSnapshot!==t||l||null!==ol&&1&ol.memoizedState.tag){if(a.flags|=2048,Ml(9,Sl.bind(null,a,n,r,t),void 0,null),null===Po)throw Error(s(349));0!==(30&sl)||kl(a,t,r)}return r}function kl(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},null===(t=ll.updateQueue)?(t={lastEffect:null,stores:null},ll.updateQueue=t,t.stores=[e]):null===(a=t.stores)?t.stores=[e]:a.push(e)}function Sl(e,t,a,n){t.value=a,t.getSnapshot=n,Cl(t)&&El(e)}function _l(e,t,a){return a(function(){Cl(t)&&El(e)})}function Cl(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!ln(e,a)}catch(n){return!0}}function El(e){var t=Rs(e,1);null!==t&&ac(t,e,1,-1)}function Pl(e){var t=hl();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:e},t.queue=e,e=e.dispatch=Ql.bind(null,ll,e),[t.memoizedState,e]}function Ml(e,t,a,n){return e={tag:e,create:t,destroy:a,deps:n,next:null},null===(t=ll.updateQueue)?(t={lastEffect:null,stores:null},ll.updateQueue=t,t.lastEffect=e.next=e):null===(a=t.lastEffect)?t.lastEffect=e.next=e:(n=a.next,a.next=e,e.next=n,t.lastEffect=e),e}function Tl(){return yl().memoizedState}function Al(e,t,a,n){var r=hl();ll.flags|=e,r.memoizedState=Ml(1|t,a,void 0,void 0===n?null:n)}function Dl(e,t,a,n){var r=yl();n=void 0===n?null:n;var s=void 0;if(null!==il){var l=il.memoizedState;if(s=l.destroy,null!==n&&pl(n,l.deps))return void(r.memoizedState=Ml(t,a,s,n))}ll.flags|=e,r.memoizedState=Ml(1|t,a,s,n)}function Rl(e,t){return Al(8390656,8,e,t)}function Fl(e,t){return Dl(2048,8,e,t)}function Ol(e,t){return Dl(4,2,e,t)}function Ll(e,t){return Dl(4,4,e,t)}function Ul(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zl(e,t,a){return a=null!==a&&void 0!==a?a.concat([e]):null,Dl(4,4,Ul.bind(null,t,e),a)}function Il(){}function Gl(e,t){var a=yl();t=void 0===t?null:t;var n=a.memoizedState;return null!==n&&null!==t&&pl(t,n[1])?n[0]:(a.memoizedState=[e,t],e)}function Wl(e,t){var a=yl();t=void 0===t?null:t;var n=a.memoizedState;return null!==n&&null!==t&&pl(t,n[1])?n[0]:(e=e(),a.memoizedState=[e,t],e)}function Vl(e,t,a){return 0===(21&sl)?(e.baseState&&(e.baseState=!1,yi=!0),e.memoizedState=a):(ln(a,t)||(a=gt(),ll.lanes|=a,Oo|=a,e.baseState=!0),t)}function Bl(e,t){var a=bt;bt=0!==a&&4>a?a:4,e(!0);var n=rl.transition;rl.transition={};try{e(!1),t()}finally{bt=a,rl.transition=n}}function ql(){return yl().memoizedState}function Hl(e,t,a){var n=tc(e);if(a={lane:n,action:a,hasEagerState:!1,eagerState:null,next:null},$l(e))Kl(t,a);else if(null!==(a=Ds(e,t,a,n))){ac(a,e,n,ec()),Yl(a,t,n)}}function Ql(e,t,a){var n=tc(e),r={lane:n,action:a,hasEagerState:!1,eagerState:null,next:null};if($l(e))Kl(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var l=t.lastRenderedState,i=s(l,a);if(r.hasEagerState=!0,r.eagerState=i,ln(i,l)){var o=t.interleaved;return null===o?(r.next=r,As(t)):(r.next=o.next,o.next=r),void(t.interleaved=r)}}catch(c){}null!==(a=Ds(e,t,r,n))&&(ac(a,e,n,r=ec()),Yl(a,t,n))}}function $l(e){var t=e.alternate;return e===ll||null!==t&&t===ll}function Kl(e,t){dl=cl=!0;var a=e.pending;null===a?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function Yl(e,t,a){if(0!==(4194240&a)){var n=t.lanes;a|=n&=e.pendingLanes,t.lanes=a,yt(e,a)}}var Jl={readContext:Ms,useCallback:fl,useContext:fl,useEffect:fl,useImperativeHandle:fl,useInsertionEffect:fl,useLayoutEffect:fl,useMemo:fl,useReducer:fl,useRef:fl,useState:fl,useDebugValue:fl,useDeferredValue:fl,useTransition:fl,useMutableSource:fl,useSyncExternalStore:fl,useId:fl,unstable_isNewReconciler:!1},Xl={readContext:Ms,useCallback:function(e,t){return hl().memoizedState=[e,void 0===t?null:t],e},useContext:Ms,useEffect:Rl,useImperativeHandle:function(e,t,a){return a=null!==a&&void 0!==a?a.concat([e]):null,Al(4194308,4,Ul.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Al(4194308,4,e,t)},useInsertionEffect:function(e,t){return Al(4,2,e,t)},useMemo:function(e,t){var a=hl();return t=void 0===t?null:t,e=e(),a.memoizedState=[e,t],e},useReducer:function(e,t,a){var n=hl();return t=void 0!==a?a(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Hl.bind(null,ll,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},hl().memoizedState=e},useState:Pl,useDebugValue:Il,useDeferredValue:function(e){return hl().memoizedState=e},useTransition:function(){var e=Pl(!1),t=e[0];return e=Bl.bind(null,e[1]),hl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,a){var n=ll,r=hl();if(rs){if(void 0===a)throw Error(s(407));a=a()}else{if(a=t(),null===Po)throw Error(s(349));0!==(30&sl)||kl(n,t,a)}r.memoizedState=a;var l={value:a,getSnapshot:t};return r.queue=l,Rl(_l.bind(null,n,l,e),[e]),n.flags|=2048,Ml(9,Sl.bind(null,n,l,a,t),void 0,null),a},useId:function(){var e=hl(),t=Po.identifierPrefix;if(rs){var a=Jr;t=":"+t+"R"+(a=(Yr&~(1<<32-lt(Yr)-1)).toString(32)+a),0<(a=ul++)&&(t+="H"+a.toString(32)),t+=":"}else t=":"+t+"r"+(a=ml++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zl={readContext:Ms,useCallback:Gl,useContext:Ms,useEffect:Fl,useImperativeHandle:zl,useInsertionEffect:Ol,useLayoutEffect:Ll,useMemo:Wl,useReducer:vl,useRef:Tl,useState:function(){return vl(bl)},useDebugValue:Il,useDeferredValue:function(e){return Vl(yl(),il.memoizedState,e)},useTransition:function(){return[vl(bl)[0],yl().memoizedState]},useMutableSource:wl,useSyncExternalStore:Nl,useId:ql,unstable_isNewReconciler:!1},ei={readContext:Ms,useCallback:Gl,useContext:Ms,useEffect:Fl,useImperativeHandle:zl,useInsertionEffect:Ol,useLayoutEffect:Ll,useMemo:Wl,useReducer:jl,useRef:Tl,useState:function(){return jl(bl)},useDebugValue:Il,useDeferredValue:function(e){var t=yl();return null===il?t.memoizedState=e:Vl(t,il.memoizedState,e)},useTransition:function(){return[jl(bl)[0],yl().memoizedState]},useMutableSource:wl,useSyncExternalStore:Nl,useId:ql,unstable_isNewReconciler:!1};function ti(e,t){if(e&&e.defaultProps){for(var a in t=L({},t),e=e.defaultProps)void 0===t[a]&&(t[a]=e[a]);return t}return t}function ai(e,t,a,n){a=null===(a=a(n,t=e.memoizedState))||void 0===a?t:L({},t,a),e.memoizedState=a,0===e.lanes&&(e.updateQueue.baseState=a)}var ni={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,a){e=e._reactInternals;var n=ec(),r=tc(e),s=Us(n,r);s.payload=t,void 0!==a&&null!==a&&(s.callback=a),null!==(t=zs(e,s,r))&&(ac(t,e,r,n),Is(t,e,r))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var n=ec(),r=tc(e),s=Us(n,r);s.tag=1,s.payload=t,void 0!==a&&null!==a&&(s.callback=a),null!==(t=zs(e,s,r))&&(ac(t,e,r,n),Is(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=ec(),n=tc(e),r=Us(a,n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=zs(e,r,n))&&(ac(t,e,n,a),Is(t,e,n))}};function ri(e,t,a,n,r,s,l){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,l):!t.prototype||!t.prototype.isPureReactComponent||(!on(a,n)||!on(r,s))}function si(e,t,a){var n=!1,r=Cr,s=t.contextType;return"object"===typeof s&&null!==s?s=Ms(s):(r=Ar(t)?Mr:Er.current,s=(n=null!==(n=t.contextTypes)&&void 0!==n)?Tr(e,r):Cr),t=new t(a,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ni,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function li(e,t,a,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(a,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(a,n),t.state!==e&&ni.enqueueReplaceState(t,t.state,null)}function ii(e,t,a,n){var r=e.stateNode;r.props=a,r.state=e.memoizedState,r.refs={},Os(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Ms(s):(s=Ar(t)?Mr:Er.current,r.context=Tr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ai(e,t,s,a),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ni.enqueueReplaceState(r,r.state,null),Ws(e,a,r,n),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function oi(e,t){try{var a="",n=t;do{a+=G(n),n=n.return}while(n);var r=a}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ci(e,t,a){return{value:e,source:null,stack:null!=a?a:null,digest:null!=t?t:null}}function di(e,t){try{console.error(t.value)}catch(a){setTimeout(function(){throw a})}}var ui="function"===typeof WeakMap?WeakMap:Map;function mi(e,t,a){(a=Us(-1,a)).tag=3,a.payload={element:null};var n=t.value;return a.callback=function(){Bo||(Bo=!0,qo=n),di(0,t)},a}function fi(e,t,a){(a=Us(-1,a)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var r=t.value;a.payload=function(){return n(r)},a.callback=function(){di(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(a.callback=function(){di(0,t),"function"!==typeof n&&(null===Ho?Ho=new Set([this]):Ho.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),a}function pi(e,t,a){var n=e.pingCache;if(null===n){n=e.pingCache=new ui;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(a)||(r.add(a),e=Sc.bind(null,e,t,a),t.then(e,e))}function gi(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xi(e,t,a,n,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,1===a.tag&&(null===a.alternate?a.tag=17:((t=Us(-1,1)).tag=2,zs(a,t,1))),a.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var hi=v.ReactCurrentOwner,yi=!1;function bi(e,t,a,n){t.child=null===e?js(t,null,a,n):vs(t,e.child,a,n)}function vi(e,t,a,n,r){a=a.render;var s=t.ref;return Ps(t,r),n=gl(e,t,a,n,s,r),a=xl(),null===e||yi?(rs&&a&&es(t),t.flags|=1,bi(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Vi(e,t,r))}function ji(e,t,a,n,r){if(null===e){var s=a.type;return"function"!==typeof s||Ac(s)||void 0!==s.defaultProps||null!==a.compare||void 0!==a.defaultProps?((e=Rc(a.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,wi(e,t,s,n,r))}if(s=e.child,0===(e.lanes&r)){var l=s.memoizedProps;if((a=null!==(a=a.compare)?a:on)(l,n)&&e.ref===t.ref)return Vi(e,t,r)}return t.flags|=1,(e=Dc(s,n)).ref=t.ref,e.return=t,t.child=e}function wi(e,t,a,n,r){if(null!==e){var s=e.memoizedProps;if(on(s,n)&&e.ref===t.ref){if(yi=!1,t.pendingProps=n=s,0===(e.lanes&r))return t.lanes=e.lanes,Vi(e,t,r);0!==(131072&e.flags)&&(yi=!0)}}return Si(e,t,a,n,r)}function Ni(e,t,a){var n=t.pendingProps,r=n.children,s=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_r(Do,Ao),Ao|=a;else{if(0===(1073741824&a))return e=null!==s?s.baseLanes|a:a,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_r(Do,Ao),Ao|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==s?s.baseLanes:a,_r(Do,Ao),Ao|=n}else null!==s?(n=s.baseLanes|a,t.memoizedState=null):n=a,_r(Do,Ao),Ao|=n;return bi(e,t,r,a),t.child}function ki(e,t){var a=t.ref;(null===e&&null!==a||null!==e&&e.ref!==a)&&(t.flags|=512,t.flags|=2097152)}function Si(e,t,a,n,r){var s=Ar(a)?Mr:Er.current;return s=Tr(t,s),Ps(t,r),a=gl(e,t,a,n,s,r),n=xl(),null===e||yi?(rs&&n&&es(t),t.flags|=1,bi(e,t,a,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Vi(e,t,r))}function _i(e,t,a,n,r){if(Ar(a)){var s=!0;Or(t)}else s=!1;if(Ps(t,r),null===t.stateNode)Wi(e,t),si(t,a,n),ii(t,a,n,r),n=!0;else if(null===e){var l=t.stateNode,i=t.memoizedProps;l.props=i;var o=l.context,c=a.contextType;"object"===typeof c&&null!==c?c=Ms(c):c=Tr(t,c=Ar(a)?Mr:Er.current);var d=a.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof l.getSnapshotBeforeUpdate;u||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(i!==n||o!==c)&&li(t,l,n,c),Fs=!1;var m=t.memoizedState;l.state=m,Ws(t,n,l,r),o=t.memoizedState,i!==n||m!==o||Pr.current||Fs?("function"===typeof d&&(ai(t,a,d,n),o=t.memoizedState),(i=Fs||ri(t,a,i,n,m,o,c))?(u||"function"!==typeof l.UNSAFE_componentWillMount&&"function"!==typeof l.componentWillMount||("function"===typeof l.componentWillMount&&l.componentWillMount(),"function"===typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"===typeof l.componentDidMount&&(t.flags|=4194308)):("function"===typeof l.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=o),l.props=n,l.state=o,l.context=c,n=i):("function"===typeof l.componentDidMount&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Ls(e,t),i=t.memoizedProps,c=t.type===t.elementType?i:ti(t.type,i),l.props=c,u=t.pendingProps,m=l.context,"object"===typeof(o=a.contextType)&&null!==o?o=Ms(o):o=Tr(t,o=Ar(a)?Mr:Er.current);var f=a.getDerivedStateFromProps;(d="function"===typeof f||"function"===typeof l.getSnapshotBeforeUpdate)||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(i!==u||m!==o)&&li(t,l,n,o),Fs=!1,m=t.memoizedState,l.state=m,Ws(t,n,l,r);var p=t.memoizedState;i!==u||m!==p||Pr.current||Fs?("function"===typeof f&&(ai(t,a,f,n),p=t.memoizedState),(c=Fs||ri(t,a,c,n,m,p,o)||!1)?(d||"function"!==typeof l.UNSAFE_componentWillUpdate&&"function"!==typeof l.componentWillUpdate||("function"===typeof l.componentWillUpdate&&l.componentWillUpdate(n,p,o),"function"===typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(n,p,o)),"function"===typeof l.componentDidUpdate&&(t.flags|=4),"function"===typeof l.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof l.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),l.props=n,l.state=p,l.context=o,n=c):("function"!==typeof l.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return Ci(e,t,a,n,s,r)}function Ci(e,t,a,n,r,s){ki(e,t);var l=0!==(128&t.flags);if(!n&&!l)return r&&Lr(t,a,!1),Vi(e,t,s);n=t.stateNode,hi.current=t;var i=l&&"function"!==typeof a.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&l?(t.child=vs(t,e.child,null,s),t.child=vs(t,null,i,s)):bi(e,t,i,s),t.memoizedState=n.state,r&&Lr(t,a,!0),t.child}function Ei(e){var t=e.stateNode;t.pendingContext?Rr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Rr(0,t.context,!1),Ks(e,t.containerInfo)}function Pi(e,t,a,n,r){return fs(),ps(r),t.flags|=256,bi(e,t,a,n),t.child}var Mi,Ti,Ai,Di,Ri={dehydrated:null,treeContext:null,retryLane:0};function Fi(e){return{baseLanes:e,cachePool:null,transitions:null}}function Oi(e,t,a){var n,r=t.pendingProps,l=Zs.current,i=!1,o=0!==(128&t.flags);if((n=o)||(n=(null===e||null!==e.memoizedState)&&0!==(2&l)),n?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(l|=1),_r(Zs,1&l),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},0===(1&r)&&null!==i?(i.childLanes=0,i.pendingProps=o):i=Oc(o,r,0,null),e=Fc(e,r,a,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Fi(a),t.memoizedState=Ri,e):Li(t,o));if(null!==(l=e.memoizedState)&&null!==(n=l.dehydrated))return function(e,t,a,n,r,l,i){if(a)return 256&t.flags?(t.flags&=-257,Ui(e,t,i,n=ci(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(l=n.fallback,r=t.mode,n=Oc({mode:"visible",children:n.children},r,0,null),(l=Fc(l,r,i,null)).flags|=2,n.return=t,l.return=t,n.sibling=l,t.child=n,0!==(1&t.mode)&&vs(t,e.child,null,i),t.child.memoizedState=Fi(i),t.memoizedState=Ri,l);if(0===(1&t.mode))return Ui(e,t,i,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var o=n.dgst;return n=o,Ui(e,t,i,n=ci(l=Error(s(419)),n,void 0))}if(o=0!==(i&e.childLanes),yi||o){if(null!==(n=Po)){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(n.suspendedLanes|i))?0:r)&&r!==l.retryLane&&(l.retryLane=r,Rs(e,r),ac(n,e,r,-1))}return gc(),Ui(e,t,i,n=ci(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),r._reactRetry=t,null):(e=l.treeContext,ns=cr(r.nextSibling),as=t,rs=!0,ss=null,null!==e&&(Qr[$r++]=Yr,Qr[$r++]=Jr,Qr[$r++]=Kr,Yr=e.id,Jr=e.overflow,Kr=t),t=Li(t,n.children),t.flags|=4096,t)}(e,t,o,r,n,l,a);if(i){i=r.fallback,o=t.mode,n=(l=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&o)&&t.child!==l?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Dc(l,c)).subtreeFlags=14680064&l.subtreeFlags,null!==n?i=Dc(n,i):(i=Fc(i,o,a,null)).flags|=2,i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=null===(o=e.child.memoizedState)?Fi(a):{baseLanes:o.baseLanes|a,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~a,t.memoizedState=Ri,r}return e=(i=e.child).sibling,r=Dc(i,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=a),r.return=t,r.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=r,t.memoizedState=null,r}function Li(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ui(e,t,a,n){return null!==n&&ps(n),vs(t,e.child,null,a),(e=Li(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zi(e,t,a){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Es(e.return,t,a)}function Ii(e,t,a,n,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:a,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=a,s.tailMode=r)}function Gi(e,t,a){var n=t.pendingProps,r=n.revealOrder,s=n.tail;if(bi(e,t,n.children,a),0!==(2&(n=Zs.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zi(e,a,t);else if(19===e.tag)zi(e,a,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(_r(Zs,n),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(a=t.child,r=null;null!==a;)null!==(e=a.alternate)&&null===el(e)&&(r=a),a=a.sibling;null===(a=r)?(r=t.child,t.child=null):(r=a.sibling,a.sibling=null),Ii(t,!1,r,a,s);break;case"backwards":for(a=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===el(e)){t.child=r;break}e=r.sibling,r.sibling=a,a=r,r=e}Ii(t,!0,a,null,s);break;case"together":Ii(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wi(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vi(e,t,a){if(null!==e&&(t.dependencies=e.dependencies),Oo|=t.lanes,0===(a&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(a=Dc(e=t.child,e.pendingProps),t.child=a,a.return=t;null!==e.sibling;)e=e.sibling,(a=a.sibling=Dc(e,e.pendingProps)).return=t;a.sibling=null}return t.child}function Bi(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;null!==t;)null!==t.alternate&&(a=t),t=t.sibling;null===a?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var n=null;null!==a;)null!==a.alternate&&(n=a),a=a.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function qi(e){var t=null!==e.alternate&&e.alternate.child===e.child,a=0,n=0;if(t)for(var r=e.child;null!==r;)a|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)a|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=a,t}function Hi(e,t,a){var n=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qi(t),null;case 1:case 17:return Ar(t.type)&&Dr(),qi(t),null;case 3:return n=t.stateNode,Ys(),Sr(Pr),Sr(Er),al(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(us(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(lc(ss),ss=null))),Ti(e,t),qi(t),null;case 5:Xs(t);var r=$s(Qs.current);if(a=t.type,null!==e&&null!=t.stateNode)Ai(e,t,a,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(s(166));return qi(t),null}if(e=$s(qs.current),us(t)){n=t.stateNode,a=t.type;var l=t.memoizedProps;switch(n[mr]=t,n[fr]=l,e=0!==(1&t.mode),a){case"dialog":zn("cancel",n),zn("close",n);break;case"iframe":case"object":case"embed":zn("load",n);break;case"video":case"audio":for(r=0;r<Fn.length;r++)zn(Fn[r],n);break;case"source":zn("error",n);break;case"img":case"image":case"link":zn("error",n),zn("load",n);break;case"details":zn("toggle",n);break;case"input":Y(n,l),zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!l.multiple},zn("invalid",n);break;case"textarea":re(n,l),zn("invalid",n)}for(var o in ye(a,l),r=null,l)if(l.hasOwnProperty(o)){var c=l[o];"children"===o?"string"===typeof c?n.textContent!==c&&(!0!==l.suppressHydrationWarning&&Xn(n.textContent,c,e),r=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==l.suppressHydrationWarning&&Xn(n.textContent,c,e),r=["children",""+c]):i.hasOwnProperty(o)&&null!=c&&"onScroll"===o&&zn("scroll",n)}switch(a){case"input":H(n),Z(n,l,!0);break;case"textarea":H(n),le(n);break;case"select":case"option":break;default:"function"===typeof l.onClick&&(n.onclick=Zn)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{o=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(a)),"http://www.w3.org/1999/xhtml"===e?"script"===a?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=o.createElement(a,{is:n.is}):(e=o.createElement(a),"select"===a&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,a),e[mr]=t,e[fr]=n,Mi(e,t,!1,!1),t.stateNode=e;e:{switch(o=be(a,n),a){case"dialog":zn("cancel",e),zn("close",e),r=n;break;case"iframe":case"object":case"embed":zn("load",e),r=n;break;case"video":case"audio":for(r=0;r<Fn.length;r++)zn(Fn[r],e);r=n;break;case"source":zn("error",e),r=n;break;case"img":case"image":case"link":zn("error",e),zn("load",e),r=n;break;case"details":zn("toggle",e),r=n;break;case"input":Y(e,n),r=K(e,n),zn("invalid",e);break;case"option":default:r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=L({},n,{value:void 0}),zn("invalid",e);break;case"textarea":re(e,n),r=ne(e,n),zn("invalid",e)}for(l in ye(a,r),c=r)if(c.hasOwnProperty(l)){var d=c[l];"style"===l?xe(e,d):"dangerouslySetInnerHTML"===l?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===l?"string"===typeof d?("textarea"!==a||""!==d)&&me(e,d):"number"===typeof d&&me(e,""+d):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(i.hasOwnProperty(l)?null!=d&&"onScroll"===l&&zn("scroll",e):null!=d&&b(e,l,d,o))}switch(a){case"input":H(e),Z(e,n,!1);break;case"textarea":H(e),le(e);break;case"option":null!=n.value&&e.setAttribute("value",""+B(n.value));break;case"select":e.multiple=!!n.multiple,null!=(l=n.value)?ae(e,!!n.multiple,l,!1):null!=n.defaultValue&&ae(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Zn)}switch(a){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qi(t),null;case 6:if(e&&null!=t.stateNode)Di(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(s(166));if(a=$s(Qs.current),$s(qs.current),us(t)){if(n=t.stateNode,a=t.memoizedProps,n[mr]=t,(l=n.nodeValue!==a)&&null!==(e=as))switch(e.tag){case 3:Xn(n.nodeValue,a,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xn(n.nodeValue,a,0!==(1&e.mode))}l&&(t.flags|=4)}else(n=(9===a.nodeType?a:a.ownerDocument).createTextNode(n))[mr]=t,t.stateNode=n}return qi(t),null;case 13:if(Sr(Zs),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==ns&&0!==(1&t.mode)&&0===(128&t.flags))ms(),fs(),t.flags|=98560,l=!1;else if(l=us(t),null!==n&&null!==n.dehydrated){if(null===e){if(!l)throw Error(s(318));if(!(l=null!==(l=t.memoizedState)?l.dehydrated:null))throw Error(s(317));l[mr]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qi(t),l=!1}else null!==ss&&(lc(ss),ss=null),l=!0;if(!l)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=a,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Ro&&(Ro=3):gc())),null!==t.updateQueue&&(t.flags|=4),qi(t),null);case 4:return Ys(),Ti(e,t),null===e&&Wn(t.stateNode.containerInfo),qi(t),null;case 10:return Cs(t.type._context),qi(t),null;case 19:if(Sr(Zs),null===(l=t.memoizedState))return qi(t),null;if(n=0!==(128&t.flags),null===(o=l.rendering))if(n)Bi(l,!1);else{if(0!==Ro||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=el(e))){for(t.flags|=128,Bi(l,!1),null!==(n=o.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=a,a=t.child;null!==a;)e=n,(l=a).flags&=14680066,null===(o=l.alternate)?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,e=o.dependencies,l.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return _r(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==l.tail&&Je()>Wo&&(t.flags|=128,n=!0,Bi(l,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=el(o))){if(t.flags|=128,n=!0,null!==(a=e.updateQueue)&&(t.updateQueue=a,t.flags|=4),Bi(l,!0),null===l.tail&&"hidden"===l.tailMode&&!o.alternate&&!rs)return qi(t),null}else 2*Je()-l.renderingStartTime>Wo&&1073741824!==a&&(t.flags|=128,n=!0,Bi(l,!1),t.lanes=4194304);l.isBackwards?(o.sibling=t.child,t.child=o):(null!==(a=l.last)?a.sibling=o:t.child=o,l.last=o)}return null!==l.tail?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Je(),t.sibling=null,a=Zs.current,_r(Zs,n?1&a|2:1&a),t):(qi(t),null);case 22:case 23:return uc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Ao)&&(qi(t),6&t.subtreeFlags&&(t.flags|=8192)):qi(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qi(e,t){switch(ts(t),t.tag){case 1:return Ar(t.type)&&Dr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),Sr(Pr),Sr(Er),al(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xs(t),null;case 13:if(Sr(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sr(Zs),null;case 4:return Ys(),null;case 10:return Cs(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Mi=function(e,t){for(var a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},Ti=function(){},Ai=function(e,t,a,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,$s(qs.current);var s,l=null;switch(a){case"input":r=K(e,r),n=K(e,n),l=[];break;case"select":r=L({},r,{value:void 0}),n=L({},n,{value:void 0}),l=[];break;case"textarea":r=ne(e,r),n=ne(e,n),l=[];break;default:"function"!==typeof r.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(d in ye(a,n),a=null,r)if(!n.hasOwnProperty(d)&&r.hasOwnProperty(d)&&null!=r[d])if("style"===d){var o=r[d];for(s in o)o.hasOwnProperty(s)&&(a||(a={}),a[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(i.hasOwnProperty(d)?l||(l=[]):(l=l||[]).push(d,null));for(d in n){var c=n[d];if(o=null!=r?r[d]:void 0,n.hasOwnProperty(d)&&c!==o&&(null!=c||null!=o))if("style"===d)if(o){for(s in o)!o.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(a||(a={}),a[s]="");for(s in c)c.hasOwnProperty(s)&&o[s]!==c[s]&&(a||(a={}),a[s]=c[s])}else a||(l||(l=[]),l.push(d,a)),a=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,o=o?o.__html:void 0,null!=c&&o!==c&&(l=l||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(l=l||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(i.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&zn("scroll",e),l||o===c||(l=[])):(l=l||[]).push(d,c))}a&&(l=l||[]).push("style",a);var d=l;(t.updateQueue=d)&&(t.flags|=4)}},Di=function(e,t,a,n){a!==n&&(t.flags|=4)};var $i=!1,Ki=!1,Yi="function"===typeof WeakSet?WeakSet:Set,Ji=null;function Xi(e,t){var a=e.ref;if(null!==a)if("function"===typeof a)try{a(null)}catch(n){kc(e,t,n)}else a.current=null}function Zi(e,t,a){try{a()}catch(n){kc(e,t,n)}}var eo=!1;function to(e,t,a){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&Zi(t,a,s)}r=r.next}while(r!==n)}}function ao(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var a=t=t.next;do{if((a.tag&e)===e){var n=a.create;a.destroy=n()}a=a.next}while(a!==t)}}function no(e){var t=e.ref;if(null!==t){var a=e.stateNode;e.tag,e=a,"function"===typeof t?t(e):t.current=e}}function ro(e){var t=e.alternate;null!==t&&(e.alternate=null,ro(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[mr],delete t[fr],delete t[gr],delete t[xr],delete t[hr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function so(e){return 5===e.tag||3===e.tag||4===e.tag}function lo(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||so(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function io(e,t,a){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===a.nodeType?a.parentNode.insertBefore(e,t):a.insertBefore(e,t):(8===a.nodeType?(t=a.parentNode).insertBefore(e,a):(t=a).appendChild(e),null!==(a=a._reactRootContainer)&&void 0!==a||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(io(e,t,a),e=e.sibling;null!==e;)io(e,t,a),e=e.sibling}function oo(e,t,a){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(4!==n&&null!==(e=e.child))for(oo(e,t,a),e=e.sibling;null!==e;)oo(e,t,a),e=e.sibling}var co=null,uo=!1;function mo(e,t,a){for(a=a.child;null!==a;)fo(e,t,a),a=a.sibling}function fo(e,t,a){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,a)}catch(i){}switch(a.tag){case 5:Ki||Xi(a,t);case 6:var n=co,r=uo;co=null,mo(e,t,a),uo=r,null!==(co=n)&&(uo?(e=co,a=a.stateNode,8===e.nodeType?e.parentNode.removeChild(a):e.removeChild(a)):co.removeChild(a.stateNode));break;case 18:null!==co&&(uo?(e=co,a=a.stateNode,8===e.nodeType?or(e.parentNode,a):1===e.nodeType&&or(e,a),Wt(e)):or(co,a.stateNode));break;case 4:n=co,r=uo,co=a.stateNode.containerInfo,uo=!0,mo(e,t,a),co=n,uo=r;break;case 0:case 11:case 14:case 15:if(!Ki&&(null!==(n=a.updateQueue)&&null!==(n=n.lastEffect))){r=n=n.next;do{var s=r,l=s.destroy;s=s.tag,void 0!==l&&(0!==(2&s)||0!==(4&s))&&Zi(a,t,l),r=r.next}while(r!==n)}mo(e,t,a);break;case 1:if(!Ki&&(Xi(a,t),"function"===typeof(n=a.stateNode).componentWillUnmount))try{n.props=a.memoizedProps,n.state=a.memoizedState,n.componentWillUnmount()}catch(i){kc(a,t,i)}mo(e,t,a);break;case 21:mo(e,t,a);break;case 22:1&a.mode?(Ki=(n=Ki)||null!==a.memoizedState,mo(e,t,a),Ki=n):mo(e,t,a);break;default:mo(e,t,a)}}function po(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var a=e.stateNode;null===a&&(a=e.stateNode=new Yi),t.forEach(function(t){var n=Ec.bind(null,e,t);a.has(t)||(a.add(t),t.then(n,n))})}}function go(e,t){var a=t.deletions;if(null!==a)for(var n=0;n<a.length;n++){var r=a[n];try{var l=e,i=t,o=i;e:for(;null!==o;){switch(o.tag){case 5:co=o.stateNode,uo=!1;break e;case 3:case 4:co=o.stateNode.containerInfo,uo=!0;break e}o=o.return}if(null===co)throw Error(s(160));fo(l,i,r),co=null,uo=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(d){kc(r,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)xo(t,e),t=t.sibling}function xo(e,t){var a=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(go(t,e),ho(e),4&n){try{to(3,e,e.return),ao(3,e)}catch(x){kc(e,e.return,x)}try{to(5,e,e.return)}catch(x){kc(e,e.return,x)}}break;case 1:go(t,e),ho(e),512&n&&null!==a&&Xi(a,a.return);break;case 5:if(go(t,e),ho(e),512&n&&null!==a&&Xi(a,a.return),32&e.flags){var r=e.stateNode;try{me(r,"")}catch(x){kc(e,e.return,x)}}if(4&n&&null!=(r=e.stateNode)){var l=e.memoizedProps,i=null!==a?a.memoizedProps:l,o=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===o&&"radio"===l.type&&null!=l.name&&J(r,l),be(o,i);var d=be(o,l);for(i=0;i<c.length;i+=2){var u=c[i],m=c[i+1];"style"===u?xe(r,m):"dangerouslySetInnerHTML"===u?ue(r,m):"children"===u?me(r,m):b(r,u,m,d)}switch(o){case"input":X(r,l);break;case"textarea":se(r,l);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!l.multiple;var p=l.value;null!=p?ae(r,!!l.multiple,p,!1):f!==!!l.multiple&&(null!=l.defaultValue?ae(r,!!l.multiple,l.defaultValue,!0):ae(r,!!l.multiple,l.multiple?[]:"",!1))}r[fr]=l}catch(x){kc(e,e.return,x)}}break;case 6:if(go(t,e),ho(e),4&n){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,l=e.memoizedProps;try{r.nodeValue=l}catch(x){kc(e,e.return,x)}}break;case 3:if(go(t,e),ho(e),4&n&&null!==a&&a.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(x){kc(e,e.return,x)}break;case 4:default:go(t,e),ho(e);break;case 13:go(t,e),ho(e),8192&(r=e.child).flags&&(l=null!==r.memoizedState,r.stateNode.isHidden=l,!l||null!==r.alternate&&null!==r.alternate.memoizedState||(Go=Je())),4&n&&po(e);break;case 22:if(u=null!==a&&null!==a.memoizedState,1&e.mode?(Ki=(d=Ki)||u,go(t,e),Ki=d):go(t,e),ho(e),8192&n){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Ji=e,u=e.child;null!==u;){for(m=Ji=u;null!==Ji;){switch(p=(f=Ji).child,f.tag){case 0:case 11:case 14:case 15:to(4,f,f.return);break;case 1:Xi(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){n=f,a=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(x){kc(n,a,x)}}break;case 5:Xi(f,f.return);break;case 22:if(null!==f.memoizedState){jo(m);continue}}null!==p?(p.return=f,Ji=p):jo(m)}u=u.sibling}e:for(u=null,m=e;;){if(5===m.tag){if(null===u){u=m;try{r=m.stateNode,d?"function"===typeof(l=r.style).setProperty?l.setProperty("display","none","important"):l.display="none":(o=m.stateNode,i=void 0!==(c=m.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,o.style.display=ge("display",i))}catch(x){kc(e,e.return,x)}}}else if(6===m.tag){if(null===u)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(x){kc(e,e.return,x)}}else if((22!==m.tag&&23!==m.tag||null===m.memoizedState||m===e)&&null!==m.child){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;null===m.sibling;){if(null===m.return||m.return===e)break e;u===m&&(u=null),m=m.return}u===m&&(u=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:go(t,e),ho(e),4&n&&po(e);case 21:}}function ho(e){var t=e.flags;if(2&t){try{e:{for(var a=e.return;null!==a;){if(so(a)){var n=a;break e}a=a.return}throw Error(s(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(me(r,""),n.flags&=-33),oo(e,lo(e),r);break;case 3:case 4:var l=n.stateNode.containerInfo;io(e,lo(e),l);break;default:throw Error(s(161))}}catch(i){kc(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yo(e,t,a){Ji=e,bo(e,t,a)}function bo(e,t,a){for(var n=0!==(1&e.mode);null!==Ji;){var r=Ji,s=r.child;if(22===r.tag&&n){var l=null!==r.memoizedState||$i;if(!l){var i=r.alternate,o=null!==i&&null!==i.memoizedState||Ki;i=$i;var c=Ki;if($i=l,(Ki=o)&&!c)for(Ji=r;null!==Ji;)o=(l=Ji).child,22===l.tag&&null!==l.memoizedState?wo(r):null!==o?(o.return=l,Ji=o):wo(r);for(;null!==s;)Ji=s,bo(s,t,a),s=s.sibling;Ji=r,$i=i,Ki=c}vo(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Ji=s):vo(e)}}function vo(e){for(;null!==Ji;){var t=Ji;if(0!==(8772&t.flags)){var a=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ki||ao(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ki)if(null===a)n.componentDidMount();else{var r=t.elementType===t.type?a.memoizedProps:ti(t.type,a.memoizedProps);n.componentDidUpdate(r,a.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;null!==l&&Vs(t,l,n);break;case 3:var i=t.updateQueue;if(null!==i){if(a=null,null!==t.child)switch(t.child.tag){case 5:case 1:a=t.child.stateNode}Vs(t,i,a)}break;case 5:var o=t.stateNode;if(null===a&&4&t.flags){a=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&a.focus();break;case"img":c.src&&(a.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var m=u.dehydrated;null!==m&&Wt(m)}}}break;default:throw Error(s(163))}Ki||512&t.flags&&no(t)}catch(f){kc(t,t.return,f)}}if(t===e){Ji=null;break}if(null!==(a=t.sibling)){a.return=t.return,Ji=a;break}Ji=t.return}}function jo(e){for(;null!==Ji;){var t=Ji;if(t===e){Ji=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ji=a;break}Ji=t.return}}function wo(e){for(;null!==Ji;){var t=Ji;try{switch(t.tag){case 0:case 11:case 15:var a=t.return;try{ao(4,t)}catch(o){kc(t,a,o)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(o){kc(t,r,o)}}var s=t.return;try{no(t)}catch(o){kc(t,s,o)}break;case 5:var l=t.return;try{no(t)}catch(o){kc(t,l,o)}}}catch(o){kc(t,t.return,o)}if(t===e){Ji=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Ji=i;break}Ji=t.return}}var No,ko=Math.ceil,So=v.ReactCurrentDispatcher,_o=v.ReactCurrentOwner,Co=v.ReactCurrentBatchConfig,Eo=0,Po=null,Mo=null,To=0,Ao=0,Do=kr(0),Ro=0,Fo=null,Oo=0,Lo=0,Uo=0,zo=null,Io=null,Go=0,Wo=1/0,Vo=null,Bo=!1,qo=null,Ho=null,Qo=!1,$o=null,Ko=0,Yo=0,Jo=null,Xo=-1,Zo=0;function ec(){return 0!==(6&Eo)?Je():-1!==Xo?Xo:Xo=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Eo)&&0!==To?To&-To:null!==gs.transition?(0===Zo&&(Zo=gt()),Zo):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function ac(e,t,a,n){if(50<Yo)throw Yo=0,Jo=null,Error(s(185));ht(e,a,n),0!==(2&Eo)&&e===Po||(e===Po&&(0===(2&Eo)&&(Lo|=a),4===Ro&&ic(e,To)),nc(e,n),1===a&&0===Eo&&0===(1&t.mode)&&(Wo=Je()+500,zr&&Wr()))}function nc(e,t){var a=e.callbackNode;!function(e,t){for(var a=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-lt(s),i=1<<l,o=r[l];-1===o?0!==(i&a)&&0===(i&n)||(r[l]=ft(i,t)):o<=t&&(e.expiredLanes|=i),s&=~i}}(e,t);var n=mt(e,e===Po?To:0);if(0===n)null!==a&&$e(a),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=a&&$e(a),1===t)0===e.tag?function(e){zr=!0,Gr(e)}(oc.bind(null,e)):Gr(oc.bind(null,e)),lr(function(){0===(6&Eo)&&Wr()}),a=null;else{switch(vt(n)){case 1:a=Ze;break;case 4:a=et;break;case 16:default:a=tt;break;case 536870912:a=nt}a=Pc(a,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=a}}function rc(e,t){if(Xo=-1,Zo=0,0!==(6&Eo))throw Error(s(327));var a=e.callbackNode;if(wc()&&e.callbackNode!==a)return null;var n=mt(e,e===Po?To:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=xc(e,n);else{t=n;var r=Eo;Eo|=2;var l=pc();for(Po===e&&To===t||(Vo=null,Wo=Je()+500,mc(e,t));;)try{yc();break}catch(o){fc(e,o)}_s(),So.current=l,Eo=r,null!==Mo?t=0:(Po=null,To=0,t=Ro)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(n=r,t=sc(e,r))),1===t)throw a=Fo,mc(e,0),ic(e,n),nc(e,Je()),a;if(6===t)ic(e,n);else{if(r=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var a=t.updateQueue;if(null!==a&&null!==(a=a.stores))for(var n=0;n<a.length;n++){var r=a[n],s=r.getSnapshot;r=r.value;try{if(!ln(s(),r))return!1}catch(i){return!1}}}if(a=t.child,16384&t.subtreeFlags&&null!==a)a.return=t,t=a;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=xc(e,n))&&(0!==(l=pt(e))&&(n=l,t=sc(e,l))),1===t))throw a=Fo,mc(e,0),ic(e,n),nc(e,Je()),a;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(s(345));case 2:case 5:jc(e,Io,Vo);break;case 3:if(ic(e,n),(130023424&n)===n&&10<(t=Go+500-Je())){if(0!==mt(e,0))break;if(((r=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=nr(jc.bind(null,e,Io,Vo),t);break}jc(e,Io,Vo);break;case 4:if(ic(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var i=31-lt(n);l=1<<i,(i=t[i])>r&&(r=i),n&=~l}if(n=r,10<(n=(120>(n=Je()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ko(n/1960))-n)){e.timeoutHandle=nr(jc.bind(null,e,Io,Vo),n);break}jc(e,Io,Vo);break;default:throw Error(s(329))}}}return nc(e,Je()),e.callbackNode===a?rc.bind(null,e):null}function sc(e,t){var a=zo;return e.current.memoizedState.isDehydrated&&(mc(e,t).flags|=256),2!==(e=xc(e,t))&&(t=Io,Io=a,null!==t&&lc(t)),e}function lc(e){null===Io?Io=e:Io.push.apply(Io,e)}function ic(e,t){for(t&=~Uo,t&=~Lo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var a=31-lt(t),n=1<<a;e[a]=-1,t&=~n}}function oc(e){if(0!==(6&Eo))throw Error(s(327));wc();var t=mt(e,0);if(0===(1&t))return nc(e,Je()),null;var a=xc(e,t);if(0!==e.tag&&2===a){var n=pt(e);0!==n&&(t=n,a=sc(e,n))}if(1===a)throw a=Fo,mc(e,0),ic(e,t),nc(e,Je()),a;if(6===a)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jc(e,Io,Vo),nc(e,Je()),null}function cc(e,t){var a=Eo;Eo|=1;try{return e(t)}finally{0===(Eo=a)&&(Wo=Je()+500,zr&&Wr())}}function dc(e){null!==$o&&0===$o.tag&&0===(6&Eo)&&wc();var t=Eo;Eo|=1;var a=Co.transition,n=bt;try{if(Co.transition=null,bt=1,e)return e()}finally{bt=n,Co.transition=a,0===(6&(Eo=t))&&Wr()}}function uc(){Ao=Do.current,Sr(Do)}function mc(e,t){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(-1!==a&&(e.timeoutHandle=-1,rr(a)),null!==Mo)for(a=Mo.return;null!==a;){var n=a;switch(ts(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Dr();break;case 3:Ys(),Sr(Pr),Sr(Er),al();break;case 5:Xs(n);break;case 4:Ys();break;case 13:case 19:Sr(Zs);break;case 10:Cs(n.type._context);break;case 22:case 23:uc()}a=a.return}if(Po=e,Mo=e=Dc(e.current,null),To=Ao=t,Ro=0,Fo=null,Uo=Lo=Oo=0,Io=zo=null,null!==Ts){for(t=0;t<Ts.length;t++)if(null!==(n=(a=Ts[t]).interleaved)){a.interleaved=null;var r=n.next,s=a.pending;if(null!==s){var l=s.next;s.next=r,n.next=l}a.pending=n}Ts=null}return e}function fc(e,t){for(;;){var a=Mo;try{if(_s(),nl.current=Jl,cl){for(var n=ll.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}cl=!1}if(sl=0,ol=il=ll=null,dl=!1,ul=0,_o.current=null,null===a||null===a.return){Ro=1,Fo=t,Mo=null;break}e:{var l=e,i=a.return,o=a,c=t;if(t=To,o.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=o,m=u.tag;if(0===(1&u.mode)&&(0===m||11===m||15===m)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=gi(i);if(null!==p){p.flags&=-257,xi(p,i,o,0,t),1&p.mode&&pi(l,d,t),c=d;var g=(t=p).updateQueue;if(null===g){var x=new Set;x.add(c),t.updateQueue=x}else g.add(c);break e}if(0===(1&t)){pi(l,d,t),gc();break e}c=Error(s(426))}else if(rs&&1&o.mode){var h=gi(i);if(null!==h){0===(65536&h.flags)&&(h.flags|=256),xi(h,i,o,0,t),ps(oi(c,o));break e}}l=c=oi(c,o),4!==Ro&&(Ro=2),null===zo?zo=[l]:zo.push(l),l=i;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,Gs(l,mi(0,c,t));break e;case 1:o=c;var y=l.type,b=l.stateNode;if(0===(128&l.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Ho||!Ho.has(b)))){l.flags|=65536,t&=-t,l.lanes|=t,Gs(l,fi(l,o,t));break e}}l=l.return}while(null!==l)}vc(a)}catch(v){t=v,Mo===a&&null!==a&&(Mo=a=a.return);continue}break}}function pc(){var e=So.current;return So.current=Jl,null===e?Jl:e}function gc(){0!==Ro&&3!==Ro&&2!==Ro||(Ro=4),null===Po||0===(268435455&Oo)&&0===(268435455&Lo)||ic(Po,To)}function xc(e,t){var a=Eo;Eo|=2;var n=pc();for(Po===e&&To===t||(Vo=null,mc(e,t));;)try{hc();break}catch(r){fc(e,r)}if(_s(),Eo=a,So.current=n,null!==Mo)throw Error(s(261));return Po=null,To=0,Ro}function hc(){for(;null!==Mo;)bc(Mo)}function yc(){for(;null!==Mo&&!Ke();)bc(Mo)}function bc(e){var t=No(e.alternate,e,Ao);e.memoizedProps=e.pendingProps,null===t?vc(e):Mo=t,_o.current=null}function vc(e){var t=e;do{var a=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(a=Hi(a,t,Ao)))return void(Mo=a)}else{if(null!==(a=Qi(a,t)))return a.flags&=32767,void(Mo=a);if(null===e)return Ro=6,void(Mo=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Mo=t);Mo=t=e}while(null!==t);0===Ro&&(Ro=5)}function jc(e,t,a){var n=bt,r=Co.transition;try{Co.transition=null,bt=1,function(e,t,a,n){do{wc()}while(null!==$o);if(0!==(6&Eo))throw Error(s(327));a=e.finishedWork;var r=e.finishedLanes;if(null===a)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var l=a.lanes|a.childLanes;if(function(e,t){var a=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<a;){var r=31-lt(a),s=1<<r;t[r]=0,n[r]=-1,e[r]=-1,a&=~s}}(e,l),e===Po&&(Mo=Po=null,To=0),0===(2064&a.subtreeFlags)&&0===(2064&a.flags)||Qo||(Qo=!0,Pc(tt,function(){return wc(),null})),l=0!==(15990&a.flags),0!==(15990&a.subtreeFlags)||l){l=Co.transition,Co.transition=null;var i=bt;bt=1;var o=Eo;Eo|=4,_o.current=null,function(e,t){if(er=Bt,fn(e=mn())){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(a=(a=e.ownerDocument)&&a.defaultView||window).getSelection&&a.getSelection();if(n&&0!==n.rangeCount){a=n.anchorNode;var r=n.anchorOffset,l=n.focusNode;n=n.focusOffset;try{a.nodeType,l.nodeType}catch(j){a=null;break e}var i=0,o=-1,c=-1,d=0,u=0,m=e,f=null;t:for(;;){for(var p;m!==a||0!==r&&3!==m.nodeType||(o=i+r),m!==l||0!==n&&3!==m.nodeType||(c=i+n),3===m.nodeType&&(i+=m.nodeValue.length),null!==(p=m.firstChild);)f=m,m=p;for(;;){if(m===e)break t;if(f===a&&++d===r&&(o=i),f===l&&++u===n&&(c=i),null!==(p=m.nextSibling))break;f=(m=f).parentNode}m=p}a=-1===o||-1===c?null:{start:o,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(tr={focusedElem:e,selectionRange:a},Bt=!1,Ji=t;null!==Ji;)if(e=(t=Ji).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ji=e;else for(;null!==Ji;){t=Ji;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var x=g.memoizedProps,h=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:ti(t.type,x),h);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(s(163))}}catch(j){kc(t,t.return,j)}if(null!==(e=t.sibling)){e.return=t.return,Ji=e;break}Ji=t.return}g=eo,eo=!1}(e,a),xo(a,e),pn(tr),Bt=!!er,tr=er=null,e.current=a,yo(a,e,r),Ye(),Eo=o,bt=i,Co.transition=l}else e.current=a;if(Qo&&(Qo=!1,$o=e,Ko=r),l=e.pendingLanes,0===l&&(Ho=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(a.stateNode),nc(e,Je()),null!==t)for(n=e.onRecoverableError,a=0;a<t.length;a++)r=t[a],n(r.value,{componentStack:r.stack,digest:r.digest});if(Bo)throw Bo=!1,e=qo,qo=null,e;0!==(1&Ko)&&0!==e.tag&&wc(),l=e.pendingLanes,0!==(1&l)?e===Jo?Yo++:(Yo=0,Jo=e):Yo=0,Wr()}(e,t,a,n)}finally{Co.transition=r,bt=n}return null}function wc(){if(null!==$o){var e=vt(Ko),t=Co.transition,a=bt;try{if(Co.transition=null,bt=16>e?16:e,null===$o)var n=!1;else{if(e=$o,$o=null,Ko=0,0!==(6&Eo))throw Error(s(331));var r=Eo;for(Eo|=4,Ji=e.current;null!==Ji;){var l=Ji,i=l.child;if(0!==(16&Ji.flags)){var o=l.deletions;if(null!==o){for(var c=0;c<o.length;c++){var d=o[c];for(Ji=d;null!==Ji;){var u=Ji;switch(u.tag){case 0:case 11:case 15:to(8,u,l)}var m=u.child;if(null!==m)m.return=u,Ji=m;else for(;null!==Ji;){var f=(u=Ji).sibling,p=u.return;if(ro(u),u===d){Ji=null;break}if(null!==f){f.return=p,Ji=f;break}Ji=p}}}var g=l.alternate;if(null!==g){var x=g.child;if(null!==x){g.child=null;do{var h=x.sibling;x.sibling=null,x=h}while(null!==x)}}Ji=l}}if(0!==(2064&l.subtreeFlags)&&null!==i)i.return=l,Ji=i;else e:for(;null!==Ji;){if(0!==(2048&(l=Ji).flags))switch(l.tag){case 0:case 11:case 15:to(9,l,l.return)}var y=l.sibling;if(null!==y){y.return=l.return,Ji=y;break e}Ji=l.return}}var b=e.current;for(Ji=b;null!==Ji;){var v=(i=Ji).child;if(0!==(2064&i.subtreeFlags)&&null!==v)v.return=i,Ji=v;else e:for(i=b;null!==Ji;){if(0!==(2048&(o=Ji).flags))try{switch(o.tag){case 0:case 11:case 15:ao(9,o)}}catch(w){kc(o,o.return,w)}if(o===i){Ji=null;break e}var j=o.sibling;if(null!==j){j.return=o.return,Ji=j;break e}Ji=o.return}}if(Eo=r,Wr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(w){}n=!0}return n}finally{bt=a,Co.transition=t}}return!1}function Nc(e,t,a){e=zs(e,t=mi(0,t=oi(a,t),1),1),t=ec(),null!==e&&(ht(e,1,t),nc(e,t))}function kc(e,t,a){if(3===e.tag)Nc(e,e,a);else for(;null!==t;){if(3===t.tag){Nc(t,e,a);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Ho||!Ho.has(n))){t=zs(t,e=fi(t,e=oi(a,e),1),1),e=ec(),null!==t&&(ht(t,1,e),nc(t,e));break}}t=t.return}}function Sc(e,t,a){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&a,Po===e&&(To&a)===a&&(4===Ro||3===Ro&&(130023424&To)===To&&500>Je()-Go?mc(e,0):Uo|=a),nc(e,t)}function _c(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var a=ec();null!==(e=Rs(e,t))&&(ht(e,t,a),nc(e,a))}function Cc(e){var t=e.memoizedState,a=0;null!==t&&(a=t.retryLane),_c(e,a)}function Ec(e,t){var a=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(a=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(s(314))}null!==n&&n.delete(t),_c(e,a)}function Pc(e,t){return Qe(e,t)}function Mc(e,t,a,n){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,a,n){return new Mc(e,t,a,n)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var a=e.alternate;return null===a?((a=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=14680064&e.flags,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function Rc(e,t,a,n,r,l){var i=2;if(n=e,"function"===typeof e)Ac(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case N:return Fc(a.children,r,l,t);case k:i=8,r|=8;break;case S:return(e=Tc(12,a,t,2|r)).elementType=S,e.lanes=l,e;case P:return(e=Tc(13,a,t,r)).elementType=P,e.lanes=l,e;case M:return(e=Tc(19,a,t,r)).elementType=M,e.lanes=l,e;case D:return Oc(a,r,l,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:i=10;break e;case C:i=9;break e;case E:i=11;break e;case T:i=14;break e;case A:i=16,n=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Tc(i,a,t,r)).elementType=e,t.type=n,t.lanes=l,t}function Fc(e,t,a,n){return(e=Tc(7,e,n,t)).lanes=a,e}function Oc(e,t,a,n){return(e=Tc(22,e,n,t)).elementType=D,e.lanes=a,e.stateNode={isHidden:!1},e}function Lc(e,t,a){return(e=Tc(6,e,null,t)).lanes=a,e}function Uc(e,t,a){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,a,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xt(0),this.expirationTimes=xt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xt(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Ic(e,t,a,n,r,s,l,i,o){return e=new zc(e,t,a,i,o),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Tc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Os(s),e}function Gc(e){if(!e)return Cr;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ar(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var a=e.type;if(Ar(a))return Fr(e,a,t)}return t}function Wc(e,t,a,n,r,s,l,i,o){return(e=Ic(a,n,!0,e,0,s,0,i,o)).context=Gc(null),a=e.current,(s=Us(n=ec(),r=tc(a))).callback=void 0!==t&&null!==t?t:null,zs(a,s,r),e.current.lanes=r,ht(e,r,n),nc(e,n),e}function Vc(e,t,a,n){var r=t.current,s=ec(),l=tc(r);return a=Gc(a),null===t.context?t.context=a:t.pendingContext=a,(t=Us(s,l)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=zs(r,t,l))&&(ac(e,r,l,s),Is(e,r,l)),l}function Bc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var a=e.retryLane;e.retryLane=0!==a&&a<t?a:t}}function Hc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}No=function(e,t,a){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pr.current)yi=!0;else{if(0===(e.lanes&a)&&0===(128&t.flags))return yi=!1,function(e,t,a){switch(t.tag){case 3:Ei(t),fs();break;case 5:Js(t);break;case 1:Ar(t.type)&&Or(t);break;case 4:Ks(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;_r(ws,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(_r(Zs,1&Zs.current),t.flags|=128,null):0!==(a&t.child.childLanes)?Oi(e,t,a):(_r(Zs,1&Zs.current),null!==(e=Vi(e,t,a))?e.sibling:null);_r(Zs,1&Zs.current);break;case 19:if(n=0!==(a&t.childLanes),0!==(128&e.flags)){if(n)return Gi(e,t,a);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),_r(Zs,Zs.current),n)break;return null;case 22:case 23:return t.lanes=0,Ni(e,t,a)}return Vi(e,t,a)}(e,t,a);yi=0!==(131072&e.flags)}else yi=!1,rs&&0!==(1048576&t.flags)&&Zr(t,Hr,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Wi(e,t),e=t.pendingProps;var r=Tr(t,Er.current);Ps(t,a),r=gl(null,t,n,e,r,a);var l=xl();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ar(n)?(l=!0,Or(t)):l=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Os(t),r.updater=ni,t.stateNode=r,r._reactInternals=t,ii(t,n,e,a),t=Ci(null,t,n,!0,l,a)):(t.tag=0,rs&&l&&es(t),bi(null,t,r,a),t=t.child),t;case 16:n=t.elementType;e:{switch(Wi(e,t),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"===typeof e)return Ac(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===T)return 14}return 2}(n),e=ti(n,e),r){case 0:t=Si(null,t,n,e,a);break e;case 1:t=_i(null,t,n,e,a);break e;case 11:t=vi(null,t,n,e,a);break e;case 14:t=ji(null,t,n,ti(n.type,e),a);break e}throw Error(s(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,Si(e,t,n,r=t.elementType===n?r:ti(n,r),a);case 1:return n=t.type,r=t.pendingProps,_i(e,t,n,r=t.elementType===n?r:ti(n,r),a);case 3:e:{if(Ei(t),null===e)throw Error(s(387));n=t.pendingProps,r=(l=t.memoizedState).element,Ls(e,t),Ws(t,n,null,a);var i=t.memoizedState;if(n=i.element,l.isDehydrated){if(l={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=l,t.memoizedState=l,256&t.flags){t=Pi(e,t,n,a,r=oi(Error(s(423)),t));break e}if(n!==r){t=Pi(e,t,n,a,r=oi(Error(s(424)),t));break e}for(ns=cr(t.stateNode.containerInfo.firstChild),as=t,rs=!0,ss=null,a=js(t,null,n,a),t.child=a;a;)a.flags=-3&a.flags|4096,a=a.sibling}else{if(fs(),n===r){t=Vi(e,t,a);break e}bi(e,t,n,a)}t=t.child}return t;case 5:return Js(t),null===e&&cs(t),n=t.type,r=t.pendingProps,l=null!==e?e.memoizedProps:null,i=r.children,ar(n,r)?i=null:null!==l&&ar(n,l)&&(t.flags|=32),ki(e,t),bi(e,t,i,a),t.child;case 6:return null===e&&cs(t),null;case 13:return Oi(e,t,a);case 4:return Ks(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=vs(t,null,n,a):bi(e,t,n,a),t.child;case 11:return n=t.type,r=t.pendingProps,vi(e,t,n,r=t.elementType===n?r:ti(n,r),a);case 7:return bi(e,t,t.pendingProps,a),t.child;case 8:case 12:return bi(e,t,t.pendingProps.children,a),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,l=t.memoizedProps,i=r.value,_r(ws,n._currentValue),n._currentValue=i,null!==l)if(ln(l.value,i)){if(l.children===r.children&&!Pr.current){t=Vi(e,t,a);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var o=l.dependencies;if(null!==o){i=l.child;for(var c=o.firstContext;null!==c;){if(c.context===n){if(1===l.tag){(c=Us(-1,a&-a)).tag=2;var d=l.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}l.lanes|=a,null!==(c=l.alternate)&&(c.lanes|=a),Es(l.return,a,t),o.lanes|=a;break}c=c.next}}else if(10===l.tag)i=l.type===t.type?null:l.child;else if(18===l.tag){if(null===(i=l.return))throw Error(s(341));i.lanes|=a,null!==(o=i.alternate)&&(o.lanes|=a),Es(i,a,t),i=l.sibling}else i=l.child;if(null!==i)i.return=l;else for(i=l;null!==i;){if(i===t){i=null;break}if(null!==(l=i.sibling)){l.return=i.return,i=l;break}i=i.return}l=i}bi(e,t,r.children,a),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Ps(t,a),n=n(r=Ms(r)),t.flags|=1,bi(e,t,n,a),t.child;case 14:return r=ti(n=t.type,t.pendingProps),ji(e,t,n,r=ti(n.type,r),a);case 15:return wi(e,t,t.type,t.pendingProps,a);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:ti(n,r),Wi(e,t),t.tag=1,Ar(n)?(e=!0,Or(t)):e=!1,Ps(t,a),si(t,n,r),ii(t,n,r,a),Ci(null,t,n,!0,e,a);case 19:return Gi(e,t,a);case 22:return Ni(e,t,a)}throw Error(s(156,t.tag))};var Qc="function"===typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,a,n,r){var s=a._reactRootContainer;if(s){var l=s;if("function"===typeof r){var i=r;r=function(){var e=Bc(l);i.call(e)}}Vc(t,l,e,r)}else l=function(e,t,a,n,r){if(r){if("function"===typeof n){var s=n;n=function(){var e=Bc(l);s.call(e)}}var l=Wc(t,n,e,0,null,!1,0,"",Xc);return e._reactRootContainer=l,e[pr]=l.current,Wn(8===e.nodeType?e.parentNode:e),dc(),l}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof n){var i=n;n=function(){var e=Bc(o);i.call(e)}}var o=Ic(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=o,e[pr]=o.current,Wn(8===e.nodeType?e.parentNode:e),dc(function(){Vc(t,o,a,n)}),o}(a,t,e,r,n);return Bc(l)}Kc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Vc(e,t,null,null)},Kc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Vc(null,e,null,null)}),t[pr]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Dt.length&&0!==t&&t<Dt[a].priority;a++);Dt.splice(a,0,e),0===a&&Lt(e)}},jt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var a=ut(t.pendingLanes);0!==a&&(yt(t,1|a),nc(t,Je()),0===(6&Eo)&&(Wo=Je()+500,Wr()))}break;case 13:dc(function(){var t=Rs(e,1);if(null!==t){var a=ec();ac(t,e,1,a)}}),Hc(e,1)}},wt=function(e){if(13===e.tag){var t=Rs(e,134217728);if(null!==t)ac(t,e,134217728,ec());Hc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),a=Rs(e,t);if(null!==a)ac(a,e,t,ec());Hc(e,t)}},kt=function(){return bt},St=function(e,t){var a=bt;try{return bt=e,t()}finally{bt=a}},we=function(e,t,a){switch(t){case"input":if(X(e,a),t=a.name,"radio"===a.type&&null!=t){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<a.length;t++){var n=a[t];if(n!==e&&n.form===e.form){var r=jr(n);if(!r)throw Error(s(90));Q(n),X(n,r)}}}break;case"textarea":se(e,a);break;case"select":null!=(t=a.value)&&ae(e,!!a.multiple,t,!1)}},Ee=cc,Pe=dc;var ed={usingClientEntryPoint:!1,Events:[br,vr,jr,_e,Ce,cc]},td={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ad={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{rt=nd.inject(ad),st=nd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(s(200));return function(e,t,a){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:a}}(e,t,null,a)},t.createRoot=function(e,t){if(!Yc(e))throw Error(s(299));var a=!1,n="",r=Qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(a=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Ic(e,1,!1,null,0,a,0,n,r),e[pr]=t.current,Wn(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,a){if(!Jc(t))throw Error(s(200));return Zc(null,e,t,!0,a)},t.hydrateRoot=function(e,t,a){if(!Yc(e))throw Error(s(405));var n=null!=a&&a.hydratedSources||null,r=!1,l="",i=Qc;if(null!==a&&void 0!==a&&(!0===a.unstable_strictMode&&(r=!0),void 0!==a.identifierPrefix&&(l=a.identifierPrefix),void 0!==a.onRecoverableError&&(i=a.onRecoverableError)),t=Wc(t,null,e,1,null!=a?a:null,r,0,l,i),e[pr]=t.current,Wn(e),n)for(e=0;e<n.length;e++)r=(r=(a=n[e])._getVersion)(a._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[a,r]:t.mutableSourceEagerHydrationData.push(a,r);return new Kc(t)},t.render=function(e,t,a){if(!Jc(t))throw Error(s(200));return Zc(null,e,t,!1,a)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[pr]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,a,n){if(!Jc(a))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,a,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,a)=>{e.exports=a(234)},950:(e,t,a)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=a(730)}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,a),s.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;a.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var s=Object.create(null);a.r(s);var l={};e=e||[null,t({}),t([]),t(t)];for(var i=2&r&&n;("object"==typeof i||"function"==typeof i)&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach(e=>l[e]=()=>n[e]);return l.default=()=>n,a.d(s,l),s}})(),a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n,r=a(43),s=a.t(r,2),l=a(391),i=a(950),o=a.t(i,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(n||(n={}));const d="popstate";function u(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function m(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(a){}}}function f(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,a,n){return void 0===a&&(a=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?x(t):t,{state:a,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function g(e){let{pathname:t="/",search:a="",hash:n=""}=e;return a&&"?"!==a&&(t+="?"===a.charAt(0)?a:"?"+a),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function x(e){let t={};if(e){let a=e.indexOf("#");a>=0&&(t.hash=e.substr(a),e=e.substr(0,a));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function h(e,t,a,r){void 0===r&&(r={});let{window:s=document.defaultView,v5Compat:l=!1}=r,i=s.history,o=n.Pop,m=null,x=h();function h(){return(i.state||{idx:null}).idx}function y(){o=n.Pop;let e=h(),t=null==e?null:e-x;x=e,m&&m({action:o,location:v.location,delta:t})}function b(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,a="string"===typeof e?e:g(e);return a=a.replace(/ $/,"%20"),u(t,"No window.location.(origin|href) available to create URL for href: "+a),new URL(a,t)}null==x&&(x=0,i.replaceState(c({},i.state,{idx:x}),""));let v={get action(){return o},get location(){return e(s,i)},listen(e){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(d,y),m=e,()=>{s.removeEventListener(d,y),m=null}},createHref:e=>t(s,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=n.Push;let r=p(v.location,e,t);a&&a(r,e),x=h()+1;let c=f(r,x),d=v.createHref(r);try{i.pushState(c,"",d)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;s.location.assign(d)}l&&m&&m({action:o,location:v.location,delta:1})},replace:function(e,t){o=n.Replace;let r=p(v.location,e,t);a&&a(r,e),x=h();let s=f(r,x),c=v.createHref(r);i.replaceState(s,"",c),l&&m&&m({action:o,location:v.location,delta:0})},go:e=>i.go(e)};return v}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,a){return void 0===a&&(a="/"),v(e,t,a,!1)}function v(e,t,a,n){let r=R(("string"===typeof t?x(t):t).pathname||"/",a);if(null==r)return null;let s=j(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let a=e.length===t.length&&e.slice(0,-1).every((e,a)=>e===t[a]);return a?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let l=null;for(let i=0;null==l&&i<s.length;++i){let e=D(r);l=T(s[i],e,n)}return l}function j(e,t,a,n){void 0===t&&(t=[]),void 0===a&&(a=[]),void 0===n&&(n="");let r=(e,r,s)=>{let l={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};l.relativePath.startsWith("/")&&(u(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),l.relativePath=l.relativePath.slice(n.length));let i=z([n,l.relativePath]),o=a.concat(l);e.children&&e.children.length>0&&(u(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+i+'".'),j(e.children,t,o,i)),(null!=e.path||e.index)&&t.push({path:i,score:M(i,e.index),routesMeta:o})};return e.forEach((e,t)=>{var a;if(""!==e.path&&null!=(a=e.path)&&a.includes("?"))for(let n of w(e.path))r(e,t,n);else r(e,t)}),t}function w(e){let t=e.split("/");if(0===t.length)return[];let[a,...n]=t,r=a.endsWith("?"),s=a.replace(/\?$/,"");if(0===n.length)return r?[s,""]:[s];let l=w(n.join("/")),i=[];return i.push(...l.map(e=>""===e?s:[s,e].join("/"))),r&&i.push(...l),i.map(t=>e.startsWith("/")&&""===t?"/":t)}const N=/^:[\w-]+$/,k=3,S=2,_=1,C=10,E=-2,P=e=>"*"===e;function M(e,t){let a=e.split("/"),n=a.length;return a.some(P)&&(n+=E),t&&(n+=S),a.filter(e=>!P(e)).reduce((e,t)=>e+(N.test(t)?k:""===t?_:C),n)}function T(e,t,a){void 0===a&&(a=!1);let{routesMeta:n}=e,r={},s="/",l=[];for(let i=0;i<n.length;++i){let e=n[i],o=i===n.length-1,c="/"===s?t:t.slice(s.length)||"/",d=A({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},c),u=e.route;if(!d&&o&&a&&!n[n.length-1].route.index&&(d=A({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(r,d.params),l.push({params:r,pathname:z([s,d.pathname]),pathnameBase:I(z([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=z([s,d.pathnameBase]))}return l}function A(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[a,n]=function(e,t,a){void 0===t&&(t=!1);void 0===a&&(a=!0);m("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,a)=>(n.push({paramName:t,isOptional:null!=a}),a?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(n.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,t?void 0:"i");return[s,n]}(e.path,e.caseSensitive,e.end),r=t.match(a);if(!r)return null;let s=r[0],l=s.replace(/(.)\/+$/,"$1"),i=r.slice(1);return{params:n.reduce((e,t,a)=>{let{paramName:n,isOptional:r}=t;if("*"===n){let e=i[a]||"";l=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const o=i[a];return e[n]=r&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:l,pattern:e}}function D(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return m(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function R(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,n=e.charAt(a);return n&&"/"!==n?null:e.slice(a)||"/"}function F(e,t,a,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+a+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function O(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function L(e,t){let a=O(e);return t?a.map((e,t)=>t===a.length-1?e.pathname:e.pathnameBase):a.map(e=>e.pathnameBase)}function U(e,t,a,n){let r;void 0===n&&(n=!1),"string"===typeof e?r=x(e):(r=c({},e),u(!r.pathname||!r.pathname.includes("?"),F("?","pathname","search",r)),u(!r.pathname||!r.pathname.includes("#"),F("#","pathname","hash",r)),u(!r.search||!r.search.includes("#"),F("#","search","hash",r)));let s,l=""===e||""===r.pathname,i=l?"/":r.pathname;if(null==i)s=a;else{let e=t.length-1;if(!n&&i.startsWith("..")){let t=i.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let o=function(e,t){void 0===t&&(t="/");let{pathname:a,search:n="",hash:r=""}="string"===typeof e?x(e):e,s=a?a.startsWith("/")?a:function(e,t){let a=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?a.length>1&&a.pop():"."!==e&&a.push(e)}),a.length>1?a.join("/"):"/"}(a,t):t;return{pathname:s,search:G(n),hash:W(r)}}(r,s),d=i&&"/"!==i&&i.endsWith("/"),m=(l||"."===i)&&a.endsWith("/");return o.pathname.endsWith("/")||!d&&!m||(o.pathname+="/"),o}const z=e=>e.join("/").replace(/\/\/+/g,"/"),I=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),G=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",W=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function V(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const B=["post","put","patch","delete"],q=(new Set(B),["get",...B]);new Set(q),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},H.apply(this,arguments)}const Q=r.createContext(null);const $=r.createContext(null);const K=r.createContext(null);const Y=r.createContext(null);const J=r.createContext({outlet:null,matches:[],isDataRoute:!1});const X=r.createContext(null);function Z(){return null!=r.useContext(Y)}function ee(){return Z()||u(!1),r.useContext(Y).location}function te(e){r.useContext(K).static||r.useLayoutEffect(e)}function ae(){let{isDataRoute:e}=r.useContext(J);return e?function(){let{router:e}=me(de.UseNavigateStable),t=pe(ue.UseNavigateStable),a=r.useRef(!1);return te(()=>{a.current=!0}),r.useCallback(function(n,r){void 0===r&&(r={}),a.current&&("number"===typeof n?e.navigate(n):e.navigate(n,H({fromRouteId:t},r)))},[e,t])}():function(){Z()||u(!1);let e=r.useContext(Q),{basename:t,future:a,navigator:n}=r.useContext(K),{matches:s}=r.useContext(J),{pathname:l}=ee(),i=JSON.stringify(L(s,a.v7_relativeSplatPath)),o=r.useRef(!1);return te(()=>{o.current=!0}),r.useCallback(function(a,r){if(void 0===r&&(r={}),!o.current)return;if("number"===typeof a)return void n.go(a);let s=U(a,JSON.parse(i),l,"path"===r.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:z([t,s.pathname])),(r.replace?n.replace:n.push)(s,r.state,r)},[t,n,i,l,e])}()}function ne(e,t){let{relative:a}=void 0===t?{}:t,{future:n}=r.useContext(K),{matches:s}=r.useContext(J),{pathname:l}=ee(),i=JSON.stringify(L(s,n.v7_relativeSplatPath));return r.useMemo(()=>U(e,JSON.parse(i),l,"path"===a),[e,i,l,a])}function re(e,t,a,s){Z()||u(!1);let{navigator:l}=r.useContext(K),{matches:i}=r.useContext(J),o=i[i.length-1],c=o?o.params:{},d=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let m,f=ee();if(t){var p;let e="string"===typeof t?x(t):t;"/"===d||(null==(p=e.pathname)?void 0:p.startsWith(d))||u(!1),m=e}else m=f;let g=m.pathname||"/",h=g;if("/"!==d){let e=d.replace(/^\//,"").split("/");h="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=b(e,{pathname:h});let v=ce(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:z([d,l.encodeLocation?l.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:z([d,l.encodeLocation?l.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),i,a,s);return t&&v?r.createElement(Y.Provider,{value:{location:H({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:n.Pop}},v):v}function se(){let e=function(){var e;let t=r.useContext(X),a=fe(ue.UseRouteError),n=pe(ue.UseRouteError);if(void 0!==t)return t;return null==(e=a.errors)?void 0:e[n]}(),t=V(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),a?r.createElement("pre",{style:s},a):null,null)}const le=r.createElement(se,null);class ie extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(J.Provider,{value:this.props.routeContext},r.createElement(X.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function oe(e){let{routeContext:t,match:a,children:n}=e,s=r.useContext(Q);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),r.createElement(J.Provider,{value:t},n)}function ce(e,t,a,n){var s;if(void 0===t&&(t=[]),void 0===a&&(a=null),void 0===n&&(n=null),null==e){var l;if(!a)return null;if(a.errors)e=a.matches;else{if(!(null!=(l=n)&&l.v7_partialHydration&&0===t.length&&!a.initialized&&a.matches.length>0))return null;e=a.matches}}let i=e,o=null==(s=a)?void 0:s.errors;if(null!=o){let e=i.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||u(!1),i=i.slice(0,Math.min(i.length,e+1))}let c=!1,d=-1;if(a&&n&&n.v7_partialHydration)for(let r=0;r<i.length;r++){let e=i[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=r),e.route.id){let{loaderData:t,errors:n}=a,r=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||r){c=!0,i=d>=0?i.slice(0,d+1):[i[0]];break}}}return i.reduceRight((e,n,s)=>{let l,u=!1,m=null,f=null;var p;a&&(l=o&&n.route.id?o[n.route.id]:void 0,m=n.route.errorElement||le,c&&(d<0&&0===s?(p="route-fallback",!1||ge[p]||(ge[p]=!0),u=!0,f=null):d===s&&(u=!0,f=n.route.hydrateFallbackElement||null)));let g=t.concat(i.slice(0,s+1)),x=()=>{let t;return t=l?m:u?f:n.route.Component?r.createElement(n.route.Component,null):n.route.element?n.route.element:e,r.createElement(oe,{match:n,routeContext:{outlet:e,matches:g,isDataRoute:null!=a},children:t})};return a&&(n.route.ErrorBoundary||n.route.errorElement||0===s)?r.createElement(ie,{location:a.location,revalidation:a.revalidation,component:m,error:l,children:x(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):x()},null)}var de=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(de||{}),ue=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ue||{});function me(e){let t=r.useContext(Q);return t||u(!1),t}function fe(e){let t=r.useContext($);return t||u(!1),t}function pe(e){let t=function(){let e=r.useContext(J);return e||u(!1),e}(),a=t.matches[t.matches.length-1];return a.route.id||u(!1),a.route.id}const ge={};function xe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}s.startTransition;function he(e){let{to:t,replace:a,state:n,relative:s}=e;Z()||u(!1);let{future:l,static:i}=r.useContext(K),{matches:o}=r.useContext(J),{pathname:c}=ee(),d=ae(),m=U(t,L(o,l.v7_relativeSplatPath),c,"path"===s),f=JSON.stringify(m);return r.useEffect(()=>d(JSON.parse(f),{replace:a,state:n,relative:s}),[d,f,s,a,n]),null}function ye(e){u(!1)}function be(e){let{basename:t="/",children:a=null,location:s,navigationType:l=n.Pop,navigator:i,static:o=!1,future:c}=e;Z()&&u(!1);let d=t.replace(/^\/*/,"/"),m=r.useMemo(()=>({basename:d,navigator:i,static:o,future:H({v7_relativeSplatPath:!1},c)}),[d,c,i,o]);"string"===typeof s&&(s=x(s));let{pathname:f="/",search:p="",hash:g="",state:h=null,key:y="default"}=s,b=r.useMemo(()=>{let e=R(f,d);return null==e?null:{location:{pathname:e,search:p,hash:g,state:h,key:y},navigationType:l}},[d,f,p,g,h,y,l]);return null==b?null:r.createElement(K.Provider,{value:m},r.createElement(Y.Provider,{children:a,value:b}))}function ve(e){let{children:t,location:a}=e;return re(je(t),a)}new Promise(()=>{});r.Component;function je(e,t){void 0===t&&(t=[]);let a=[];return r.Children.forEach(e,(e,n)=>{if(!r.isValidElement(e))return;let s=[...t,n];if(e.type===r.Fragment)return void a.push.apply(a,je(e.props.children,s));e.type!==ye&&u(!1),e.props.index&&e.props.children&&u(!1);let l={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(l.children=je(e.props.children,s)),a.push(l)}),a}function we(){return we=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},we.apply(this,arguments)}function Ne(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Mt){}new Map;const Se=s.startTransition;o.flushSync,s.useId;function _e(e){let{basename:t,children:a,future:n,window:s}=e,l=r.useRef();var i;null==l.current&&(l.current=(void 0===(i={window:s,v5Compat:!0})&&(i={}),h(function(e,t){let{pathname:a,search:n,hash:r}=e.location;return p("",{pathname:a,search:n,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:g(t)},null,i)));let o=l.current,[c,d]=r.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},m=r.useCallback(e=>{u&&Se?Se(()=>d(e)):d(e)},[d,u]);return r.useLayoutEffect(()=>o.listen(m),[o,m]),r.useEffect(()=>xe(n),[n]),r.createElement(be,{basename:t,children:a,location:c.location,navigationType:c.action,navigator:o,future:n})}const Ce="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ee=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pe=r.forwardRef(function(e,t){let a,{onClick:n,relative:s,reloadDocument:l,replace:i,state:o,target:c,to:d,preventScrollReset:m,viewTransition:f}=e,p=Ne(e,ke),{basename:x}=r.useContext(K),h=!1;if("string"===typeof d&&Ee.test(d)&&(a=d,Ce))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),a=R(t.pathname,x);t.origin===e.origin&&null!=a?d=a+t.search+t.hash:h=!0}catch(Mt){}let y=function(e,t){let{relative:a}=void 0===t?{}:t;Z()||u(!1);let{basename:n,navigator:s}=r.useContext(K),{hash:l,pathname:i,search:o}=ne(e,{relative:a}),c=i;return"/"!==n&&(c="/"===i?n:z([n,i])),s.createHref({pathname:c,search:o,hash:l})}(d,{relative:s}),b=function(e,t){let{target:a,replace:n,state:s,preventScrollReset:l,relative:i,viewTransition:o}=void 0===t?{}:t,c=ae(),d=ee(),u=ne(e,{relative:i});return r.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,a)){t.preventDefault();let a=void 0!==n?n:g(d)===g(u);c(e,{replace:a,state:s,preventScrollReset:l,relative:i,viewTransition:o})}},[d,c,u,n,s,a,e,l,i,o])}(d,{replace:i,state:o,target:c,preventScrollReset:m,relative:s,viewTransition:f});return r.createElement("a",we({},p,{href:a||y,onClick:h||l?n:function(e){n&&n(e),e.defaultPrevented||b(e)},ref:t,target:c}))});var Me,Te;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Me||(Me={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Te||(Te={}));function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function De(e){var t=function(e,t){if("object"!=Ae(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=Ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ae(t)?t:t+""}function Re(e,t,a){return(t=De(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(a),!0).forEach(function(t){Re(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fe(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}const Le=window.location.origin;var Ue=a(579);const ze=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=e.includes("localhost:8000")?e.replace("https://localhost:8000","http://localhost:8000"):e;console.log("\ud83d\udd04 Making request to:",a);let n=null;try{n=await(async()=>{var e;const t=null===(e=document.cookie.split("; ").find(e=>e.startsWith("csrftoken=")))||void 0===e?void 0:e.split("=")[1];if(t)return t;try{var a;const e=await fetch("".concat(Le,"/api/auth/csrf/"),{method:"GET",credentials:"include"});return e.ok?(await e.json()).csrfToken:null===(a=document.cookie.split("; ").find(e=>e.startsWith("csrftoken=")))||void 0===a?void 0:a.split("=")[1]}catch(n){return console.log("Could not fetch CSRF token:",n),null}})(),console.log("\ud83d\udd11 CSRF token:",n?"obtained":"not available")}catch(s){console.log("\u26a0\ufe0f CSRF token fetch failed:",s.message)}const r=Oe({},t.headers);t.body instanceof FormData||(r["Content-Type"]="application/json"),n&&(r["X-CSRFToken"]=n);try{const e=await fetch(a,Oe(Oe({credentials:"include"},t),{},{headers:r}));return console.log("\u2705 Request completed:",a,"Status:",e.status),e}catch(s){throw console.error("\u274c Request failed:",a,"Error:",s.message),s}},Ie=(0,r.createContext)(),Ge=()=>{const e=(0,r.useContext)(Ie);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},We=e=>{let{children:t}=e;const[a,n]=(0,r.useState)(null),[s,l]=(0,r.useState)(!0),[i,o]=(0,r.useState)([]),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)([]),[f,p]=(0,r.useState)(null),g=ae();(0,r.useEffect)(()=>{x()},[]);const x=async()=>{try{const e=await fetch("".concat(Le,"/api/auth/user/"),{credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){const t=await e.json();n(t.user),console.log("\u2705 User authenticated:",t.user),await h()}else console.log("\u274c User not authenticated"),n(null),o([]),d(null)}catch(e){console.error("Auth check failed:",e),n(null)}finally{l(!1)}},h=async()=>{try{const e=await fetch("".concat(Le,"/api/companies/"),{credentials:"include"});if(e.ok){const t=await e.json(),a=t.results||t;o(a),console.log("\ud83c\udfe2 User companies fetched:",a);const n=localStorage.getItem("selectedCompanyId");if(console.log("\ud83d\udd0d Saved company ID from storage:",n),console.log("\ud83d\udd0d Available companies for user:",a.map(e=>({id:e.id,name:e.name}))),n){const e=a.find(e=>e.id===parseInt(n));e?(d(e),console.log("\ud83c\udfe2 Restored company from storage:",e)):(console.log("\u26a0\ufe0f Saved company not found in user companies, clearing localStorage"),localStorage.removeItem("selectedCompanyId"),a.length>0&&(d(a[0]),console.log("\ud83c\udfe2 Auto-selected first company:",a[0])))}else a.length>0&&(d(a[0]),console.log("\ud83c\udfe2 Auto-selected first company:",a[0]))}}catch(e){console.error("Failed to fetch companies:",e)}},y=async()=>{try{const e=await fetch("".concat(Le,"/api/user/sites/"),{credentials:"include"});if(e.ok){const t=await e.json();m(t),console.log("\ud83c\udfe2 User sites fetched:",t);const a=localStorage.getItem("selectedSiteId");if(a){const e=t.find(e=>e.id===parseInt(a));e?p(e):t.length>0&&p(t[0])}else t.length>0&&p(t[0])}}catch(e){console.error("Failed to fetch user sites:",e)}},b=async()=>{try{if(!i||0===i.length)return console.log("\ud83d\udd04 No companies found, redirecting to onboarding"),void g("/onboard");const e=c||i[0];if(!e)return console.log("\ud83d\udd04 No company selected, redirecting to onboarding"),void g("/onboard");console.log("\ud83d\udd0d Checking onboarding status for company:",e.name);const t=await ze("".concat(Le,"/api/companies/").concat(e.id,"/frameworks/"));let a=!1;if(t.ok){a=(await t.json()).length>0}const n=await ze("".concat(Le,"/api/companies/").concat(e.id,"/profile_answers/"));let r=!1;if(n.ok){r=(await n.json()).length>0}const s=await ze("".concat(Le,"/api/checklist/?company_id=").concat(e.id));let l=!1;if(s.ok){const e=await s.json();l=e.results&&e.results.length>0}console.log("\ud83d\udcca Onboarding status:",{company:e.name,hasFrameworks:a,hasProfileAnswers:r,hasChecklist:l}),a?r?l?(console.log("\u2705 Onboarding complete, redirecting to dashboard"),g("/dashboard")):(console.log("\ud83d\udd04 Checklist not generated, redirecting to profiling"),g("/list")):(console.log("\ud83d\udd04 Profiling not completed, redirecting to framework selection"),g("/rame")):(console.log("\ud83d\udd04 No frameworks selected, redirecting to onboarding"),g("/onboard"))}catch(e){console.error("\u274c Error checking onboarding status:",e),g("/dashboard")}},v={user:a,loading:s,companies:i,selectedCompany:c,userSites:u,selectedSite:f,login:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const r={email:e,password:t};a&&(r.company_code=a);const s=await fetch("".concat(Le,"/api/auth/login/"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),l=await s.json();return s.ok?(n(l.user),console.log("\u2705 Login successful:",l.user),await h(),await y(),l.requires_password_reset||l.user.must_reset_password?(g("/reset-password"),{success:!0,requiresPasswordReset:!0,message:l.message}):(await b(),{success:!0})):(console.error("\u274c Login failed:",l.error),{success:!1,error:l.error||"Login failed"})}catch(r){return console.error("Login error:",r),{success:!1,error:"Network error"}}},signup:async(e,t,a,r)=>{try{const s=await fetch("".concat(Le,"/api/auth/signup/"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,companyName:a,password:r})}),l=await s.json();return s.ok?(n(l.user),l.user.company&&(d(l.user.company),o([l.user.company])),console.log("\u2705 Signup successful:",l.user),g("/onboard"),{success:!0}):(console.error("\u274c Signup failed:",l.error),{success:!1,error:l.error||"Signup failed"})}catch(s){return console.error("Signup error:",s),{success:!1,error:"Network error"}}},logout:async()=>{try{await fetch("".concat(Le,"/api/auth/logout/"),{method:"POST",credentials:"include"}),console.log("\u2705 Logout successful")}catch(e){console.error("Logout error:",e)}finally{n(null),o([]),d(null),m([]),p(null),localStorage.removeItem("selectedCompanyId"),localStorage.removeItem("selectedSiteId"),g("/login")}},resetPassword:async(e,t)=>{try{const r=await ze("".concat(Le,"/api/auth/reset-password/"),{method:"POST",body:JSON.stringify({current_password:e,new_password:t})}),s=await r.json();return r.ok?(console.log("\u2705 Password reset successful"),a&&n(Oe(Oe({},a),{},{must_reset_password:!1})),{success:!0,message:s.message}):(console.error("\u274c Password reset failed:",s.error),console.error("\u274c Response status:",r.status),console.error("\u274c Full response:",s),{success:!1,error:s.error||"Password reset failed"})}catch(r){return console.error("Password reset error:",r),{success:!1,error:"Network error"}}},checkAuthStatus:x,switchCompany:e=>{d(e),localStorage.setItem("selectedCompanyId",e.id),console.log("\ud83c\udfe2 Switched to company:",e)},switchSite:e=>{p(e),localStorage.setItem("selectedSiteId",e.id),console.log("\ud83c\udfe2 Switched to site:",e)},fetchUserCompanies:h,fetchUserSites:y,hasPermission:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";if(!a)return!1;const n={super_user:{all:!0},admin:{companyOnboarding:["read","create","update"],frameworkSelection:["read","create","update"],dataChecklist:["read","create","update","assign"],meterManagement:["read","create","update","delete"],dataCollection:["read","create","update","approve"],dashboard:["read"],reports:["read","export"],userManagement:["read","create","update","delete"]},site_manager:{companyOnboarding:["read"],frameworkSelection:["read"],dataChecklist:["read","assign"],meterManagement:["read","create","update","delete"],dataCollection:["read","create","update","review"],dashboard:["read"],reports:["read","export"],userManagement:["read","create","update","delete"]},uploader:{dataCollection:["read","create","update"],dashboard:["read"],reports:["read"]},viewer:{companyOnboarding:["read"],frameworkSelection:["read"],dataChecklist:["read"],meterManagement:["read"],dataCollection:["read"],dashboard:["read"],reports:["read","export"]},meter_manager:{meterManagement:["read","create","update","delete"],dataCollection:["read"],dashboard:["read"],reports:["read"]}}[a.role];return!!n&&(!!n.all||!!n[e]&&n[e].includes(t))}};return(0,Ue.jsx)(Ie.Provider,{value:v,children:t})},Ve=e=>{let{children:t}=e;const{user:a,loading:n}=Ge(),r=ee();return n?(0,Ue.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"bg-white rounded-lg p-8 shadow-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Loading ESG Portal"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Checking authentication..."})]})]})})}):a?t:(0,Ue.jsx)(he,{to:"/login",state:{from:r},replace:!0})},Be=()=>{const[e,t]=(0,r.useState)({email:"",password:"",companyCode:""}),[a,n]=(0,r.useState)(!1),[s,l]=(0,r.useState)(""),{login:i}=Ge(),o=a=>{t(Oe(Oe({},e),{},{[a.target.name]:a.target.value}))};return(0,Ue.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,Ue.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"mx-auto h-20 w-20 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-leaf text-white text-2xl"})}),(0,Ue.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to ESG Portal"}),(0,Ue.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",(0,Ue.jsx)(Pe,{to:"/signup",className:"font-medium text-purple-600 hover:text-purple-500",children:"create a new account"})]})]}),(0,Ue.jsxs)("form",{className:"mt-8 space-y-6 bg-white p-8 rounded-xl shadow-lg",onSubmit:async t=>{t.preventDefault(),n(!0),l("");const a=await i(e.email,e.password,e.companyCode);a.success||l(a.error),n(!1)},children:[s&&(0,Ue.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:(0,Ue.jsxs)("div",{className:"flex",children:[(0,Ue.jsx)("i",{className:"fas fa-exclamation-circle mt-1 mr-3 text-red-500"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("strong",{className:"font-medium",children:"Authentication Error"}),(0,Ue.jsx)("p",{className:"text-sm",children:s})]})]})}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"email",name:"email",type:"email",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter your email",value:e.email,onChange:o}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,Ue.jsx)("i",{className:"fas fa-envelope text-gray-400"})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"companyCode",className:"block text-sm font-medium text-gray-700",children:["Company Code ",(0,Ue.jsx)("span",{className:"text-gray-500 text-xs",children:"(Optional)"})]}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"companyCode",name:"companyCode",type:"text",className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter company code (if provided)",value:e.companyCode,onChange:o}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,Ue.jsx)("i",{className:"fas fa-building text-gray-400"})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter your password",value:e.password,onChange:o}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]})]}),(0,Ue.jsx)("div",{children:(0,Ue.jsx)("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:a?(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Signing in..."]}):(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-sign-in-alt mr-2"}),"Sign in"]})})}),(0,Ue.jsx)("div",{className:"text-center",children:(0,Ue.jsx)(Pe,{to:"/forgot-password",className:"text-sm text-purple-600 hover:text-purple-500",children:"Forgot your password?"})})]})]})})},qe=()=>{const[e,t]=(0,r.useState)({username:"",email:"",companyName:"",password:"",confirmPassword:""}),[a,n]=(0,r.useState)(!1),[s,l]=(0,r.useState)(""),{signup:i}=Ge(),o=a=>{t(Oe(Oe({},e),{},{[a.target.name]:a.target.value}))};return(0,Ue.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,Ue.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"mx-auto h-20 w-20 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-leaf text-white text-2xl"})}),(0,Ue.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"}),(0,Ue.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Already have an account?"," ",(0,Ue.jsx)(Pe,{to:"/login",className:"font-medium text-purple-600 hover:text-purple-500",children:"Sign in here"})]})]}),(0,Ue.jsxs)("form",{className:"mt-8 space-y-6 bg-white p-8 rounded-xl shadow-lg",onSubmit:async t=>{if(t.preventDefault(),n(!0),l(""),!(e.email&&e.email.trim()?e.companyName&&e.companyName.trim()?e.password!==e.confirmPassword?(l("Passwords do not match"),0):e.password.length<6?(l("Password must be at least 6 characters long"),0):!(e.username.length<3)||(l("Username must be at least 3 characters long"),0):(l("Company name is required"),0):(l("Email address is required"),0)))return void n(!1);const a=await i(e.username,e.email,e.companyName,e.password);a.success||l(a.error),n(!1)},children:[s&&(0,Ue.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:(0,Ue.jsxs)("div",{className:"flex",children:[(0,Ue.jsx)("i",{className:"fas fa-exclamation-circle mt-1 mr-3 text-red-500"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("strong",{className:"font-medium",children:"Signup Error"}),(0,Ue.jsx)("p",{className:"text-sm",children:s})]})]})}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"username",name:"username",type:"text",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Choose a username",value:e.username,onChange:o}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,Ue.jsx)("i",{className:"fas fa-user text-gray-400"})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"email",name:"email",type:"email",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter your email address",value:e.email,onChange:o}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,Ue.jsx)("i",{className:"fas fa-envelope text-gray-400"})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"companyName",className:"block text-sm font-medium text-gray-700",children:"Company Name"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"companyName",name:"companyName",type:"text",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter your company name",value:e.companyName,onChange:o}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,Ue.jsx)("i",{className:"fas fa-building text-gray-400"})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Choose a password (min 6 characters)",value:e.password,onChange:o}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Confirm your password",value:e.confirmPassword,onChange:o}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]})]}),(0,Ue.jsx)("div",{children:(0,Ue.jsx)("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:a?(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Creating account..."]}):(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-user-plus mr-2"}),"Create account"]})})}),(0,Ue.jsxs)("div",{className:"text-center text-xs text-gray-600",children:["By creating an account, you agree to our"," ",(0,Ue.jsx)(Pe,{to:"/terms",className:"text-purple-600 hover:text-purple-500",children:"Terms of Service"})," ","and"," ",(0,Ue.jsx)(Pe,{to:"/privacy",className:"text-purple-600 hover:text-purple-500",children:"Privacy Policy"})]})]})]})})},He=e=>{let{currentRole:t}=e;const[a,n]=(0,r.useState)(!1),[s,l]=(0,r.useState)(!1),[o,c]=(0,r.useState)({top:0,left:0}),{user:d,checkAuthStatus:u}=Ge(),m=(0,r.useRef)(null),f=(0,r.useRef)(null),p=(0,r.useRef)(null);(0,r.useEffect)(()=>{const e=e=>{const t=m.current&&!m.current.contains(e.target),a=p.current&&!p.current.contains(e.target);t&&a&&n(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const g=[{value:"super_user",label:"Super User",color:"bg-red-100 text-red-700"},{value:"admin",label:"Admin",color:"bg-blue-100 text-blue-700"},{value:"site_manager",label:"Site Manager",color:"bg-green-100 text-green-700"},{value:"uploader",label:"Uploader",color:"bg-yellow-100 text-yellow-700"},{value:"viewer",label:"Viewer",color:"bg-purple-100 text-purple-700"},{value:"meter_manager",label:"Meter Manager",color:"bg-orange-100 text-orange-700"}],x=g.find(e=>e.value===t);return(0,Ue.jsxs)("div",{className:"relative",ref:m,children:[(0,Ue.jsxs)("button",{ref:f,onClick:()=>{if(!a&&f.current){const e=f.current.getBoundingClientRect();c({top:e.bottom+4,left:e.left})}n(!a)},disabled:s,className:"text-xs px-2 py-0.5 rounded-full capitalize transition-all duration-200 flex items-center space-x-1 ".concat(s?"bg-gray-100 text-gray-500 cursor-wait":(null===x||void 0===x?void 0:x.color)||"bg-purple-100 text-purple-700"," hover:shadow-sm"),children:[(0,Ue.jsx)("span",{className:"text-xs",children:s?"Switching...":(null===x||void 0===x?void 0:x.label)||(null===t||void 0===t?void 0:t.replace("_"," "))}),(0,Ue.jsx)("i",{className:"fas fa-chevron-".concat(a?"up":"down"," text-xs")})]}),a&&(0,i.createPortal)((0,Ue.jsx)("div",{ref:p,className:"fixed bg-white border border-gray-200 rounded-lg shadow-xl z-[999999] min-w-[160px]",style:{top:"".concat(o.top,"px"),left:"".concat(o.left,"px"),boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},children:(0,Ue.jsxs)("div",{className:"py-1",children:[(0,Ue.jsx)("div",{className:"px-3 py-2 text-xs font-medium text-gray-500 border-b border-gray-100",children:"Test Role Switch"}),g.map(e=>(0,Ue.jsxs)("button",{onClick:()=>(async e=>{if(e!==t){l(!0);try{(await ze("".concat(Le,"/api/auth/switch-role/"),{method:"POST",body:JSON.stringify({role:e})})).ok?(await u(),console.log("\u2705 Role switched to: ".concat(e)),window.location.reload()):(console.error("\u274c Role switch failed"),alert("Failed to switch role. This is a test feature."))}catch(a){console.error("Role switch error:",a),alert("This is a test feature - role switching would need backend implementation")}finally{l(!1),n(!1)}}else n(!1)})(e.value),disabled:s,className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50 flex items-center space-x-2 ".concat(e.value===t?"bg-blue-50":""),children:[(0,Ue.jsx)("span",{className:"px-2 py-0.5 rounded-full ".concat(e.color),children:e.label}),e.value===t&&(0,Ue.jsx)("i",{className:"fas fa-check text-blue-600 text-xs"})]},e.value))]})}),document.body)]})},Qe=()=>{var e,t,a,n;console.log("TopNavbar rendering");const r=ae(),s=ee(),{user:l,logout:i,selectedCompany:o,companies:c,switchCompany:d,userSites:u,selectedSite:m,switchSite:f,hasPermission:p}=Ge();console.log("Current location:",s.pathname);const g=(()=>{const e=[{id:1,name:"Company Onboarding",path:"/onboard",description:"Set up your company profile and business activities",progress:14,permission:"companyOnboarding"},{id:2,name:"Framework Selection",path:"/rame",description:"Choose ESG frameworks that align with your reporting requirements",progress:28,permission:"frameworkSelection"},{id:3,name:"Data Checklist",path:"/list",description:"Review personalized data requirements based on your frameworks",progress:42,permission:"dataChecklist"},{id:4,name:"Meter Management",path:"/meter",description:"Configure and monitor your data collection points",progress:56,permission:"meterManagement"},{id:5,name:"Data Collection",path:"/data",description:"Track, input, and validate your ESG performance data",progress:70,permission:"dataCollection"},{id:6,name:"Team Management",path:"/team",description:"Manage users and their access to your organization",progress:84,permission:"userManagement"},{id:7,name:"Dashboard",path:"/dashboard",description:"Comprehensive view of your sustainability performance",progress:100,permission:"dashboard"}],t=[{id:7,name:"Team Management",path:"/team",description:"Manage users and their access to the platform",progress:100,permission:"userManagement"},{id:8,name:"Site Management",path:"/sites",description:"Manage company locations and sites",progress:100,permission:"siteManagement"},{id:9,name:"Task Assignment",path:"/tasks",description:"Assign data collection tasks to team members",progress:100,permission:"taskAssignment"}];if(!l)return e;let a=e.filter(e=>p(e.permission,"read"));return"admin"===(null===l||void 0===l?void 0:l.role)||"super_user"===(null===l||void 0===l?void 0:l.role)?a=[...a,...t.filter(e=>p(e.permission,"read"))]:"site_manager"===(null===l||void 0===l?void 0:l.role)&&(a=[...a,...t.filter(e=>["userManagement","taskAssignment"].includes(e.permission)&&p(e.permission,"read"))]),a.length>0?a:e})(),x=g.find(e=>s.pathname===e.path)||g[0]||{id:1,name:"Dashboard",path:"/dashboard",description:"Main dashboard",progress:100},h=(null===x||void 0===x?void 0:x.progress)||0,y=(g.map(e=>Oe(Oe({},e),{},{completed:h>=e.progress})),[{name:"ESG Portal2",path:"/",isActive:!1},{name:x.name,path:x.path,isActive:!0}]);return(0,Ue.jsxs)("div",{className:"bg-white shadow-2xl",children:[(0,Ue.jsx)("div",{className:"h-12 px-8 bg-gradient-to-r from-purple-50 via-blue-50 to-purple-50 backdrop-blur-lg border-b border-purple-100",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between h-full",children:[(0,Ue.jsx)("nav",{className:"flex items-center space-x-2 text-sm",children:y.map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("button",{onClick:()=>!e.isActive&&r(e.path),className:"".concat(e.isActive?"text-purple-700 font-semibold":"text-gray-600 hover:text-purple-600 transition-colors"),children:e.name}),t<y.length-1&&(0,Ue.jsx)("i",{className:"fas fa-chevron-right text-gray-400 text-xs"})]},t))}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg flex items-center justify-center shadow-lg",children:(0,Ue.jsx)("i",{className:"fas fa-leaf text-white"})}),(0,Ue.jsx)("h1",{className:"text-lg font-bold bg-gradient-to-r from-purple-700 to-blue-600 bg-clip-text text-transparent",children:"ESG Portal2"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[u&&u.length>1&&(0,Ue.jsx)("div",{className:"relative",children:(0,Ue.jsxs)("select",{value:(null===m||void 0===m?void 0:m.id)||"",onChange:e=>{const t=u.find(t=>t.id===parseInt(e.target.value));t&&f(t)},className:"text-sm bg-white border border-purple-200 rounded-md px-3 py-1 text-gray-700 hover:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,Ue.jsx)("option",{value:"",children:"All Sites"}),u.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))]})}),c&&c.length>1&&(0,Ue.jsx)("div",{className:"relative",children:(0,Ue.jsx)("select",{value:(null===o||void 0===o?void 0:o.id)||"",onChange:e=>{const t=c.find(t=>t.id===parseInt(e.target.value));t&&d(t)},className:"text-sm bg-white border border-purple-200 rounded-md px-3 py-1 text-gray-700 hover:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500",children:c.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))})}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("div",{className:"w-7 h-7 rounded-full ring-2 ring-purple-200 bg-purple-500 flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-white text-xs font-medium",children:(null===l||void 0===l||null===(e=l.name)||void 0===e||null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase())||(null===l||void 0===l||null===(a=l.username)||void 0===a||null===(n=a.charAt(0))||void 0===n?void 0:n.toUpperCase())||"U"})}),(0,Ue.jsxs)("div",{className:"flex flex-col",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:(null===l||void 0===l?void 0:l.name)||(null===l||void 0===l?void 0:l.username)||"User"}),(null===l||void 0===l?void 0:l.role)&&(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("span",{className:"text-xs px-2 py-1 rounded-full font-medium ".concat((b=l.role,{super_user:"bg-red-100 text-red-700",admin:"bg-blue-100 text-blue-700",site_manager:"bg-green-100 text-green-700",uploader:"bg-yellow-100 text-yellow-700",viewer:"bg-purple-100 text-purple-700",meter_manager:"bg-orange-100 text-orange-700"}[b]||"bg-gray-100 text-gray-700")),children:l.role.replace("_"," ")}),(0,Ue.jsx)(He,{currentRole:l.role})]})]})]}),(0,Ue.jsx)("button",{onClick:i,className:"px-2 py-1.5 text-xs font-medium text-gray-600 hover:text-red-600 hover:bg-red-50 border border-gray-300 hover:border-red-300 rounded-md transition-all duration-200 flex items-center",title:"Sign Out",children:(0,Ue.jsx)("i",{className:"fas fa-sign-out-alt"})})]})]})]})}),(0,Ue.jsxs)("div",{className:"h-30 px-8 py-6 bg-gradient-to-br from-purple-600 via-purple-700 to-blue-700 text-white relative overflow-hidden",children:[(0,Ue.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/20 to-blue-600/20 backdrop-blur-sm"}),(0,Ue.jsx)("div",{className:"absolute top-0 right-0 w-96 h-96 bg-white/5 rounded-full -mr-48 -mt-48"}),(0,Ue.jsx)("div",{className:"absolute bottom-0 left-0 w-72 h-72 bg-white/5 rounded-full -ml-36 -mb-36"}),(0,Ue.jsxs)("div",{className:"relative z-10 flex items-center justify-between h-full",children:[(0,Ue.jsx)("div",{className:"flex-1 pr-8",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-white/20 backdrop-blur-lg rounded-full flex items-center justify-center border border-white/30 shadow-xl",children:(0,Ue.jsx)("span",{className:"text-xl font-bold text-white",children:x.id})}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-white mb-1",children:x.name}),(0,Ue.jsx)("p",{className:"text-purple-100 text-sm leading-relaxed mb-3",children:x.description})]})]})}),(0,Ue.jsx)("div",{className:"flex items-center space-x-8",children:(0,Ue.jsxs)("div",{className:"w-80",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Ue.jsx)("span",{className:"text-xs text-purple-200 font-medium",children:"Module Progress"}),(0,Ue.jsxs)("span",{className:"text-xs text-white font-semibold",children:[h,"%"]})]}),(0,Ue.jsx)("div",{className:"h-2 bg-white/20 rounded-full overflow-hidden backdrop-blur-sm",children:(0,Ue.jsx)("div",{className:"h-full bg-gradient-to-r from-white to-purple-200 rounded-full transition-all duration-700 ease-out shadow-sm",style:{width:"".concat(h,"%")}})})]})})]}),(0,Ue.jsx)("div",{className:"absolute bottom-0 left-0 right-0 px-8 pb-4",children:(0,Ue.jsx)("div",{className:"flex items-center justify-center space-x-3",children:[{id:1,name:"Company Info",path:"/"},{id:2,name:"Frameworks",path:"/rame"},{id:3,name:"Profiling",path:"/list"},{id:4,name:"Meters",path:"/meter"},{id:5,name:"Data Collection",path:"/data"},{id:6,name:"Team Management",path:"/team"},{id:7,name:"Dashboard",path:"/dashboard"}].map((e,t)=>{const a=s.pathname===e.path;return(0,Ue.jsxs)("button",{onClick:()=>r(e.path),className:"relative group cursor-pointer transition-all duration-300 hover:scale-150",children:[(0,Ue.jsx)("div",{className:"\n                    w-2 h-2 rounded-full transition-all duration-300\n                    ".concat(a?"bg-white":"bg-white opacity-50","\n                  ")}),(0,Ue.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-3 opacity-0 pointer-events-none group-hover:opacity-100 transition-all duration-300 z-50",children:(0,Ue.jsxs)("div",{className:"px-3 py-2 bg-gray-900/90 text-white text-xs rounded-lg whitespace-nowrap shadow-lg backdrop-blur-sm",children:[e.name,(0,Ue.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900/90"})]})})]},e.id)})})})]})]});var b},$e=()=>{console.log("\ud83d\ude80 Onboard component loaded/re-rendered at",(new Date).toLocaleTimeString());const e=ae(),{user:t,selectedCompany:a}=Ge(),[n,s]=(0,r.useState)({companyName:"",emirate:"",primarySector:"",activities:[],customActivity:""}),[l,i]=(0,r.useState)(!0),[o,c]=(0,r.useState)(!1),d=(null===a||void 0===a?void 0:a.id)||null,u=(0,r.useRef)(!0),m=(0,r.useRef)(null);console.log("\ud83d\udcca Current formData state:",n),console.log("\u23f1\ufe0f Component states - Loading:",l,"Saving:",o,"InitialLoad:",u.current),(0,r.useEffect)(()=>{if(console.log("\ud83d\udd04 useEffect for data fetching triggered"),!d)return console.log("\u23f8\ufe0f No company selected, skipping data fetch"),void i(!1);(async()=>{try{console.log("\ud83d\udce1 Fetching company data for ID:",d);const e=await ze("".concat(Le,"/api/companies/").concat(d,"/"));if(console.log("Company API Response status:",e.status),e.ok){const t=await e.json();console.log("Loaded company data from API:",t);const a=await ze("".concat(Le,"/api/companies/").concat(d,"/activities/"));let n=[];if(a.ok){const e=await a.json();console.log("Loaded activities data:",e),n=e.map(e=>e.name)}else console.log("No activities found for company or API error:",a.status);const r={dubai:"Dubai",abu_dhabi:"Abu Dhabi",sharjah:"Sharjah",ajman:"Ajman",umm_al_quwain:"Umm Al Quwain",ras_al_khaimah:"Ras Al Khaimah",fujairah:"Fujairah"},l={hospitality:"Hospitality & Tourism",real_estate:"Real Estate",financial_services:"Financial Services",manufacturing:"Manufacturing",technology:"Technology",healthcare:"Healthcare",education:"Education",retail:"Retail"},i={companyName:t.name||"",emirate:r[t.emirate]||t.emirate||"",primarySector:l[t.sector]||t.sector||"",activities:n,customActivity:""};console.log("Setting form data:",i),s(i),m.current=i}else if(404===e.status){console.log("Company not found, starting with empty form");const e={companyName:"",emirate:"",primarySector:"",activities:[],customActivity:""};s(e),m.current=e}else{console.error("API error, using empty form");const e={companyName:"",emirate:"",primarySector:"",activities:[],customActivity:""};s(e),m.current=e}}catch(e){console.error("Error fetching company data:",e);const t={companyName:"",emirate:"",primarySector:"",activities:[],customActivity:""};s(t),m.current=t}finally{i(!1),u.current=!1}})()},[d]),(0,r.useEffect)(()=>{},[n,l,o]);const f=[{id:"hotel",name:"Hotel Operations",icon:"fas fa-bed",color:"blue"},{id:"food",name:"Food & Beverage",icon:"fas fa-utensils",color:"green"},{id:"spa",name:"Spa & Wellness",icon:"fas fa-spa",color:"orange"},{id:"events",name:"Event Management",icon:"fas fa-calendar-alt",color:"purple"},{id:"retail",name:"Retail Operations",icon:"fas fa-shopping-bag",color:"red"},{id:"recreation",name:"Recreation Facilities",icon:"fas fa-swimmer",color:"teal"},{id:"conference",name:"Conference & Meeting Rooms",icon:"fas fa-users",color:"indigo"},{id:"housekeeping",name:"Housekeeping Services",icon:"fas fa-broom",color:"cyan"},{id:"laundry",name:"Laundry Services",icon:"fas fa-tshirt",color:"blue"},{id:"transport",name:"Transportation Services",icon:"fas fa-car",color:"gray"}],p=e=>{s(t=>Oe(Oe({},t),{},{activities:t.activities.includes(e)?t.activities.filter(t=>t!==e):[...t.activities,e]}))},g=async()=>{if(n.customActivity&&!n.activities.includes(n.customActivity)){s(e=>Oe(Oe({},e),{},{activities:[...e.activities,e.customActivity],customActivity:""}));try{const e=await ze("".concat(Le,"/api/activities/add_custom/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n.customActivity,company_id:d})});if(e.ok){const t=await e.json();console.log("Custom activity added:",t)}else console.error("Failed to add custom activity to backend")}catch(e){console.error("Error adding custom activity:",e)}}},x=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(console.log("\ud83d\udcbe saveData function called with showMessage:",e),console.log("\ud83d\udcbe Current saving state:",o),o)console.log("\u274c saveData aborted - already saving");else{console.log("\ud83d\udcbe saveData called, formData:",n),c(!0),console.log("\ud83d\udcbe Set saving state to true"),console.log("\ud83d\udcbe Starting to save company data:",n);try{let e=await ze("".concat(Le,"/api/companies/").concat(d,"/")),a=e.ok;const r={Dubai:"dubai","Abu Dhabi":"abu_dhabi",Sharjah:"sharjah",Ajman:"ajman","Umm Al Quwain":"umm_al_quwain","Ras Al Khaimah":"ras_al_khaimah",Fujairah:"fujairah"},s={"Hospitality & Tourism":"hospitality","Real Estate":"real_estate","Financial Services":"financial_services",Manufacturing:"manufacturing",Technology:"technology",Healthcare:"healthcare",Education:"education",Retail:"retail"},l={name:n.companyName||"Unnamed Company",emirate:r[n.emirate]||"dubai",sector:s[n.primarySector]||"hospitality"};if(console.log("Company data to send:",l),a?(console.log("Updating existing company..."),e=await ze("".concat(Le,"/api/companies/").concat(d,"/"),{method:"PUT",body:JSON.stringify(l)})):(console.log("Creating new company..."),e=await ze("".concat(Le,"/api/companies/"),{method:"POST",body:JSON.stringify(l)})),e.ok){const a=await e.json();console.log("Company data saved successfully:",a);const r=n.activities.filter(e=>!f.some(t=>t.name===e));for(const e of r)try{await ze("".concat(Le,"/api/activities/add_custom/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,company_id:d})})}catch(t){console.error('Error creating custom activity "'.concat(e,'":'),t)}const s=await ze("".concat(Le,"/api/activities/"));if(s.ok){const e=await s.json(),t=e.results||e;console.log("All available activities:",t),console.log("Selected activity names:",n.activities);const a=[];n.activities.forEach(e=>{const n=t.find(t=>t.name===e);n?(console.log('\u2713 Found "'.concat(e,'" with ID ').concat(n.id)),a.push(n.id)):console.warn('\u2717 Could not find activity "'.concat(e,'" in database'))}),console.log("Final activity IDs to save:",a);const r=await ze("".concat(Le,"/api/companies/").concat(d,"/save_activities/"),{method:"POST",body:JSON.stringify({activity_ids:a})});if(r.ok){const e=await r.json();console.log("Activities saved successfully:",e),m.current={companyName:n.companyName,emirate:n.emirate,primarySector:n.primarySector,activities:n.activities}}else{console.error("Failed to save activities");const e=await r.text();console.error("Activities save error:",e)}}}else{console.error("Failed to save company data. Status:",e.status);const t=await e.text();console.error("Error response:",t)}}catch(t){console.error("Error saving company data:",t)}finally{c(!1)}}},h=async()=>{await x(!0),e("/rame")};if(l)return(0,Ue.jsx)("div",{className:"max-w-6xl mx-auto flex items-center justify-center h-64",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("i",{className:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Loading company information..."})]})});if(!(()=>{if(console.log("\ud83d\udd0d Checking onboarding access:",{user:t,role:null===t||void 0===t?void 0:t.role,selectedCompany:a}),!t)return console.log("\u274c No user found"),!1;const e=["super_user","admin","site_manager","viewer"].includes(t.role);return console.log("\u2705 Access check result:",e,"for role:",t.role),e})())return(0,Ue.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,Ue.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access company onboarding."}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})});const y=["super_user","admin"].includes(null===t||void 0===t?void 0:t.role),b=["site_manager","viewer"].includes(null===t||void 0===t?void 0:t.role);return(0,Ue.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-building text-blue-600"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Company Information"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:y?"Enter your basic company details":"View company information"})]})]}),b&&(0,Ue.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-2"}),"View Only Mode"]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name *"}),(0,Ue.jsxs)("div",{className:"relative",children:[y?(0,Ue.jsx)("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter company name",value:n.companyName,onChange:e=>s(t=>Oe(Oe({},t),{},{companyName:e.target.value}))}):(0,Ue.jsx)("div",{className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 font-medium",children:n.companyName||"Not specified"}),n.companyName&&y&&(0,Ue.jsx)("div",{className:"absolute right-3 top-3 text-green-500",children:(0,Ue.jsx)("i",{className:"fas fa-check-circle"})}),b&&(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,Ue.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,Ue.jsx)("i",{className:"fas fa-eye"})})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emirate *"}),(0,Ue.jsxs)("div",{className:"relative",children:[y?(0,Ue.jsxs)("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:n.emirate,onChange:e=>s(t=>Oe(Oe({},t),{},{emirate:e.target.value})),children:[(0,Ue.jsx)("option",{value:"",children:"Select Emirate"}),(0,Ue.jsx)("option",{value:"Dubai",children:"Dubai"}),(0,Ue.jsx)("option",{value:"Abu Dhabi",children:"Abu Dhabi"}),(0,Ue.jsx)("option",{value:"Sharjah",children:"Sharjah"}),(0,Ue.jsx)("option",{value:"Ajman",children:"Ajman"}),(0,Ue.jsx)("option",{value:"Umm Al Quwain",children:"Umm Al Quwain"}),(0,Ue.jsx)("option",{value:"Ras Al Khaimah",children:"Ras Al Khaimah"}),(0,Ue.jsx)("option",{value:"Fujairah",children:"Fujairah"})]}):(0,Ue.jsx)("div",{className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 font-medium",children:n.emirate||"Not specified"}),b&&(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,Ue.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,Ue.jsx)("i",{className:"fas fa-eye"})})})]})]}),(0,Ue.jsxs)("div",{className:"md:col-span-2",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Sector *"}),(0,Ue.jsxs)("div",{className:"relative",children:[y?(0,Ue.jsxs)("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:n.primarySector,onChange:e=>s(t=>Oe(Oe({},t),{},{primarySector:e.target.value})),children:[(0,Ue.jsx)("option",{value:"",children:"Select Primary Sector"}),(0,Ue.jsx)("option",{value:"Hospitality & Tourism",children:"Hospitality & Tourism"}),(0,Ue.jsx)("option",{value:"Real Estate",children:"Real Estate"}),(0,Ue.jsx)("option",{value:"Financial Services",children:"Financial Services"}),(0,Ue.jsx)("option",{value:"Manufacturing",children:"Manufacturing"}),(0,Ue.jsx)("option",{value:"Technology",children:"Technology"}),(0,Ue.jsx)("option",{value:"Healthcare",children:"Healthcare"}),(0,Ue.jsx)("option",{value:"Education",children:"Education"}),(0,Ue.jsx)("option",{value:"Retail",children:"Retail"})]}):(0,Ue.jsx)("div",{className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 font-medium",children:n.primarySector||"Not specified"}),b&&(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,Ue.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,Ue.jsx)("i",{className:"fas fa-eye"})})})]})]})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-list-check text-purple-600"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Business Activities"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:y?"Select all activities your company engages in":"View selected business activities"})]})]}),(0,Ue.jsx)("div",{className:"flex space-x-3",children:y?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("button",{className:"px-4 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 text-sm font-medium",onClick:()=>s(e=>Oe(Oe({},e),{},{activities:f.map(e=>e.name)})),children:[(0,Ue.jsx)("i",{className:"fas fa-check-double mr-2"}),"Select All"]}),(0,Ue.jsxs)("button",{className:"px-4 py-2 bg-gray-50 text-gray-600 rounded-lg hover:bg-gray-100 text-sm font-medium",onClick:()=>s(e=>Oe(Oe({},e),{},{activities:[]})),children:[(0,Ue.jsx)("i",{className:"fas fa-times mr-2"}),"Deselect All"]})]}):(0,Ue.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-2"}),"View Only"]})})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[f.map(e=>{const t=n.activities.includes(e.name);return(0,Ue.jsxs)("div",{className:"activity-card rounded-lg p-4 transition-all relative ".concat(t?"border-2 border-green-200 bg-green-50":y?"border border-gray-200 bg-white hover:border-green-200 hover:bg-green-50 cursor-pointer":"border border-gray-200 bg-gray-50"),onClick:y?()=>p(e.name):void 0,children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("input",{type:"checkbox",checked:t,onChange:()=>{},className:"w-5 h-5 text-green-600 rounded",disabled:!y}),(0,Ue.jsx)("div",{className:"w-8 h-8 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center ").concat(y?"":"opacity-60"),children:(0,Ue.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600")})}),(0,Ue.jsx)("span",{className:"font-medium ".concat(y?"text-gray-900":"text-gray-600"),children:e.name})]}),b&&(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,Ue.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,Ue.jsx)("i",{className:"fas fa-eye"})})})]},e.id)}),n.activities.filter(e=>!f.some(t=>t.name===e)).map((e,t)=>{const a=(e=>{const t=e.toLowerCase();return t.includes("hotel")||t.includes("accommodation")||t.includes("lodging")||t.includes("room")?{icon:"fas fa-bed",color:"blue"}:t.includes("resort")||t.includes("villa")||t.includes("suite")?{icon:"fas fa-hotel",color:"indigo"}:t.includes("hostel")||t.includes("budget")||t.includes("backpack")?{icon:"fas fa-building",color:"gray"}:t.includes("restaurant")||t.includes("dining")||t.includes("food")||t.includes("kitchen")?{icon:"fas fa-utensils",color:"green"}:t.includes("bar")||t.includes("lounge")||t.includes("pub")||t.includes("beverage")?{icon:"fas fa-cocktail",color:"amber"}:t.includes("coffee")||t.includes("cafe")||t.includes("espresso")?{icon:"fas fa-coffee",color:"yellow"}:t.includes("bakery")||t.includes("pastry")||t.includes("dessert")?{icon:"fas fa-birthday-cake",color:"pink"}:t.includes("catering")||t.includes("banquet")||t.includes("buffet")?{icon:"fas fa-concierge-bell",color:"emerald"}:t.includes("spa")||t.includes("massage")||t.includes("wellness")||t.includes("beauty")?{icon:"fas fa-spa",color:"orange"}:t.includes("gym")||t.includes("fitness")||t.includes("workout")?{icon:"fas fa-dumbbell",color:"red"}:t.includes("pool")||t.includes("swimming")||t.includes("aquatic")?{icon:"fas fa-swimmer",color:"cyan"}:t.includes("sauna")||t.includes("steam")||t.includes("jacuzzi")?{icon:"fas fa-hot-tub",color:"orange"}:t.includes("event")||t.includes("conference")||t.includes("meeting")?{icon:"fas fa-calendar-alt",color:"purple"}:t.includes("wedding")||t.includes("celebration")||t.includes("ceremony")?{icon:"fas fa-heart",color:"rose"}:t.includes("show")||t.includes("entertainment")||t.includes("performance")?{icon:"fas fa-theater-masks",color:"violet"}:t.includes("casino")||t.includes("gaming")||t.includes("slot")?{icon:"fas fa-dice",color:"red"}:t.includes("nightclub")||t.includes("disco")||t.includes("dance")?{icon:"fas fa-music",color:"purple"}:t.includes("retail")||t.includes("shop")||t.includes("store")||t.includes("boutique")?{icon:"fas fa-shopping-bag",color:"red"}:t.includes("gift")||t.includes("souvenir")||t.includes("merchandise")?{icon:"fas fa-gift",color:"green"}:t.includes("market")||t.includes("bazaar")||t.includes("vendor")?{icon:"fas fa-store",color:"orange"}:t.includes("golf")||t.includes("course")?{icon:"fas fa-golf-ball",color:"green"}:t.includes("tennis")||t.includes("court")?{icon:"fas fa-table-tennis",color:"blue"}:t.includes("ski")||t.includes("snow")||t.includes("winter")?{icon:"fas fa-skiing",color:"cyan"}:t.includes("beach")||t.includes("seaside")||t.includes("coastal")?{icon:"fas fa-umbrella-beach",color:"yellow"}:t.includes("water sports")||t.includes("diving")||t.includes("sailing")?{icon:"fas fa-anchor",color:"blue"}:t.includes("business")||t.includes("corporate")||t.includes("office")?{icon:"fas fa-briefcase",color:"slate"}:t.includes("concierge")||t.includes("reception")||t.includes("guest services")?{icon:"fas fa-user-tie",color:"blue"}:t.includes("valet")||t.includes("parking")||t.includes("transport")?{icon:"fas fa-car",color:"gray"}:t.includes("laundry")||t.includes("cleaning")||t.includes("housekeeping")?{icon:"fas fa-tshirt",color:"blue"}:t.includes("tour")||t.includes("excursion")||t.includes("sightseeing")?{icon:"fas fa-map-marked-alt",color:"green"}:t.includes("travel")||t.includes("booking")||t.includes("reservation")?{icon:"fas fa-plane",color:"blue"}:t.includes("cruise")||t.includes("yacht")||t.includes("boat")?{icon:"fas fa-ship",color:"blue"}:t.includes("medical")||t.includes("clinic")||t.includes("health")?{icon:"fas fa-medkit",color:"red"}:t.includes("pet")||t.includes("animal")||t.includes("dog")?{icon:"fas fa-paw",color:"brown"}:t.includes("child")||t.includes("kids")||t.includes("family")?{icon:"fas fa-child",color:"yellow"}:{icon:"fas fa-building-user",color:"purple"}})(e);return(0,Ue.jsx)("div",{className:"activity-card rounded-lg p-4 cursor-pointer transition-all border-2 border-green-200 bg-green-50",onClick:()=>p(e),children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("input",{type:"checkbox",checked:!0,onChange:()=>{},className:"w-5 h-5 text-green-600 rounded"}),(0,Ue.jsx)("div",{className:"w-8 h-8 bg-".concat(a.color,"-100 rounded-lg flex items-center justify-center"),children:(0,Ue.jsx)("i",{className:"".concat(a.icon," text-").concat(a.color,"-600")})}),(0,Ue.jsx)("span",{className:"font-medium text-gray-900",children:e})]})},"custom-".concat(t))})]}),(0,Ue.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add Custom Activity"}),(0,Ue.jsxs)("div",{className:"flex space-x-3",children:[(0,Ue.jsx)("input",{type:"text",placeholder:"Enter custom business activity",className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:n.customActivity,onChange:e=>s(t=>Oe(Oe({},t),{},{customActivity:e.target.value})),onKeyPress:e=>{"Enter"===e.key&&g()}}),(0,Ue.jsxs)("button",{className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",onClick:g,children:[(0,Ue.jsx)("i",{className:"fas fa-plus mr-2"}),"Add Activity"]})]})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,Ue.jsx)("i",{className:"fas fa-info-circle mr-2"}),y?o?"Saving...":"Progress will be automatically saved":"Viewing company information in read-only mode"]}),b&&(0,Ue.jsxs)("div",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-lg text-sm",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only Access"]})]}),(0,Ue.jsx)("div",{className:"flex space-x-4",children:y?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:()=>x(!0),disabled:o,children:[(0,Ue.jsx)("i",{className:"fas ".concat(o?"fa-spinner fa-spin":"fa-save"," mr-2")}),o?"Saving...":"Save Draft"]}),(0,Ue.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:h,disabled:o,children:[o?"Saving...":"Save & Continue",(0,Ue.jsx)("i",{className:"fas ".concat(o?"fa-spinner fa-spin":"fa-arrow-right"," ml-2")})]})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:()=>{},children:[(0,Ue.jsx)("i",{className:"fas fa-download mr-2"}),"Export Info"]}),(0,Ue.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:h,children:["Continue",(0,Ue.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]})})]})]})},Ke=()=>{const e=ae(),{user:t,selectedCompany:a}=Ge(),[n,s]=(0,r.useState)([]),[l,i]=(0,r.useState)([]),o=null===a||void 0===a?void 0:a.id;(0,r.useEffect)(()=>{if(!o)return void console.log("\u23f8\ufe0f No company selected, skipping framework fetch");(async()=>{try{console.log("\ud83d\udd0d Fetching mandatory frameworks for company:",o);const e=await fetch("".concat(Le,"/api/companies/").concat(o,"/frameworks/"),{credentials:"include"});if(e.ok){const t=await e.json();console.log("\ud83d\udccb Backend frameworks:",t);const a=[{id:"esg",name:"ESG Framework",description:"Core Environmental, Social, and Governance reporting framework",icon:"fas fa-chart-line",color:"blue",coverage:"Environmental, Social, Governance",reason:"Core framework for all businesses"},{id:"dst",name:"Dubai Sustainable Tourism (DST)",description:"Dubai Department of Economy and Tourism sustainability requirements for all hotels in Dubai",icon:"fas fa-building",color:"green",coverage:"Energy, Water, Waste, Community",reason:"Mandatory for all Dubai hospitality entities"},{id:"gri",name:"GRI Standards",description:"Global Reporting Initiative standards for sustainability reporting",icon:"fas fa-globe",color:"purple",coverage:"Economic, Environmental, Social",reason:"International sustainability reporting standard"}];let n=[];t&&Array.isArray(t)&&t.length>0?(n=t.map(e=>"DST"===e.framework_id?a[1]:"ESG"===e.framework_id?a[0]:"GRI"===e.framework_id?a[2]:{id:e.framework_id.toLowerCase(),name:e.name||e.framework_id,description:e.description||"Framework description",icon:"fas fa-chart-line",color:"blue",coverage:"Various sustainability aspects",reason:"Required for your business profile"}),console.log("\u2705 Mapped backend frameworks:",n)):(console.log("\u26a0\ufe0f Backend returned empty frameworks, using all mandatory frameworks"),n=a);const r=n.map(e=>e.id);a.forEach(e=>{r.includes(e.id)||n.push(e)}),console.log("\u2705 Final mandatory frameworks:",n),i(n)}else console.error("Failed to fetch frameworks, using fallback"),i([{id:"esg",name:"ESG Framework",description:"Core Environmental, Social, and Governance reporting framework",icon:"fas fa-chart-line",color:"blue",coverage:"Environmental, Social, Governance",reason:"Core framework for all businesses"},{id:"dst",name:"Dubai Sustainable Tourism (DST)",description:"Dubai Department of Economy and Tourism sustainability requirements for all hotels in Dubai",icon:"fas fa-building",color:"green",coverage:"Energy, Water, Waste, Community",reason:"Mandatory for all Dubai hospitality entities"},{id:"gri",name:"GRI Standards",description:"Global Reporting Initiative standards for sustainability reporting",icon:"fas fa-globe",color:"purple",coverage:"Economic, Environmental, Social",reason:"International sustainability reporting standard"}])}catch(e){console.error("Error fetching mandatory frameworks:",e),i([{id:"esg",name:"ESG Framework",description:"Core Environmental, Social, and Governance reporting framework",icon:"fas fa-chart-line",color:"blue",coverage:"Environmental, Social, Governance",reason:"Core framework for all businesses"},{id:"dst",name:"Dubai Sustainable Tourism (DST)",description:"Dubai Department of Economy and Tourism sustainability requirements for all hotels in Dubai",icon:"fas fa-building",color:"green",coverage:"Energy, Water, Waste, Community",reason:"Mandatory for all Dubai hospitality entities"},{id:"gri",name:"GRI Standards",description:"Global Reporting Initiative standards for sustainability reporting",icon:"fas fa-globe",color:"purple",coverage:"Economic, Environmental, Social",reason:"International sustainability reporting standard"}])}})()},[o]);const c=()=>{e("/list")};if(!t||!["super_user","admin","site_manager","viewer"].includes(t.role))return(0,Ue.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,Ue.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access framework selection."}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})});const d=["super_user","admin"].includes(null===t||void 0===t?void 0:t.role),u=["site_manager","viewer"].includes(null===t||void 0===t?void 0:t.role);return(0,Ue.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-red-600"})}),(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Mandatory Frameworks"}),(0,Ue.jsx)("div",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium",children:"Required"})]}),u&&(0,Ue.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-2"}),"View Only Mode"]})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:l.map(e=>(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border-2 border-red-200",children:[(0,Ue.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 bg-".concat(e.color,"-100 rounded-xl flex items-center justify-center"),children:(0,Ue.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-2xl")})}),(0,Ue.jsx)("div",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Mandatory"})]}),(0,Ue.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:e.name}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,Ue.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("i",{className:"fas fa-info-circle text-yellow-600 text-sm"}),(0,Ue.jsxs)("span",{className:"text-yellow-800 text-sm font-medium",children:["Auto-assigned: ",e.reason]})]})}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Coverage:"})," ",e.coverage]})]},e.id))})]}),(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-hand-pointer text-blue-600"})}),(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Voluntary Frameworks"}),(0,Ue.jsx)("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:"Optional"})]}),u&&(0,Ue.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-2"}),"View Selected Frameworks"]})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[{id:"green_key",name:"Green Key Certification",description:"Eco-label for tourism establishments with comprehensive sustainability criteria",icon:"fas fa-key",color:"green",features:["13 criteria areas","Water & energy efficiency","Guest engagement programs"],bestFor:"Hotels seeking eco-certification"},{id:"gri",name:"GRI Standards",description:"Global Reporting Initiative - Comprehensive sustainability reporting standards",icon:"fas fa-globe",color:"blue",features:["Universal standards","Stakeholder engagement","Detailed disclosures"],bestFor:"Comprehensive sustainability reporting"},{id:"sasb",name:"SASB Standards",description:"Sustainability Accounting Standards Board - Industry-specific sustainability metrics",icon:"fas fa-chart-bar",color:"purple",features:["Industry-specific metrics","Investor-focused reporting","Materiality assessment"],bestFor:"Public companies, Investor relations"},{id:"tcfd",name:"TCFD",description:"Task Force on Climate-related Financial Disclosures - Climate risk reporting",icon:"fas fa-thermometer-half",color:"orange",features:["Climate risk assessment","Scenario planning","Financial impact disclosure"],bestFor:"Climate-focused reporting"},{id:"cdp",name:"CDP",description:"Carbon Disclosure Project - Environmental disclosure system for companies",icon:"fas fa-cloud",color:"teal",features:["Environmental disclosure","Climate scoring","Water & forest reporting"],bestFor:"Environmental transparency"}].map(e=>{const t=n.includes(e.id);return(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border transition-all relative ".concat(t?"border-blue-300 shadow-md":"border-gray-200"," ").concat(d?"cursor-pointer hover:border-blue-300 hover:shadow-md":"cursor-default"),onClick:d?()=>{return t=e.id,void s(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}:void 0,children:[(0,Ue.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 bg-".concat(e.color,"-100 rounded-xl flex items-center justify-center ").concat(d?"":"opacity-60"),children:(0,Ue.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-2xl")})}),(0,Ue.jsxs)("label",{className:"relative inline-flex items-center ".concat(d?"cursor-pointer":"cursor-default"),children:[(0,Ue.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:t,onChange:()=>{},disabled:!d}),(0,Ue.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all ".concat(t?"peer-checked:bg-blue-600":""," ").concat(d?"":"opacity-60")})]})]}),u&&(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,Ue.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,Ue.jsx)("i",{className:"fas fa-eye"})})}),(0,Ue.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:e.name}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,Ue.jsx)("div",{className:"space-y-2 mb-4",children:e.features.map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("i",{className:"fas fa-check text-green-500 text-sm"}),(0,Ue.jsx)("span",{className:"text-sm text-gray-600",children:e})]},t))}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Best for:"})," ",e.bestFor]})]},e.id)})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Selected Frameworks Summary"}),(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,Ue.jsx)("span",{className:"font-medium text-gray-900",children:"Mandatory Frameworks"}),(0,Ue.jsxs)("span",{className:"text-sm text-red-600 font-medium",children:[l.length," Required"]})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,Ue.jsx)("span",{className:"font-medium text-gray-900",children:"Voluntary Frameworks"}),(0,Ue.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:[n.length," Selected"]})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,Ue.jsx)("span",{className:"font-medium text-gray-900",children:"Total Frameworks"}),(0,Ue.jsxs)("span",{className:"text-sm text-green-600 font-medium",children:[l.length+n.length," Active"]})]})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:()=>e("/onboard"),children:[(0,Ue.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]}),u&&(0,Ue.jsxs)("div",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-lg text-sm",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only Access"]})]}),(0,Ue.jsx)("div",{className:"flex space-x-4",children:d?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-save mr-2"}),"Save Draft"]}),(0,Ue.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:c,children:["Save & Continue",(0,Ue.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-download mr-2"}),"Export Selection"]}),(0,Ue.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:c,children:["Continue",(0,Ue.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]})})]})]})},Ye=e=>{let{isOpen:t,onClose:a,title:n,message:r,type:s="info",showCloseButton:l=!0,children:o}=e;if(!t)return null;const{icon:c,bgColor:d,iconColor:u,borderColor:m}=(()=>{switch(s){case"success":return{icon:"fas fa-check-circle",bgColor:"bg-green-100",iconColor:"text-green-600",borderColor:"border-green-200"};case"error":return{icon:"fas fa-exclamation-circle",bgColor:"bg-red-100",iconColor:"text-red-600",borderColor:"border-red-200"};case"warning":return{icon:"fas fa-exclamation-triangle",bgColor:"bg-yellow-100",iconColor:"text-yellow-600",borderColor:"border-yellow-200"};default:return{icon:"fas fa-info-circle",bgColor:"bg-blue-100",iconColor:"text-blue-600",borderColor:"border-blue-200"}}})(),f=(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},onClick:e=>{e.target===e.currentTarget&&a()},children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl border-2 ".concat(m),children:[(0,Ue.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,Ue.jsx)("div",{className:"flex-shrink-0 w-10 h-10 ".concat(d," rounded-full flex items-center justify-center"),children:(0,Ue.jsx)("i",{className:"".concat(c," ").concat(u)})}),(0,Ue.jsxs)("div",{className:"flex-1 min-w-0",children:[n&&(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n}),r&&(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:r}),o]})]}),l&&(0,Ue.jsx)("div",{className:"flex justify-end mt-6",children:(0,Ue.jsx)("button",{onClick:a,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"OK"})})]})});return(0,i.createPortal)(f,document.body)},Je=()=>{const e=ae(),{user:t,selectedCompany:a,hasPermission:n}=Ge(),[s,l]=(0,r.useState)({}),[i,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)([]),[f,p]=(0,r.useState)(!0),[g,x]=(0,r.useState)({isOpen:!1,type:"info",title:"",message:""}),[h,y]=(0,r.useState)(!1),b=null===a||void 0===a?void 0:a.id;console.log("List component - selectedCompany:",a),console.log("List component - companyId:",b),console.log("List component - user:",t);const v=(e,t,a)=>{x({isOpen:!0,type:e,title:t,message:a})},j=async()=>{if(b)try{console.log("Fetching profiling questions for company:",b);const e=await ze("".concat(Le,"/api/profiling-questions/for_company/?company_id=").concat(b));if(console.log("Response status:",e.status,"Response ok:",e.ok),e.ok){const t=await e.json();if(console.log("Fetched questions from backend:",t),console.log("Questions type:",typeof t,"Length:",t.length),Array.isArray(t)&&t.length>0){const e=t.map(e=>({id:e.question_id,text:e.text,activatesElement:e.activates_element,category:"Basic Operations"}));console.log("Transformed questions:",e),m(e)}else console.error("Questions array is empty or not an array:",t)}else{const t=await e.text();console.error("Failed to fetch profiling questions. Status:",e.status,"Error:",t)}}catch(e){console.error("Error fetching profiling questions:",e)}else console.log("No company selected, skipping profiling questions fetch")};(0,r.useEffect)(()=>{b&&(async()=>{p(!0),l({}),o(!1),m([]),await j(),await w(),await N(),await k(),p(!1)})()},[b]);const w=async()=>{if(b)try{console.log("Fetching existing profile answers for company:",b);const e=await ze("".concat(Le,"/api/companies/").concat(b,"/profile_answers/"));if(e.ok){const t=await e.json();console.log("Loaded profile answers from API:",t);const a={};t.forEach(e=>{a[e.question]=e.answer}),console.log("Setting answers state to:",a),l(a),Object.keys(a).length>0&&console.log("Answers found, checking if should show checklist")}else console.log("No existing answers found or API error, status:",e.status)}catch(e){console.error("Error fetching existing answers:",e)}},N=async()=>{if(!b)return!1;try{console.log("\ud83d\udd0d Checking if checklist exists for company:",b);const e=await ze("".concat(Le,"/api/checklist/?company_id=").concat(b));if(e.ok){const t=await e.json(),a=t.results&&t.results.length>0;return console.log("\u2705 Checklist exists check result:",a),y(a),a}console.log("\u274c Failed to check checklist:",e.status),y(!1)}catch(e){console.error("\u274c Error checking checklist existence:",e),y(!1)}return!1},k=async()=>{if(b)try{const e=await ze("".concat(Le,"/api/companies/").concat(b,"/profile_answers/"));if(e.ok){const t=await e.json(),a=await ze("".concat(Le,"/api/profiling-questions/for_company/?company_id=").concat(b));if(a.ok){const e=await a.json();if(t.length>0&&t.length>=e.length){console.log("Profiling wizard completed");await N()&&(console.log("Checklist exists, showing checklist view"),o(!0))}}}}catch(e){console.error("Error checking wizard completion:",e)}},S=[{id:"electricity",name:"Electricity Consumption",description:"Total electricity from local providers",unit:"kWh",cadence:"Monthly",frameworks:["DST","ESG","Green Key"],category:"Environmental",is_metered:!0,meter_type:"Electricity"},{id:"water",name:"Water Consumption",description:"Total water usage",unit:"m\xb3",cadence:"Monthly",frameworks:["DST","ESG","Green Key"],category:"Environmental",is_metered:!0,meter_type:"Water"},{id:"waste_landfill",name:"Waste to Landfill",description:"Non-recycled waste disposal",unit:"kg",cadence:"Monthly",frameworks:["DST","ESG","Green Key"],category:"Environmental",is_metered:!0,meter_type:"Waste"},{id:"sustainability_policy",name:"Sustainability Policy",description:"Written sustainability policy",unit:"Document",cadence:"Annually",frameworks:["DST","Green Key","ESG"],category:"Social",is_metered:!1},{id:"sustainability_personnel",name:"Sustainability Personnel",description:"Certified sustainability staff",unit:"Count",cadence:"Annually",frameworks:["DST","Green Key"],category:"Social",is_metered:!1},{id:"employee_training",name:"Employee Training Hours",description:"Sustainability training per employee",unit:"Hours",cadence:"Annually",frameworks:["DST","Green Key","ESG"],category:"Social",is_metered:!1},{id:"guest_education",name:"Guest Education",description:"Guest sustainability initiatives",unit:"Count",cadence:"Quarterly",frameworks:["DST","Green Key"],category:"Social",is_metered:!1},{id:"community_initiatives",name:"Community Initiatives",description:"Local community programs",unit:"Count, AED",cadence:"Annually",frameworks:["DST","Green Key","ESG"],category:"Social",is_metered:!1},{id:"government_compliance",name:"Government Compliance",description:"Energy regulation compliance",unit:"Status",cadence:"Annually",frameworks:["DST","ESG"],category:"Governance",is_metered:!1},{id:"action_plan",name:"Action Plan",description:"Annual sustainability objectives",unit:"Document",cadence:"Annually",frameworks:["DST","Green Key","ESG"],category:"Governance",is_metered:!1},{id:"carbon_footprint",name:"Carbon Footprint",description:"Total GHG emissions",unit:"tonnes CO2e",cadence:"Annually",frameworks:["ESG","DST"],category:"Environmental",is_metered:!1},{id:"health_safety",name:"Health & Safety Incidents",description:"Workplace incidents",unit:"Count",cadence:"Monthly",frameworks:["ESG"],category:"Social",is_metered:!1},{id:"anti_corruption",name:"Anti-corruption Policies",description:"Anti-corruption measures",unit:"Status",cadence:"Annually",frameworks:["ESG"],category:"Governance",is_metered:!1},{id:"risk_management",name:"Risk Management",description:"ESG risk framework",unit:"Status",cadence:"Annually",frameworks:["ESG"],category:"Governance",is_metered:!1}],_={generator_fuel:{id:"generator_fuel",name:"Generator Fuel",description:"Fuel for backup generators",unit:"liters",cadence:"Monthly",frameworks:["DST","ESG"],category:"Environmental",is_metered:!0,meter_type:"Generator"},vehicle_fuel:{id:"vehicle_fuel",name:"Vehicle Fuel",description:"Company vehicle fuel",unit:"liters",cadence:"Monthly",frameworks:["DST","ESG"],category:"Environmental",is_metered:!0,meter_type:"Vehicle"},lpg_consumption:{id:"lpg_consumption",name:"LPG Usage",description:"Liquid petroleum gas consumption",unit:"kg",cadence:"Monthly",frameworks:["DST","ESG"],category:"Environmental",is_metered:!0,meter_type:"LPG"},green_events:{id:"green_events",name:"Green Events",description:"Sustainable event services",unit:"Count",cadence:"Quarterly",frameworks:["DST","Green Key"],category:"Social",is_metered:!1},food_sourcing:{id:"food_sourcing",name:"Food Sourcing",description:"Local/organic food purchases",unit:"%",cadence:"Quarterly",frameworks:["Green Key","ESG"],category:"Environmental",is_metered:!1},green_spaces:{id:"green_spaces",name:"Green Spaces",description:"Sustainable landscaping",unit:"m\xb2",cadence:"Annually",frameworks:["Green Key"],category:"Environmental",is_metered:!1},renewable_energy_usage:{id:"renewable_energy_usage",name:"Renewable Energy",description:"Energy from renewable sources",unit:"%",cadence:"Quarterly",frameworks:["Green Key","ESG"],category:"Environmental",is_metered:!0,meter_type:"Renewable Energy"},environmental_management_system:{id:"environmental_management_system",name:"Environmental Management System",description:"EMS certification",unit:"Status",cadence:"Annually",frameworks:["Green Key","ESG"],category:"Governance",is_metered:!1},board_composition:{id:"board_composition",name:"Board Composition",description:"Board diversity metrics",unit:"%",cadence:"Annually",frameworks:["ESG"],category:"Governance",is_metered:!1}},C=async(e,t)=>{if(!n("frameworkSelection","update"))return void v("warning","Permission Denied","You do not have permission to edit profiling answers. This is view-only mode.");const a=Oe(Oe({},s),{},{[e]:t});l(a);try{console.log("Saving profiling answer to database:",e,t);const a=await ze("".concat(Le,"/api/companies/").concat(b,"/save_profile_answer/"),{method:"POST",body:JSON.stringify({question:e,answer:t})});if(a.ok){const e=await a.json();console.log("Answer saved successfully:",e)}else{console.error("Failed to save answer. Status:",a.status);const e=await a.text();console.error("Error response:",e),403===a.status&&v("error","Permission Denied","You can only view profiling answers.")}}catch(r){console.error("Error saving answer to database:",r)}},E=async e=>{if(!n("frameworkSelection","update"))return void v("warning","Permission Denied","You do not have permission to edit profiling answers. This is view-only mode.");const t={};u.forEach(a=>{t[a.id]=e}),l(t);try{console.log("Saving all profiling answers to database:",e);const t=u.map(t=>ze("".concat(Le,"/api/companies/").concat(b,"/save_profile_answer/"),{method:"POST",body:JSON.stringify({question:t.id,answer:e})})),a=await Promise.all(t);if(a.every(e=>e.ok))console.log("All answers saved successfully");else{console.error("Some answers failed to save");a.some(e=>403===e.status)&&v("error","Permission Denied","You can only view profiling answers.")}}catch(a){console.error("Error saving all answers to database:",a)}},P=u.length>0&&u.every(e=>s.hasOwnProperty(e.id));console.log("\ud83d\udd0d Component render state:",{companyId:b,answersCount:Object.keys(s).length,questionsCount:u.length,allQuestionsAnswered:P,showChecklist:i,checklistExists:h,hasEditPermission:n("frameworkSelection","update"),userRole:null===t||void 0===t?void 0:t.role,loading:f});const M=(()=>{if(!P)return;const e=[...S];return u.forEach(t=>{!0===s[t.id]&&_[t.activatesElement]&&e.push(_[t.activatesElement])}),e.sort((e,t)=>e.category.localeCompare(t.category))})(),T=M?M.reduce((e,t)=>{const a=t.category.toLowerCase();return e[a]=(e[a]||0)+1,e},{environmental:0,social:0,governance:0}):{environmental:0,social:0,governance:0},A=()=>{console.log("Profiling wizard completed, continuing to meters"),e("/meter")};return i&&P?(0,Ue.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-check-circle text-green-600"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Personalized Data Checklist"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Your customized data requirements based on your responses"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,Ue.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:M.length}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"Total Elements"})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-green-600",children:T.environmental}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"Environmental"})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:T.social}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"Social"})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:T.governance}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"Governance"})]})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Data Collection Requirements"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Complete list of data elements you need to track"})]}),(0,Ue.jsx)("div",{className:"divide-y divide-gray-100",children:M.map((e,t)=>(0,Ue.jsx)("div",{className:"p-6 hover:bg-blue-50 transition-colors",children:(0,Ue.jsx)("div",{className:"flex items-start justify-between",children:(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,Ue.jsxs)("span",{className:"text-sm font-bold text-blue-600 bg-blue-100 px-2 py-1 rounded",children:["#",t+1]}),(0,Ue.jsx)("h4",{className:"font-bold text-gray-900 text-lg",children:e.name}),(0,Ue.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat("Environmental"===e.category?"bg-green-200 text-green-900":"Social"===e.category?"bg-purple-200 text-purple-900":"bg-orange-200 text-orange-900"),children:e.category})]}),(0,Ue.jsx)("p",{className:"text-gray-700 text-base mb-4 font-medium",children:e.description}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-8 text-sm font-medium text-gray-700",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-100 px-3 py-2 rounded-lg",children:[(0,Ue.jsx)("i",{className:"fas fa-ruler text-gray-600"}),(0,Ue.jsxs)("span",{children:["Unit: ",(0,Ue.jsx)("span",{className:"font-bold text-gray-900",children:e.unit})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-100 px-3 py-2 rounded-lg",children:[(0,Ue.jsx)("i",{className:"fas fa-clock text-gray-600"}),(0,Ue.jsxs)("span",{children:["Frequency: ",(0,Ue.jsx)("span",{className:"font-bold text-gray-900",children:e.cadence})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-100 px-3 py-2 rounded-lg",children:[(0,Ue.jsx)("i",{className:"fas fa-tags text-gray-600"}),(0,Ue.jsx)("span",{children:"Frameworks:"}),(0,Ue.jsx)("div",{className:"flex items-center space-x-2",children:e.frameworks.map((e,t)=>(0,Ue.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold ".concat("DST"===e?"bg-blue-200 text-blue-900":"ESG"===e?"bg-green-200 text-green-900":"Green Key"===e?"bg-teal-200 text-teal-900":"TCFD"===e?"bg-orange-200 text-orange-900":"SASB"===e?"bg-purple-200 text-purple-900":"bg-gray-200 text-gray-900"),children:e},t))})]})]})]})})},e.id))})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("div",{className:"flex items-center space-x-4",children:(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:async()=>{o(!1),await N()},children:[(0,Ue.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back to Questions"]})}),(0,Ue.jsxs)("div",{className:"flex space-x-4",children:[(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-download mr-2"}),"Export Checklist"]}),(0,Ue.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:A,children:["Save & Continue",(0,Ue.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]})]})]}):b?f?(0,Ue.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,Ue.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading profiling questions..."})]})}):0===u.length?(0,Ue.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"No Questions Available"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"No profiling questions found. Please contact support or check your backend configuration."}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:["Debug info: Company ID: ",b,", Questions loaded: ",u.length,", Loading: ",f.toString()]}),(0,Ue.jsx)("div",{className:"mt-4",children:(0,Ue.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",onClick:()=>{p(!0),j()},children:"Retry Loading Questions"})})]})}):(0,Ue.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-question-circle text-blue-600"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Profiling Wizard"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Answer these questions to personalize your data requirements"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,Ue.jsx)("span",{className:"font-medium",children:Object.keys(s).length})," of ",(0,Ue.jsx)("span",{className:"font-medium",children:u.length})," questions answered",!n("frameworkSelection","update")&&(0,Ue.jsxs)("span",{className:"ml-4 px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only"]})]}),n("frameworkSelection","update")&&(0,Ue.jsxs)("div",{className:"flex space-x-3",children:[(0,Ue.jsxs)("button",{className:"px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 text-sm font-medium",onClick:()=>E(!1),children:[(0,Ue.jsx)("i",{className:"fas fa-times mr-2"}),"Answer All No"]}),(0,Ue.jsxs)("button",{className:"px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 text-sm font-medium",onClick:()=>E(!0),children:[(0,Ue.jsx)("i",{className:"fas fa-check mr-2"}),"Answer All Yes"]})]})]}),(0,Ue.jsx)("div",{className:"mt-4",children:(0,Ue.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Ue.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(Object.keys(s).length/u.length*100,"%")}})})})]}),["Basic Operations"].map(e=>(0,Ue.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:[(0,Ue.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e})}),(0,Ue.jsx)("div",{className:"p-6 space-y-6",children:u.filter(t=>t.category===e).map(e=>{var t;return(0,Ue.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,Ue.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Ue.jsxs)("div",{className:"flex-1 pr-4",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900 mb-2",children:e.text}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-500",children:["This will activate: ",(0,Ue.jsx)("span",{className:"font-medium",children:(null===(t=_[e.activatesElement])||void 0===t?void 0:t.name)||e.activatesElement})]})]}),(0,Ue.jsxs)("div",{className:"flex space-x-3",children:[(0,Ue.jsx)("button",{className:"px-4 py-2 rounded-lg font-medium text-sm transition-colors ".concat(!1===s[e.id]?"bg-red-100 text-red-700 border-2 border-red-300":n("frameworkSelection","update")?"bg-gray-100 text-gray-600 border border-gray-300 hover:bg-red-50":"bg-gray-200 text-gray-500 border border-gray-300 cursor-not-allowed"),onClick:()=>C(e.id,!1),disabled:!n("frameworkSelection","update"),children:"No"}),(0,Ue.jsx)("button",{className:"px-4 py-2 rounded-lg font-medium text-sm transition-colors ".concat(!0===s[e.id]?"bg-green-100 text-green-700 border-2 border-green-300":n("frameworkSelection","update")?"bg-gray-100 text-gray-600 border border-gray-300 hover:bg-green-50":"bg-gray-200 text-gray-500 border border-gray-300 cursor-not-allowed"),onClick:()=>C(e.id,!0),disabled:!n("frameworkSelection","update"),children:"Yes"})]})]})},e.id)})})]},e)),P&&n("frameworkSelection","update")&&!h&&(0,Ue.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6 mb-8",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-green-900",children:"All Questions Answered!"}),(0,Ue.jsx)("p",{className:"text-green-700",children:"Click below to generate your personalized data checklist"})]}),(0,Ue.jsx)("button",{className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed",onClick:async()=>{await(async()=>{if(!P)return!1;d(!0);try{const e=u.map(e=>({question_id:e.id,answer:!0===s[e.id]}));if(console.log("Sending answers to backend:",e),(await ze("".concat(Le,"/api/profiling-questions/save_answers/"),{method:"POST",body:JSON.stringify({company_id:b,answers:e})})).ok){const e=await ze("".concat(Le,"/api/checklist/?company_id=").concat(b));if(e.ok){return(await e.json()).results.map(e=>({id:e.id,name:e.element_name,description:e.element_description,unit:e.element_unit,frequency:e.cadence,frameworks:e.frameworks_list,category:e.is_metered?"Environmental":"Social",isMetered:e.is_metered}))}}throw new Error("Failed to save answers or generate checklist")}catch(e){return console.error("Error saving answers and generating checklist:",e),v("error","Generation Failed","Failed to generate checklist. Please try again."),!1}finally{d(!1)}})()&&(console.log("Profiling wizard completed, showing checklist"),y(!0),o(!0))},disabled:c,children:c?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Generating..."]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("i",{className:"fas fa-list mr-2"}),"Generate Checklist"]})})]})}),!n("frameworkSelection","update")&&(0,Ue.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 mb-8",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-eye text-blue-600"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-blue-900",children:"Profiling (View Only)"}),(0,Ue.jsx)("p",{className:"text-blue-700",children:h?"You can view the generated checklist.":"Questions have been answered by an admin. Checklist will be available once generated."})]})]}),h&&(0,Ue.jsxs)("button",{className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",onClick:()=>o(!0),children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-2"}),"View Checklist"]})]})}),P&&h&&!i&&n("frameworkSelection","update")&&(0,Ue.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6 mb-8",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-green-900",children:"\u2705 Checklist Ready!"}),(0,Ue.jsx)("p",{className:"text-green-700",children:"Your personalized data checklist has been created and is ready to view."})]}),(0,Ue.jsxs)("button",{className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium",onClick:()=>o(!0),children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-2"}),"View Checklist"]})]})}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("div",{className:"flex items-center space-x-4",children:(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:()=>e("/rame"),children:[(0,Ue.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]})}),(0,Ue.jsx)("div",{className:"text-center",children:(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:P?"Generate your checklist to continue":"Answer ".concat(u.length-Object.keys(s).length," more questions to continue")})})]}),(0,Ue.jsx)(Ye,{isOpen:g.isOpen,onClose:()=>{x({isOpen:!1,type:"info",title:"",message:""})},type:g.type,title:g.title,message:g.message})]}):(0,Ue.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"No Company Selected"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Please select a company from the navigation bar to continue with profiling."})]})})},Xe=e=>{var t;let{isOpen:a,title:n,meter:s,meterTypes:l,onSave:i,onClose:o}=e;const[c,d]=(0,r.useState)(!0),[u,m]=(0,r.useState)({name:"",type:"",location:"",account_number:""}),[f,p]=(0,r.useState)({show:!1,message:"",type:"error"});r.useEffect(()=>{s?(m({name:s.name||"",type:s.type||"",location:s.location||"",account_number:s.account_number||""}),d(!1)):(m({name:"",type:"",location:"",account_number:""}),d(!0)),p({show:!1,message:"",type:"error"})},[s,a]);const g=(e,t)=>{m(a=>Oe(Oe({},a),{},{[e]:t})),f.show&&p({show:!1,message:"",type:"error"})};return a?(0,Ue.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,Ue.jsx)("div",{className:"bg-white rounded-md p-5 border w-full max-w-md shadow-lg mx-4",children:(0,Ue.jsxs)("div",{className:"mt-3",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:n}),(0,Ue.jsx)("button",{type:"button",className:"text-gray-400 hover:text-gray-600",onClick:o,children:(0,Ue.jsx)("i",{className:"fas fa-times"})})]}),f.show&&(0,Ue.jsx)("div",{className:"p-3 rounded-lg mb-4 ".concat("error"===f.type?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"),children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("i",{className:"fas ".concat("error"===f.type?"fa-exclamation-circle":"fa-info-circle"," text-sm")}),(0,Ue.jsx)("span",{className:"text-sm font-medium",children:f.message})]})}),c&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Select the type of meter to add:"}),(0,Ue.jsx)("div",{className:"space-y-2",children:l.filter(e=>"total"!==e.id).map(e=>(0,Ue.jsx)("button",{type:"button",className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",onClick:()=>(e=>{l.find(t=>t.name.replace(" Meters","").replace(" Trackers","")===e);const t={Electricity:"Electricity Consumption",Water:"Water Consumption",Waste:"Waste to Landfill",Generator:"Generator Fuel Consumption",Vehicle:"Vehicle Fuel Consumption",LPG:"LPG Usage","Renewable Energy":"Renewable Energy Usage"}[e]||e;m(a=>{var n;return Oe(Oe({},a),{},{type:t,name:null!==s&&void 0!==s&&null!==(n=s.name)&&void 0!==n&&n.includes("Copy")?"".concat(e," Copy"):"Main ".concat(e),location:"To be configured"})}),d(!1)})(e.name.replace(" Meters","").replace(" Trackers","")),children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center"),children:(0,Ue.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600")})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("span",{className:"font-medium text-gray-900",children:e.name}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.id))})]}),!c&&(0,Ue.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!u.name.trim()||!u.type)return void p({show:!0,message:"Please fill in required fields (Name and Type)",type:"error"});const t=Oe(Oe({},u),s&&{id:s.id,isAutoCreated:s.isAutoCreated});p({show:!1,message:"",type:"error"}),i(t)},children:[(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meter Type"}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsx)("div",{className:"flex items-center space-x-3",children:(()=>{const e=l.find(e=>e.name.replace(" Meters","").replace(" Trackers","")===u.type);return(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-".concat(null===e||void 0===e?void 0:e.color,"-100 rounded-lg flex items-center justify-center"),children:(0,Ue.jsx)("i",{className:"".concat(null===e||void 0===e?void 0:e.icon," text-").concat(null===e||void 0===e?void 0:e.color,"-600")})}),(0,Ue.jsx)("span",{className:"font-medium text-gray-900",children:u.type})]})})()}),(0,Ue.jsx)("button",{type:"button",className:"text-sm text-blue-600 hover:text-blue-800",onClick:()=>d(!0),children:"Change"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Meter Name ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Main Building Electric, Kitchen Water",value:u.name,onChange:e=>g("name",e.target.value),required:!0})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location Description"}),(0,Ue.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Main Building, Kitchen Area, Basement",value:u.location,onChange:e=>g("location",e.target.value)})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account/Meter Number"}),(0,Ue.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., ELE-001-2024, WAT-002-2024",value:u.account_number,onChange:e=>g("account_number",e.target.value)})]})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,Ue.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",onClick:o,children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:null!==s&&void 0!==s&&null!==(t=s.name)&&void 0!==t&&t.includes("Copy")?"Add Meter":s?"Save Changes":"Add Meter"})]})]})]})})}):null},Ze=()=>{var e;const t=ae(),{user:a,selectedCompany:n}=Ge(),[s,l]=(0,r.useState)(null),[i,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null),[f,p]=(0,r.useState)([]),[g,x]=(0,r.useState)(!0),[h,y]=(0,r.useState)(""),[b,v]=(0,r.useState)("All Types"),[j,w]=(0,r.useState)("All Status"),[N,k]=(0,r.useState)("grid"),[S,_]=(0,r.useState)({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null}),C=function(e,t){_({show:!0,type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info",title:e,message:t,onConfirm:()=>_({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null}),onCancel:null})},E=function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_({show:!0,type:"confirm",title:e,message:t,onConfirm:()=>{_({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null}),a()},onCancel:n?()=>{_({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null}),n()}:()=>_({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null})})},P=()=>{_({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null})},M=null===n||void 0===n?void 0:n.id,T=async()=>{if(M){x(!0);try{const e=await ze("".concat(Le,"/api/meters/?company_id=").concat(M)),t=(await e.json()).results.map(e=>{const t=e.name&&e.name.trim().toLowerCase().startsWith("main");return{id:e.id,name:e.name,type:e.type,location:e.location_description||"To be configured",account_number:e.account_number||"",status:"active"===e.status?"Active":"Inactive",lastReading:"No readings yet",lastUpdate:new Date(e.created_at).toLocaleString(),dataPoints:["Primary Measurement"],frameworks:["Auto-assigned"],has_data:e.has_data,isAutoCreated:t}});p(t)}catch(e){console.error("Error fetching meters:",e)}finally{x(!1)}}else console.log("No company selected, skipping meters fetch")},A=async e=>{try{var t;console.log("\ud83d\udd0d CREATE METER - Starting meter creation"),console.log("\ud83d\udcca Company ID:",M),console.log("\ud83d\udcca Original meter data received:",e);const a={company:M,name:e.name,type:e.type,location_description:e.location,account_number:e.account_number,status:(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())||"active"};console.log("\ud83d\udce4 Request body being sent:",a),console.log("\ud83c\udf10 Request URL:","".concat(Le,"/api/meters/?company_id=").concat(M));const n=await ze("".concat(Le,"/api/meters/?company_id=").concat(M),{method:"POST",body:JSON.stringify(a)});if(console.log("\ud83d\udce5 Response status:",n.status),console.log("\ud83d\udce5 Response ok:",n.ok),n.ok){const e=await n.json();return console.log("\u2705 Meter created successfully:",e),await T(),!0}try{const e=await n.json();console.error("\u274c Server error response:",e)}catch(Mt){console.error("\u274c Could not parse error response")}return console.error("\u274c Response status:",n.status,n.statusText),!1}catch(a){return console.error("\ud83d\udca5 Network error creating meter:",a),console.error("\ud83d\udca5 Error details:",{message:a.message,stack:a.stack}),!1}},D=async(e,t)=>{try{var a;return!!(await ze("".concat(Le,"/api/meters/").concat(e,"/?company_id=").concat(M),{method:"PATCH",body:JSON.stringify({name:t.name,type:t.type,location_description:t.location,account_number:t.account_number,status:(null===(a=t.status)||void 0===a?void 0:a.toLowerCase())||"active"})})).ok&&(await T(),!0)}catch(n){return console.error("Error updating meter:",n),!1}};(0,r.useEffect)(()=>{M&&T()},[M]);const R=[{id:"total",name:"Total Meters",icon:"fas fa-gauge",color:"blue",count:f.length,description:"All configured meters"},{id:"electricity",name:"Electricity Meters",icon:"fas fa-bolt",color:"yellow",count:f.filter(e=>"Electricity Consumption"===e.type).length,description:"Electricity consumption monitoring"},{id:"water",name:"Water Meters",icon:"fas fa-tint",color:"blue",count:f.filter(e=>"Water Consumption"===e.type).length,description:"Water consumption and flow monitoring"},{id:"waste",name:"Waste Trackers",icon:"fas fa-trash-alt",color:"green",count:f.filter(e=>"Waste to Landfill"===e.type).length,description:"Waste generation and disposal monitoring"},{id:"generator",name:"Generator Meters",icon:"fas fa-gas-pump",color:"red",count:f.filter(e=>"Generator Fuel Consumption"===e.type).length,description:"Generator fuel consumption tracking"},{id:"vehicle",name:"Vehicle Trackers",icon:"fas fa-car",color:"purple",count:f.filter(e=>"Vehicle Fuel Consumption"===e.type).length,description:"Vehicle fuel consumption monitoring"},{id:"lpg",name:"LPG Meters",icon:"fas fa-fire",color:"orange",count:f.filter(e=>"LPG Usage"===e.type).length,description:"LPG consumption monitoring"},{id:"renewable",name:"Renewable Energy",icon:"fas fa-solar-panel",color:"teal",count:f.filter(e=>"Renewable Energy Usage"===e.type).length,description:"Renewable energy generation tracking"}],F=e=>{m(Oe({},e)),d(!0)},O=async e=>{f.find(t=>t.id===e)&&await(async e=>{const t=f.find(t=>t.id===e);if(!t)return!1;const a="Active"===t.status?"Inactive":"Active",n="Inactive"===a?"deactivate":"activate";return new Promise(r=>{E("".concat(n.charAt(0).toUpperCase()+n.slice(1)," Meter"),"Are you sure you want to ".concat(n,' the meter "').concat(t.name,'" (').concat(t.type,")?"),async()=>{const s=await D(e,Oe(Oe({},t),{},{status:a}));s&&C("Success","Meter ".concat(n,"d successfully"),"success"),r(s)},()=>r(!1))})})(e)},L=async e=>{const t=f.find(t=>t.id===e);t?t.has_data?C("Cannot Delete",'Cannot delete meter "'.concat(t.name,'" because it has data entries. Please remove all data entries first, or deactivate the meter instead.'),"warning"):E("Delete Meter",'Are you sure you want to permanently delete the meter "'.concat(t.name,'" (').concat(t.type,")?\n\nThis action cannot be undone."),async()=>{try{const a=await ze("".concat(Le,"/api/meters/").concat(e,"/?company_id=").concat(M),{method:"DELETE"});if(a.ok)await T(),C("Success",'Meter "'.concat(t.name,'" has been deleted successfully.'),"success");else{const e=await a.json().catch(()=>({}));C("Delete Failed","Failed to delete meter: ".concat(e.error||e.detail||"Unknown error"),"error")}}catch(a){console.error("Error deleting meter:",a),C("Network Error","Network error occurred while deleting meter. Please try again.","error")}}):C("Error","Meter not found","error")},U=f.filter(e=>{const t=e.name.toLowerCase().includes(h.toLowerCase())||e.type.toLowerCase().includes(h.toLowerCase())||e.location.toLowerCase().includes(h.toLowerCase())||e.id.toLowerCase().includes(h.toLowerCase()),a="All Types"===b||e.type===b,n="All Status"===j||e.status===j;return t&&a&&n}),z=[...new Set(f.map(e=>e.type))];if(!a||!["super_user","admin","site_manager","meter_manager","uploader","viewer"].includes(a.role))return(0,Ue.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,Ue.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access meter management."}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})});const I=["super_user","admin","site_manager","meter_manager"].includes(null===a||void 0===a?void 0:a.role),G=["uploader","viewer"].includes(null===a||void 0===a?void 0:a.role);return g?(0,Ue.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,Ue.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ue.jsx)("i",{className:"fas fa-cog fa-spin text-blue-600 text-2xl"})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Setting Up Your Meters"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Auto-creating meters based on your data requirements..."})]})})}):(0,Ue.jsxs)("div",{className:"max-w-6xl mx-auto",children:[f.some(e=>e.isAutoCreated)&&(0,Ue.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 mb-8",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-magic text-blue-600"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-blue-900",children:"Meters Auto-Created"}),(0,Ue.jsx)("p",{className:"text-blue-700",children:'Based on your checklist requirements, we\'ve automatically created default "Main" meters for all metered data elements. You can customize these or add additional meters as needed.'})]})]})}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:R.filter(e=>e.count>0).map(e=>(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center"),children:(0,Ue.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-lg")})}),(0,Ue.jsx)("span",{className:"text-2xl font-bold text-".concat(e.color,"-600"),children:e.count})]}),(0,Ue.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:e.name}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]},e.id))}),(0,Ue.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-8",children:(0,Ue.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Meter Configuration"}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[G&&(0,Ue.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-2"}),"View Only Mode"]}),I?(0,Ue.jsxs)("button",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-lg font-medium hover:shadow-lg transition-all",onClick:()=>o(!0),children:[(0,Ue.jsx)("i",{className:"fas fa-plus mr-2"}),"Add New Meter"]}):(0,Ue.jsxs)("div",{className:"px-6 py-2 bg-gray-300 text-gray-600 rounded-lg font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-lock mr-2"}),"Read Only Access"]})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6 space-x-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,Ue.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,Ue.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,Ue.jsx)("input",{type:"text",placeholder:"Search meters...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:h,onChange:e=>y(e.target.value)})]}),(0,Ue.jsxs)("select",{className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",value:b,onChange:e=>v(e.target.value),children:[(0,Ue.jsx)("option",{children:"All Types"}),z.map(e=>(0,Ue.jsx)("option",{value:e,children:e},e))]}),(0,Ue.jsxs)("select",{className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",value:j,onChange:e=>w(e.target.value),children:[(0,Ue.jsx)("option",{children:"All Status"}),(0,Ue.jsx)("option",{children:"Active"}),(0,Ue.jsx)("option",{children:"Inactive"}),(0,Ue.jsx)("option",{children:"Warning"}),(0,Ue.jsx)("option",{children:"Maintenance"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("button",{className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 ".concat("list"===N?"bg-blue-50 border-blue-200":""),onClick:()=>k("list"),children:(0,Ue.jsx)("i",{className:"fas fa-list ".concat("list"===N?"text-blue-600":"text-gray-600")})}),(0,Ue.jsx)("button",{className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 ".concat("grid"===N?"bg-blue-50 border-blue-200":""),onClick:()=>k("grid"),children:(0,Ue.jsx)("i",{className:"fas fa-th-large ".concat("grid"===N?"text-blue-600":"text-gray-600")})})]})]}),"grid"===N?(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:U.map(e=>(0,Ue.jsxs)("div",{className:"meter-card bg-gray-50 rounded-lg p-6 border border-gray-200 hover:shadow-md transition-all",children:[(0,Ue.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat("Electricity Consumption"===e.type?"bg-yellow-100":"Water Consumption"===e.type?"bg-cyan-100":"Waste to Landfill"===e.type?"bg-green-100":"Generator Fuel Consumption"===e.type?"bg-red-100":"Vehicle Fuel Consumption"===e.type?"bg-purple-100":"LPG Usage"===e.type?"bg-orange-100":"Renewable Energy Usage"===e.type?"bg-teal-100":"bg-gray-100"),children:(0,Ue.jsx)("i",{className:"".concat("Electricity Consumption"===e.type?"fas fa-bolt text-yellow-600":"Water Consumption"===e.type?"fas fa-tint text-cyan-600":"Waste to Landfill"===e.type?"fas fa-trash-alt text-green-600":"Generator Fuel Consumption"===e.type?"fas fa-gas-pump text-red-600":"Vehicle Fuel Consumption"===e.type?"fas fa-car text-purple-600":"LPG Usage"===e.type?"fas fa-fire text-orange-600":"Renewable Energy Usage"===e.type?"fas fa-solar-panel text-teal-600":"fas fa-gauge text-gray-600")})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("h4",{className:"font-semibold text-gray-900 flex items-center",children:[e.name,e.isAutoCreated&&(0,Ue.jsx)("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Auto"})]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:e.type})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("Active"===e.status?"bg-green-500":"Inactive"===e.status?"bg-red-500":"Warning"===e.status?"bg-yellow-500":"Maintenance"===e.status?"bg-orange-500":"bg-gray-500")}),(0,Ue.jsx)("span",{className:"text-sm font-medium ".concat("Active"===e.status?"text-green-600":"Inactive"===e.status?"text-red-600":"Warning"===e.status?"text-yellow-600":"Maintenance"===e.status?"text-orange-600":"text-gray-600"),children:e.status})]})]}),(0,Ue.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,Ue.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Account #:"}),(0,Ue.jsx)("span",{className:"text-gray-900",children:e.id})]}),(0,Ue.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Location:"}),(0,Ue.jsx)("span",{className:"text-gray-900",children:e.location})]}),(0,Ue.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Last Reading:"}),(0,Ue.jsx)("span",{className:"text-gray-900",children:new Date(e.lastUpdate).toLocaleDateString()})]}),(0,Ue.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Source:"}),(0,Ue.jsx)("span",{className:"text-gray-900",children:e.isAutoCreated?"System":"Manual"})]})]}),(0,Ue.jsx)("div",{className:"flex space-x-2",children:I?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("button",{className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-blue-700",onClick:()=>F(e),children:[(0,Ue.jsx)("i",{className:"fas fa-edit mr-1"}),"Edit"]}),(0,Ue.jsx)("button",{type:"button",className:"py-2 px-3 rounded-lg text-sm ".concat("Active"===e.status?"bg-red-100 text-red-600 hover:bg-red-200":"bg-green-100 text-green-600 hover:bg-green-200"),onClick:t=>{t.preventDefault(),t.stopPropagation(),O(e.id)},title:"Active"===e.status?"Deactivate Meter":"Activate Meter",children:(0,Ue.jsx)("i",{className:"fas ".concat("Active"===e.status?"fa-power-off":"fa-play")})}),(0,Ue.jsx)("button",{type:"button",className:"py-2 px-3 rounded-lg text-sm bg-red-100 text-red-600 hover:bg-red-200",onClick:t=>{t.preventDefault(),t.stopPropagation(),L(e.id)},title:"Delete Meter",children:(0,Ue.jsx)("i",{className:"fas fa-trash"})})]}):(0,Ue.jsxs)("div",{className:"flex-1 bg-gray-100 text-gray-500 py-2 px-3 rounded-lg text-sm font-medium text-center",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only"]})})]},e.id))}):(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"w-full",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Device"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account #"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:U.map(e=>(0,Ue.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center ".concat("Electricity Consumption"===e.type?"bg-yellow-100":"Water Consumption"===e.type?"bg-cyan-100":"Waste to Landfill"===e.type?"bg-green-100":"Generator Fuel Consumption"===e.type?"bg-red-100":"Vehicle Fuel Consumption"===e.type?"bg-purple-100":"LPG Usage"===e.type?"bg-orange-100":"Renewable Energy Usage"===e.type?"bg-teal-100":"bg-gray-100"),children:(0,Ue.jsx)("i",{className:"".concat("Electricity Consumption"===e.type?"fas fa-bolt text-yellow-600":"Water Consumption"===e.type?"fas fa-tint text-cyan-600":"Waste to Landfill"===e.type?"fas fa-trash-alt text-green-600":"Generator Fuel Consumption"===e.type?"fas fa-gas-pump text-red-600":"Vehicle Fuel Consumption"===e.type?"fas fa-car text-purple-600":"LPG Usage"===e.type?"fas fa-fire text-orange-600":"Renewable Energy Usage"===e.type?"fas fa-solar-panel text-teal-600":"fas fa-gauge text-gray-600"," text-sm")})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[e.name,e.isAutoCreated&&(0,Ue.jsx)("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Auto"})]}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:e.id})]})]})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("Electricity Consumption"===e.type?"bg-yellow-100 text-yellow-800":"Water Consumption"===e.type?"bg-cyan-100 text-cyan-800":"Waste to Landfill"===e.type?"bg-green-100 text-green-800":"Generator Fuel Consumption"===e.type?"bg-red-100 text-red-800":"Vehicle Fuel Consumption"===e.type?"bg-purple-100 text-purple-800":"LPG Usage"===e.type?"bg-orange-100 text-orange-800":"Renewable Energy Usage"===e.type?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"),children:e.type})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.location}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("Active"===e.status?"bg-green-500":"Inactive"===e.status?"bg-red-500":"Warning"===e.status?"bg-yellow-500":"Maintenance"===e.status?"bg-orange-500":"bg-gray-500")}),(0,Ue.jsx)("span",{className:"text-sm font-medium ".concat("Active"===e.status?"text-green-600":"Inactive"===e.status?"text-red-600":"Warning"===e.status?"text-yellow-600":"Maintenance"===e.status?"text-orange-600":"text-gray-600"),children:e.status})]})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.account_number||e.id}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.isAutoCreated?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"),children:e.isAutoCreated?"System":"Manual"})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>F(e),children:(0,Ue.jsx)("i",{className:"fas fa-edit"})}),(0,Ue.jsx)("button",{type:"button",className:"".concat("Active"===e.status?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"),onClick:t=>{t.preventDefault(),t.stopPropagation(),O(e.id)},title:"Active"===e.status?"Deactivate Meter":"Activate Meter",children:(0,Ue.jsx)("i",{className:"fas ".concat("Active"===e.status?"fa-power-off":"fa-play")})}),(0,Ue.jsx)("button",{type:"button",className:"text-red-600 hover:text-red-900",onClick:t=>{t.preventDefault(),t.stopPropagation(),L(e.id)},title:"Delete Meter",children:(0,Ue.jsx)("i",{className:"fas fa-trash"})})]})})]},e.id))})]})}),0===U.length&&(0,Ue.jsxs)("div",{className:"text-center py-12",children:[(0,Ue.jsx)("i",{className:"fas fa-search text-gray-400 text-4xl mb-4"}),(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No meters found"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:h||"All Types"!==b||"All Status"!==j?"Try adjusting your search or filters":"No meters have been configured yet"})]})]})}),s&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,Ue.jsx)("div",{className:"bg-white rounded-md p-5 border w-96 shadow-lg mx-4",children:(0,Ue.jsxs)("div",{className:"mt-3",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:s.name}),(0,Ue.jsx)("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>l(null),children:(0,Ue.jsx)("i",{className:"fas fa-times"})})]}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Device ID"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-900",children:s.id})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Type"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-900",children:s.type})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Location"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-900",children:s.location})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Source"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-900",children:s.isAutoCreated?"Auto-created from checklist requirements":"Manually added by user"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Data Points"}),(0,Ue.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:s.dataPoints.map((e,t)=>(0,Ue.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e},t))})]})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,Ue.jsx)("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",onClick:()=>l(null),children:"Close"}),(0,Ue.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Configure"})]})]})})}),i&&(0,Ue.jsx)(Xe,{isOpen:i,title:"Add New Meter",meter:null,meterTypes:R,onSave:async e=>{await A(e)?o(!1):C("Creation Failed","Failed to create meter. Please try again.","error")},onClose:()=>o(!1)}),c&&(0,Ue.jsx)(Xe,{isOpen:c,title:null!==u&&void 0!==u&&null!==(e=u.name)&&void 0!==e&&e.includes("Copy")?"Add Copied Meter":"Edit Meter",meter:u,meterTypes:R,onSave:async e=>{if("string"===typeof e.id&&e.id.startsWith("USER-")&&!f.find(t=>t.id===e.id)){if(!await A(e))return void C("Creation Failed","Failed to create meter. Please try again.","error")}else{if(!await D(e.id,e))return void C("Update Failed","Failed to update meter. Please try again.","error")}d(!1),m(null)},onClose:()=>{d(!1),m(null)}}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-tools text-blue-600"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Installation Guide"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Steps to set up new meters and sensors"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,Ue.jsx)("span",{className:"text-blue-600 font-bold",children:"1"})}),(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Review Requirements"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Check auto-created meters match your needs"})]}),(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,Ue.jsx)("span",{className:"text-blue-600 font-bold",children:"2"})}),(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Configure Details"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Add location and account information"})]}),(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,Ue.jsx)("span",{className:"text-blue-600 font-bold",children:"3"})}),(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Install Device"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Follow manufacturer guidelines for installation"})]}),(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,Ue.jsx)("span",{className:"text-blue-600 font-bold",children:"4"})}),(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Test & Monitor"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Verify readings and establish baselines"})]})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("div",{className:"flex items-center space-x-4",children:(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:()=>t("/list"),children:[(0,Ue.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]})}),(0,Ue.jsxs)("div",{className:"flex space-x-4",children:[(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-download mr-2"}),"Export Configuration"]}),(0,Ue.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-orange-600 to-red-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:()=>{t("/data")},children:["Save & Continue",(0,Ue.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]})]}),S.show&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,Ue.jsx)("div",{className:"bg-white rounded-md p-5 border w-96 shadow-lg mx-4",children:(0,Ue.jsxs)("div",{className:"mt-3",children:[(0,Ue.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center ".concat("success"===S.type?"bg-green-100":"error"===S.type?"bg-red-100":"warning"===S.type?"bg-yellow-100":(S.type,"bg-blue-100")),children:(0,Ue.jsx)("i",{className:"fas ".concat("success"===S.type?"fa-check text-green-600":"error"===S.type?"fa-times text-red-600":"warning"===S.type?"fa-exclamation-triangle text-yellow-600":"confirm"===S.type?"fa-question text-blue-600":"fa-info text-blue-600")})}),(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:S.title})]})}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-6 whitespace-pre-line",children:S.message}),(0,Ue.jsx)("div",{className:"flex justify-end space-x-3",children:"confirm"===S.type?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",onClick:S.onCancel||P,children:"Cancel"}),(0,Ue.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",onClick:S.onConfirm,children:"Confirm"})]}):(0,Ue.jsx)("button",{className:"px-4 py-2 text-white rounded-md hover:opacity-90 ".concat("success"===S.type?"bg-green-600":"error"===S.type?"bg-red-600":"warning"===S.type?"bg-yellow-600":"bg-blue-600"),onClick:S.onConfirm||P,children:"OK"})})]})})})]})},et=()=>{var e;const t=ae(),a=ee(),{user:n,selectedCompany:s}=Ge(),[l,o]=(0,r.useState)(2025),[c,d]=(0,r.useState)(8),[u,m]=(0,r.useState)(""),[f,p]=(0,r.useState)("All"),[g,x]=(0,r.useState)("Category"),[h,y]=(0,r.useState)({}),[b,v]=(0,r.useState)({}),[j,w]=(0,r.useState)({}),[N,k]=(0,r.useState)({}),[S,_]=(0,r.useState)(!0),[C,E]=(0,r.useState)([]),[P,M]=(0,r.useState)([]),[T,A]=(0,r.useState)([]),[D,R]=(0,r.useState)(!1),[F,O]=(0,r.useState)(null),[L,U]=(0,r.useState)(!1),[z,I]=(0,r.useState)(null),[G,W]=(0,r.useState)([]),[V,B]=(0,r.useState)(!1),[q,H]=(0,r.useState)("all"),[Q,$]=(0,r.useState)({annual:{data_progress:0,evidence_progress:0,overall_progress:0,total_points:0,completed_points:0,data_complete:0,evidence_complete:0},monthly:{data_progress:0,evidence_progress:0,overall_progress:0,items_remaining:0,completed_points:0,total_points:0}}),K=null===s||void 0===s?void 0:s.id,Y=(e,t)=>{const a=e.toLowerCase().replace(/[^a-z0-9]/g,""),n=t.filter(e=>{const t=e.name.toLowerCase().replace(/[^a-z0-9]/g,""),n=e.meter_type?e.meter_type.toLowerCase().replace(/[^a-z0-9]/g,""):"",r=t.split(/\s+/).filter(e=>e.length>2),s=n.split(/\s+/).filter(e=>e.length>2),l=r.some(e=>a.includes(e)),i=s.some(e=>a.includes(e));return l||i});return n.length>0?n[0]:null},J=async e=>{try{const t=await ze("".concat(Le,"/api/data-collection/available_months/?year=").concat(e));return(await t.json()).months||[]}catch(t){return console.error("Error fetching available months:",t),[]}},X=async(e,t)=>{try{const a=await ze("".concat(Le,"/api/data-collection/tasks/?company_id=").concat(K,"&year=").concat(e,"&month=").concat(t)),r=await a.json();return console.log("\ud83d\udd0d fetchDataEntries raw API response:",{user_role:null===n||void 0===n?void 0:n.role,data_count:(null===r||void 0===r?void 0:r.length)||0,sample_entry:null===r||void 0===r?void 0:r[0],all_entries:r}),r||[]}catch(a){return console.error("Error fetching data entries:",a),[]}},Z=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const a=t?"".concat(Le,"/api/data-collection/progress/?company_id=").concat(K,"&year=").concat(e,"&month=").concat(t):"".concat(Le,"/api/data-collection/progress/?company_id=").concat(K,"&year=").concat(e),n=await ze(a);return await n.json()}catch(a){return console.error("Error fetching progress:",a),{data_progress:0,evidence_progress:0}}},te=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const n=new FormData;t&&n.append("value",t),a&&n.append("evidence_file",a);return(await ze("".concat(Le,"/api/data-collection/").concat(e,"/"),{method:"PATCH",body:n})).ok}catch(n){return console.error("Error saving data entry:",n),!1}},ne=async(e,t,a,n)=>await Promise.all(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(async(r,s)=>{const l=s+1;let i="upcoming";if(l===n)i="selected";else if(l<a)if(e.includes(l))try{const e=await Z(t,l);i=0===e.items_remaining?"complete":"incomplete"}catch(o){i="incomplete"}else i="upcoming";else l===a?i="current":l>11&&(i="disabled");return{id:l,name:r,status:i,available:e.includes(l)}})),re=e=>{switch(e.status){case"complete":return"bg-green-100 border border-green-300 text-green-700";case"selected":return"bg-blue-100 border-2 border-blue-500 text-blue-700";case"current":return"bg-blue-50 border border-blue-300 text-blue-600";case"incomplete":return"bg-orange-100 border border-orange-300 text-orange-700";case"upcoming":default:return"bg-gray-100 border border-gray-300 text-gray-700";case"disabled":return"bg-gray-200 border border-gray-400 text-gray-500 opacity-50 cursor-not-allowed"}},se=e=>{switch(e){case"complete":return"w-3 h-3 bg-green-500 rounded-full";case"partial":return"w-3 h-3 bg-orange-500 rounded-full";case"missing":return"w-3 h-3 bg-red-500 rounded-full";default:return"w-3 h-3 bg-gray-500 rounded-full"}};(0,r.useEffect)(()=>{(async()=>{if(K){_(!0);try{const e=await J(l),t=new Date,a=await ne(e,l,t.getMonth()+1,c);E(a);const n=await Z(l),r=await Z(l,c);$({annual:{data_progress:n.data_progress||0,evidence_progress:n.evidence_progress||0,overall_progress:n.overall_progress||0,total_points:n.total_points||0,completed_points:n.completed_points||0,data_complete:n.data_complete||0,evidence_complete:n.evidence_complete||0},monthly:{data_progress:r.data_progress||0,evidence_progress:r.evidence_progress||0,overall_progress:r.overall_progress||0,items_remaining:r.items_remaining||0,completed_points:r.completed_points||0,total_points:r.total_points||0}}),console.log("Loading data entries for company:",K,"year:",l,"month:",c);const s=await X(l,c);console.log("Raw entries from API:",s);const i=s.map(e=>({id:e.submission.id,name:e.element_name,meter:e.meter?"".concat(e.meter.name," (").concat(e.meter.type,")"):"N/A",meter_id:e.meter?e.meter.id:null,meter_type:e.meter?e.meter.type:null,meter_location:e.meter?e.meter.location:null,frequency:e.cadence,value:e.submission.value||"",unit:e.element_unit||"",status:e.submission.status||"missing",category:e.type,description:e.element_description||"",evidence_file:e.submission.evidence_file||null,assignedTo:e.submission.assigned_to?"".concat(e.submission.assigned_to.first_name||""," ").concat(e.submission.assigned_to.last_name||"").trim()||e.submission.assigned_to.username||e.submission.assigned_to.email:null,assignedUserId:e.submission.assigned_to?e.submission.assigned_to.id:null,assignedAt:e.submission.assigned_at||null}));console.log("Transformed entries:",i),M(i)}catch(e){console.error("Error loading initial data:",e)}finally{_(!1)}}})()},[l,c,K]),(0,r.useEffect)(()=>{let e=ce(P);"assigned"===q?e=e.filter(e=>e.assignedTo):"unassigned"===q&&(e=e.filter(e=>!e.assignedTo)),A(e)},[u,f,g,P,q]),(0,r.useEffect)(()=>{const e=()=>{K&&(console.log("Window focused - refreshing data entries to include any new meters"),le())};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[K,l,c]),(0,r.useEffect)(()=>{"/data"===a.pathname&&K&&(console.log("Navigated to Data page - refreshing data entries to include any meter changes"),le())},[a.pathname,K,l,c]),(0,r.useEffect)(()=>{if(!K)return;console.log("Setting up periodic refresh every 10 seconds");const e=setInterval(()=>{"/data"===a.pathname&&(console.log("Periodic refresh - checking for meter changes"),le())},1e4);return()=>{console.log("Clearing periodic refresh interval"),clearInterval(e)}},[a.pathname,K,l,c]);const le=async()=>{if(K){console.log("\ud83d\udd04 REFRESH START - Company:",K,"Year:",l,"Month:",c);try{const[e,t,a]=await Promise.all([X(l,c),Z(l),Z(l,c)]);console.log("\ud83d\udcca Raw API responses:"),console.log("- Data entries count:",e.length),console.log("- Annual progress:",t),console.log("- Monthly progress:",a);let r=t,s=a;if(ge){const n=oe(e),l=oe(e);r=Oe(Oe({},t),n),s=Oe(Oe(Oe({},a),l),{},{items_remaining:Math.max(0,l.total_points-l.completed_points)}),console.log("\ud83d\udd27 Meter Manager Progress Override:",{original:a,meter_override:s})}$({annual:r,monthly:s}),console.log("\ud83d\udd04 Transforming entries:",{user_role:null===n||void 0===n?void 0:n.role,entries_count:e.length,entries_with_values:e.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length,entries_with_meters:e.filter(e=>e.meter_id||e.meter).length});const i=e.map(e=>{const t=e.submission.assigned_to;let a=null;if(t){const e=t.first_name||"",n=t.last_name||"";a="".concat(e," ").concat(n).trim()||t.username||t.email}return{id:e.submission.id,name:e.element_name,meter:e.meter?"".concat(e.meter.name," (").concat(e.meter.type,")"):"N/A",meter_id:e.meter?e.meter.id:null,meter_type:e.meter?e.meter.type:null,meter_location:e.meter?e.meter.location:null,frequency:e.cadence,value:e.submission.value||"",unit:e.element_unit||"",status:e.submission.status||"missing",category:e.type,description:e.element_description||"",evidence_file:e.submission.evidence_file||null,assignedTo:a,assignedUserId:t?t.id:null,assignedAt:e.submission.assigned_at||null}});M(i),console.log("\u2705 REFRESH COMPLETE - Found",i.length,"tasks"),console.log("- Raw entries breakdown with assignments:"),e.forEach((e,t)=>{const a=e.submission;console.log("  ".concat(t+1,". ").concat(e.element_name," - Meter: ").concat(e.meter?e.meter.name+" ("+e.meter.type+")":"N/A"," - Status: ").concat((null===a||void 0===a?void 0:a.status)||"missing")),a.assigned_to?console.log("    \u2705 Assignment: ".concat(JSON.stringify(a.assigned_to))):console.log("    \u274c No assignment data"),console.log("    Submission keys: ".concat(Object.keys(a))),null!==a.assigned_to&&void 0!==a.assigned_to||console.log("    Assignment is explicitly null/undefined")}),console.log("- Expected total points (entries * 2):",2*i.length),console.log("- Actual total points from API:",a.total_points),console.log("- Completed points:",a.completed_points),console.log("- Items remaining:",a.items_remaining),console.log("- Progress calculations:"),console.log("  - Data progress:",a.data_progress),console.log("  - Evidence progress:",a.evidence_progress),console.log("  - Overall progress:",a.overall_progress)}catch(e){console.error("\u274c Error refreshing data entries:",e)}}},ie=async(e,t,a)=>{if((t||a)&&!j[e]){w(t=>Oe(Oe({},t),{},{[e]:!0}));try{if(await te(e,t,a)){if(a){const a=await ze("".concat(Le,"/api/data-collection/").concat(e,"/"));if(a.ok){const n=await a.json();M(a=>a.map(a=>a.id===e?Oe(Oe({},a),{},{status:(t||a.value)&&n.evidence_file?"complete":"partial",value:t||a.value,evidence_file:n.evidence_file}):a))}}else M(a=>a.map(a=>a.id===e?Oe(Oe({},a),{},{status:t&&a.evidence_file?"complete":"partial",value:t||a.value}):a));y(t=>{const a=Oe({},t);return delete a[e],a}),v(t=>{const a=Oe({},t);return delete a[e],a}),await de()}}catch(n){console.error("Auto-save error:",n)}finally{w(t=>Oe(Oe({},t),{},{[e]:!1}))}}},oe=e=>{console.log("\ud83d\udd27 Calculating meter manager progress:",{total_entries:e.length,isMeterDataOnly:ge,user_role:null===n||void 0===n?void 0:n.role});const t=e.filter(e=>null!==e.meter_id),a=t.length;if(console.log("\ud83d\udcca Metered entries found:",{metered_count:a,total_points_should_be:2*a,metered_entries:t.map(e=>({name:e.name,meter_id:e.meter_id,has_value:null!==e.value&&""!==e.value,has_evidence:!!e.evidence_file}))}),0===a)return{data_progress:0,evidence_progress:0,overall_progress:0,completed_points:0,total_points:0,data_complete:0,evidence_complete:0};const r=t.filter(e=>null!==e.value&&""!==e.value).length,s=t.filter(e=>e.evidence_file).length,l={data_progress:r/a*100,evidence_progress:s/a*100,overall_progress:(r+s)/(2*a)*100,completed_points:r+s,total_points:2*a,data_complete:r,evidence_complete:s};return console.log("\u2705 Meter manager progress calculated:",l),l},ce=e=>{let t=[...e];return ge&&(t=t.filter(e=>null!==e.meter_id)),u.trim()&&(t=t.filter(e=>e.name.toLowerCase().includes(u.toLowerCase())||e.meter.toLowerCase().includes(u.toLowerCase())||e.category.toLowerCase().includes(u.toLowerCase()))),"Metered"===f?t=t.filter(e=>null!==e.meter_id):"Non-metered"===f?t=t.filter(e=>null===e.meter_id):"Missing"===f?t=t.filter(e=>"missing"===e.status):"Partial"===f?t=t.filter(e=>"partial"===e.status):"Complete"===f&&(t=t.filter(e=>"complete"===e.status)),t},de=async()=>{try{const e=await Z(l),t=await Z(l,c);let a={data_progress:e.data_progress||0,evidence_progress:e.evidence_progress||0,overall_progress:e.overall_progress||0,total_points:e.total_points||0,completed_points:e.completed_points||0,data_complete:e.data_complete||0,evidence_complete:e.evidence_complete||0},n={data_progress:t.data_progress||0,evidence_progress:t.evidence_progress||0,overall_progress:t.overall_progress||0,items_remaining:t.items_remaining||0,completed_points:t.completed_points||0,total_points:t.total_points||0};if(ge&&P.length>0){const e=oe(P);a=Oe(Oe({},a),e),n=Oe(Oe(Oe({},n),e),{},{items_remaining:Math.max(0,e.total_points-e.completed_points)}),console.log("\ud83d\udd27 Meter Manager Progress Refresh:",{entries_count:P.length,metered_count:P.filter(e=>null!==e.meter_id).length,progress:e})}$({annual:a,monthly:n});const r=await J(l),s=new Date,i=await ne(r,l,s.getMonth()+1,c);E(i)}catch(e){console.error("Error refreshing progress data:",e)}};if(!n||!["super_user","admin","site_manager","uploader","viewer","meter_manager"].includes(n.role))return(0,Ue.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,Ue.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access data collection."}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})});const ue=["super_user","admin"].includes(null===n||void 0===n?void 0:n.role),me=["site_manager"].includes(null===n||void 0===n?void 0:n.role),fe=["uploader"].includes(null===n||void 0===n?void 0:n.role),pe=["viewer"].includes(null===n||void 0===n?void 0:n.role),ge=["meter_manager"].includes(null===n||void 0===n?void 0:n.role),xe=["super_user"].includes(null===n||void 0===n?void 0:n.role),he=["admin"].includes(null===n||void 0===n?void 0:n.role),ye=["site_manager"].includes(null===n||void 0===n?void 0:n.role),be=(["uploader","viewer","meter_manager"].includes(null===n||void 0===n?void 0:n.role),e=>{I(e),U(!0),(async()=>{if(K&&n){B(!0);try{const e=await ze("".concat(Le,"/api/users/"));if(e.ok){const t=await e.json();let a=t.filter(e=>"viewer"!==e.role);ye&&(a=t.filter(e=>["uploader","meter_manager"].includes(e.role))),console.log("Available users for assignment:",a),W(a)}else console.error("Failed to fetch available users, status:",e.status)}catch(e){console.error("Error fetching available users:",e)}finally{B(!1)}}})()});return S?(0,Ue.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,Ue.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading data collection interface..."})]})}):(0,Ue.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Reporting Period"}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Year"}),(0,Ue.jsxs)("select",{className:"border border-gray-300 rounded-lg px-4 py-2 w-32",value:l,onChange:e=>o(parseInt(e.target.value)),children:[(0,Ue.jsx)("option",{value:2025,children:"2025"}),(0,Ue.jsx)("option",{value:2024,children:"2024"}),(0,Ue.jsx)("option",{value:2023,children:"2023"}),(0,Ue.jsx)("option",{value:2022,children:"2022"})]})]}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Month"}),(0,Ue.jsx)("div",{className:"grid grid-cols-6 gap-2",children:C.map(e=>(0,Ue.jsx)("button",{className:"px-3 py-2 rounded-lg text-sm font-medium ".concat(re(e)),onClick:()=>"disabled"!==e.status&&(async e=>{if(e!==c){d(e),_(!0);try{const t=await J(l),a=new Date,n=await ne(t,l,a.getMonth()+1,e);E(n);const r=(await X(l,e)).map(e=>({id:e.submission.id,name:e.element_name,meter:e.meter?"".concat(e.meter.name," (").concat(e.meter.type,")"):"N/A",meter_id:e.meter?e.meter.id:null,meter_type:e.meter?e.meter.type:null,meter_location:e.meter?e.meter.location:null,frequency:e.cadence,value:e.submission.value||"",unit:e.element_unit||"",status:e.submission.status||"missing",category:e.type,description:e.element_description||"",evidence_file:e.submission.evidence_file||null,assignedTo:e.submission.assigned_to?"".concat(e.submission.assigned_to.first_name||""," ").concat(e.submission.assigned_to.last_name||"").trim()||e.submission.assigned_to.username||e.submission.assigned_to.email:null,assignedUserId:e.submission.assigned_to?e.submission.assigned_to.id:null,assignedAt:e.submission.assigned_at||null}));M(r);const s=await Z(l,e);$(e=>Oe(Oe({},e),{},{monthly:{data_progress:s.data_progress||0,evidence_progress:s.evidence_progress||0,overall_progress:s.overall_progress||0,items_remaining:s.items_remaining||0,completed_points:s.completed_points||0,total_points:s.total_points||0}}))}catch(t){console.error("Error loading month data:",t)}finally{_(!1)}}})(e.id),disabled:"disabled"===e.status,children:e.name},e.id))})]})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:["Annual Progress (",l,")"]}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Data Entry Progress"}),(0,Ue.jsxs)("span",{className:"text-sm font-bold text-blue-600",children:[ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,a=e.length>0?t/e.length*100:0;return Math.round(a)})():Math.round(Q.annual.data_progress),"%"]})]}),(0,Ue.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,Ue.jsx)("div",{className:"bg-blue-500 h-3 rounded-full",style:{width:"".concat(ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length;return e.length>0?t/e.length*100:0})():Q.annual.data_progress,"%")}})})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Evidence Upload"}),(0,Ue.jsxs)("span",{className:"text-sm font-bold text-green-600",children:[ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>e.evidence_file).length,a=e.length>0?t/e.length*100:0;return Math.round(a)})():Math.round(Q.annual.evidence_progress),"%"]})]}),(0,Ue.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,Ue.jsx)("div",{className:"bg-green-500 h-3 rounded-full",style:{width:"".concat(ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>e.evidence_file).length;return e.length>0?t/e.length*100:0})():Q.annual.evidence_progress,"%")}})})]}),(0,Ue.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Overall Progress"}),(0,Ue.jsxs)("span",{className:"text-sm font-bold text-indigo-600",children:[ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,a=e.filter(e=>e.evidence_file).length,n=e.length>0?(t+a)/(2*e.length)*100:0;return Math.round(n)})():Math.round(Q.annual.overall_progress||0),"%"]})]}),(0,Ue.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4",children:(0,Ue.jsx)("div",{className:"bg-indigo-500 h-4 rounded-full",style:{width:"".concat(ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,a=e.filter(e=>e.evidence_file).length;return e.length>0?(t+a)/(2*e.length)*100:0})():Q.annual.overall_progress||0,"%")}})})]}),(0,Ue.jsxs)("div",{className:"pt-4 border-t border-gray-200 text-center",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length+e.filter(e=>e.evidence_file).length,a=2*e.length;return"".concat(t," / ").concat(a)})():"".concat(Q.annual.completed_points||0," / ").concat(Q.annual.total_points||0)}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:["Tasks Completed (Data + Evidence)",ge&&(0,Ue.jsx)("span",{className:"text-purple-600 ml-2",children:"\ud83d\udcca Metered Only"})]}),(0,Ue.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,a=e.filter(e=>e.evidence_file).length;return"Data Entries: ".concat(t," | Evidence Files: ").concat(a)})():"Data Entries: ".concat(Q.annual.data_complete||0," | Evidence Files: ").concat(Q.annual.evidence_complete||0)})]})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:[null===(e=C.find(e=>e.id===c))||void 0===e?void 0:e.name," ",l," Progress"]}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Data Entry Progress"}),(0,Ue.jsxs)("span",{className:"text-sm font-bold text-orange-600",children:[ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length;return e.length>0?Math.round(t/e.length*100):0})():Math.round(Q.monthly.data_progress||0),"%"]})]}),(0,Ue.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,Ue.jsx)("div",{className:"bg-orange-500 h-3 rounded-full",style:{width:"".concat(Math.min(100,Math.max(0,ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length;return e.length>0?t/e.length*100:0})():Q.monthly.data_progress||0)),"%")}})})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Evidence Upload"}),(0,Ue.jsxs)("span",{className:"text-sm font-bold text-purple-600",children:[ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>e.evidence_file).length;return e.length>0?Math.round(t/e.length*100):0})():Math.round(Q.monthly.evidence_progress||0),"%"]})]}),(0,Ue.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,Ue.jsx)("div",{className:"bg-purple-500 h-3 rounded-full",style:{width:"".concat(Math.min(100,Math.max(0,ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>e.evidence_file).length;return e.length>0?t/e.length*100:0})():Q.monthly.evidence_progress||0)),"%")}})})]}),(0,Ue.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Overall Progress"}),(0,Ue.jsxs)("span",{className:"text-sm font-bold text-indigo-600",children:[ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,a=e.filter(e=>e.evidence_file).length;return e.length>0?Math.round((t+a)/(2*e.length)*100):0})():Math.round(Q.monthly.overall_progress||0),"%"]})]}),(0,Ue.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4",children:(0,Ue.jsx)("div",{className:"bg-indigo-500 h-4 rounded-full",style:{width:"".concat(Math.min(100,Math.max(0,ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,a=e.filter(e=>e.evidence_file).length;return e.length>0?(t+a)/(2*e.length)*100:0})():Q.monthly.overall_progress||0)),"%")}})})]}),(0,Ue.jsxs)("div",{className:"pt-4 border-t border-gray-200 text-center",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length+e.filter(e=>e.evidence_file).length,a=2*e.length;return"".concat(t," / ").concat(a)})():"".concat(Q.monthly.completed_points||0," / ").concat(Q.monthly.total_points||0)}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:["Tasks Completed This Month",ge&&(0,Ue.jsx)("span",{className:"text-purple-600 ml-2",children:"\ud83d\udcca Metered Only"})]}),(0,Ue.jsx)("div",{className:"text-xs text-red-500 mt-1",children:ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length+e.filter(e=>e.evidence_file).length,a=2*e.length;return"".concat(a-t," Tasks Remaining")})():"".concat(Q.monthly.items_remaining||0," Tasks Remaining")}),(0,Ue.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:ge?(()=>{const e=P.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,a=e.filter(e=>e.evidence_file).length;return"Data Entries: ".concat(t," | Evidence Files: ").concat(a)})():"Data Entries: ".concat(Q.monthly.data_complete||0," | Evidence Files: ").concat(Q.monthly.evidence_complete||0)})]})]})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-8",children:[(0,Ue.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Data Entry Interface"}),pe&&(0,Ue.jsxs)("div",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only"]}),fe&&(0,Ue.jsxs)("div",{className:"px-3 py-1 bg-yellow-50 text-yellow-700 rounded-lg text-sm font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-tasks mr-1"}),"Assigned Tasks Only"]}),me&&(0,Ue.jsxs)("div",{className:"px-3 py-1 bg-orange-50 text-orange-700 rounded-lg text-sm font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-clipboard-check mr-1"}),"Review Mode"]}),ge&&(0,Ue.jsxs)("div",{className:"px-3 py-1 bg-purple-50 text-purple-700 rounded-lg text-sm font-medium",children:[(0,Ue.jsx)("i",{className:"fas fa-gauge mr-1"}),"Meter Data Only"]})]}),(0,Ue.jsxs)("div",{className:"flex space-x-3",children:[(0,Ue.jsxs)("button",{className:"bg-orange-100 text-orange-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-orange-200",onClick:le,title:"Refresh data to check for new meters or tasks",children:[(0,Ue.jsx)("i",{className:"fas fa-sync-alt mr-2"}),"Refresh"]}),(ue||fe)&&(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx",onChange:e=>(async e=>{R(!0);const t={successful:[],failed:[],unmatched:[]};try{for(let n of e){const e=Y(n.name,P);if(e)try{await te(e.id,null,n)?(t.successful.push({filename:n.name,entryName:e.name,entryId:e.id}),M(t=>t.map(t=>t.id===e.id?Oe(Oe({},t),{},{status:t.value?"complete":"partial",evidence_file:URL.createObjectURL(n)}):t))):t.failed.push({filename:n.name,reason:"Upload failed"})}catch(a){t.failed.push({filename:n.name,reason:a.message})}else t.unmatched.push(n.name)}await de(),O(t)}catch(a){console.error("Bulk upload error:",a)}finally{R(!1)}})(Array.from(e.target.files)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",id:"multiple-file-upload"}),(0,Ue.jsxs)("button",{className:"bg-blue-100 text-blue-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-200 ".concat(D?"opacity-50 cursor-not-allowed":""),disabled:D,children:[(0,Ue.jsx)("i",{className:"fas ".concat(D?"fa-spinner fa-spin":"fa-upload"," mr-2")}),D?"Uploading...":"Upload Multiple Files"]})]}),(pe||me||ge)&&(0,Ue.jsxs)("button",{className:"bg-green-100 text-green-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-200",onClick:()=>{},children:[(0,Ue.jsx)("i",{className:"fas fa-download mr-2"}),"Export Data"]})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"View by:"}),(0,Ue.jsxs)("select",{className:"border border-gray-300 rounded-lg px-3 py-1 text-sm",value:f,onChange:e=>p(e.target.value),children:[(0,Ue.jsx)("option",{children:"All Items"}),(0,Ue.jsx)("option",{children:"Metered"}),(0,Ue.jsx)("option",{children:"Non-metered"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Group by:"}),(0,Ue.jsxs)("select",{className:"border border-gray-300 rounded-lg px-3 py-1 text-sm",value:g,onChange:e=>x(e.target.value),children:[(0,Ue.jsx)("option",{children:"Category"}),(0,Ue.jsx)("option",{children:"Frequency"}),(0,Ue.jsx)("option",{children:"Status"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Assignment:"}),(0,Ue.jsxs)("select",{className:"border border-gray-300 rounded-lg px-3 py-1 text-sm",value:q,onChange:e=>H(e.target.value),children:[(0,Ue.jsx)("option",{value:"all",children:"All Tasks"}),(0,Ue.jsx)("option",{value:"assigned",children:"Assigned"}),(0,Ue.jsx)("option",{value:"unassigned",children:"Unassigned"})]})]}),(0,Ue.jsx)("div",{className:"flex-1",children:(0,Ue.jsx)("input",{type:"text",placeholder:"Search data elements...",className:"w-full border border-gray-300 rounded-lg px-3 py-1 text-sm",value:u,onChange:e=>m(e.target.value)})})]})]}),(0,Ue.jsx)("div",{className:"p-6",children:0===P.length?(0,Ue.jsxs)("div",{className:"text-center py-12",children:[(0,Ue.jsx)("i",{className:"fas fa-gauge text-gray-400 text-4xl mb-4"}),(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No data entries found"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Data entries are generated based on your configured meters and checklist requirements."}),(0,Ue.jsxs)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",onClick:()=>t("/meter"),children:[(0,Ue.jsx)("i",{className:"fas fa-cog mr-2"}),"Configure Meters"]})]}):0===T.length?(0,Ue.jsxs)("div",{className:"text-center py-12",children:[(0,Ue.jsx)("i",{className:"fas fa-search text-gray-400 text-4xl mb-4"}),(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No matching entries found"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search terms or filters to find data entries."})]}):(0,Ue.jsx)("div",{className:"space-y-6",children:(()=>{const e=(t=T,"Category"===g?t.reduce((e,t)=>{const a=t.category||"Other";return e[a]||(e[a]=[]),e[a].push(t),e},{}):"Frequency"===g?t.reduce((e,t)=>{const a=t.frequency||"Unknown";return e[a]||(e[a]=[]),e[a].push(t),e},{}):"Status"===g?t.reduce((e,t)=>{const a=t.status||"missing",n="complete"===a?"Complete":"partial"===a?"Partial":"Missing";return e[n]||(e[n]=[]),e[n].push(t),e},{}):{"All Items":t});var t;return Object.entries(e).map(t=>{let[a,n]=t;return(0,Ue.jsxs)("div",{children:[Object.keys(e).length>1&&(0,Ue.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ue.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mr-3",children:a}),(0,Ue.jsx)("div",{className:"flex-1 h-px bg-gray-200"}),(0,Ue.jsxs)("span",{className:"ml-3 text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[n.length," ",1===n.length?"item":"items"]})]}),(0,Ue.jsx)("div",{className:"space-y-4",children:n.map(e=>(0,Ue.jsxs)("div",{className:"rounded-xl shadow-sm hover:shadow-md transition-shadow duration-200 ".concat("complete"===e.status?"bg-green-50 border border-green-200":"partial"===e.status?"bg-orange-50 border border-orange-200":"missing"===e.status?"bg-red-50 border border-red-200":"bg-gray-50 border border-gray-200"),children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:se(e.status)}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"font-semibold text-gray-900",children:e.name}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[e.meter_id&&(0,Ue.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:[(0,Ue.jsx)("i",{className:"fas fa-gauge mr-1"}),e.meter.split(" (")[0]," (",e.meter_type,")"]}),(0,Ue.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700",children:e.frequency}),e.meter_location&&(0,Ue.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-purple-100 text-purple-800",children:e.meter_location})]})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(xe||he||ye)&&(0,Ue.jsxs)("div",{className:"flex items-center space-x-2 text-xs",children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:e.assignedTo?"Assigned: ".concat(e.assignedTo):"Unassigned"}),(0,Ue.jsxs)("button",{className:"px-2 py-1 bg-blue-50 text-blue-600 rounded text-xs font-medium hover:bg-blue-100",onClick:()=>be(e),children:[(0,Ue.jsx)("i",{className:"fas fa-user-plus mr-1"}),e.assignedTo?"Reassign":"Assign"]})]}),(0,Ue.jsx)("div",{className:"flex items-center space-x-2",children:j[e.id]?(0,Ue.jsxs)("div",{className:"flex items-center text-sm text-blue-600",children:[(0,Ue.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),(0,Ue.jsx)("span",{className:"text-xs",children:"Auto-saving..."})]}):"complete"===e.status?(0,Ue.jsxs)("div",{className:"flex items-center text-sm text-green-600",children:[(0,Ue.jsx)("i",{className:"fas fa-check mr-1"}),(0,Ue.jsx)("span",{className:"text-xs",children:"Complete"})]}):"partial"===e.status?(0,Ue.jsxs)("div",{className:"flex items-center text-sm text-orange-600",children:[(0,Ue.jsx)("i",{className:"fas fa-clock mr-1"}),(0,Ue.jsx)("span",{className:"text-xs",children:"Partial"})]}):(0,Ue.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,Ue.jsx)("i",{className:"fas fa-circle mr-1"}),(0,Ue.jsx)("span",{className:"text-xs",children:"Missing"})]})})]})]}),(0,Ue.jsxs)("div",{className:"flex",children:[(0,Ue.jsx)("div",{className:"flex-1 p-4 pr-2",style:{width:"50%"},children:(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,Ue.jsx)("i",{className:"fas fa-chart-line text-blue-500 text-sm"}),(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Data Entry"})]}),(0,Ue.jsx)("div",{className:"flex items-center space-x-3",children:(0,Ue.jsxs)("div",{className:"relative flex-1",children:[!(ue||fe||me)||pe||ge?(0,Ue.jsx)("div",{className:"w-full bg-gray-100 border border-gray-200 rounded-lg px-4 py-3 text-lg font-medium text-gray-500",children:void 0!==h[e.id]?h[e.id]:e.value||"0"}):(0,Ue.jsx)("input",{type:"number",value:void 0!==h[e.id]?h[e.id]:e.value||"",onChange:t=>((e,t)=>{y(a=>Oe(Oe({},a),{},{[e]:t})),N[e]&&clearTimeout(N[e]);const a=setTimeout(()=>{ie(e,t,b[e])},1500);k(t=>Oe(Oe({},t),{},{[e]:a}))})(e.id,t.target.value),className:"w-full bg-gray-50 border border-gray-200 rounded-lg px-4 py-3 text-lg font-medium focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"0"}),(0,Ue.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-sm font-medium text-gray-500 bg-white px-2 rounded",children:e.unit}),(pe||ge)&&(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,Ue.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,Ue.jsx)("i",{className:"fas fa-eye"})})})]})})]})}),(0,Ue.jsx)("div",{className:"w-px bg-gray-200"}),(0,Ue.jsx)("div",{className:"p-4 pl-2",style:{width:"50%"},children:(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("i",{className:"fas fa-paperclip text-purple-500 text-sm"}),(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Evidence"})]}),e.evidence_file&&(0,Ue.jsx)("button",{onClick:()=>(async e=>{v(t=>{const a=Oe({},t);return delete a[e],a}),w(t=>Oe(Oe({},t),{},{[e]:!0}));try{const t=new FormData;t.append("remove_evidence","true"),(await ze("".concat(Le,"/api/data-collection/").concat(e,"/"),{method:"PATCH",body:t})).ok&&(M(t=>t.map(t=>t.id===e?Oe(Oe({},t),{},{status:t.value?"partial":"missing",evidence_file:null}):t)),await de())}catch(t){console.error("Error clearing file:",t)}finally{w(t=>Oe(Oe({},t),{},{[e]:!1}))}})(e.id),className:"p-1 text-red-500 hover:bg-red-50 rounded text-xs",title:"Remove file",children:(0,Ue.jsx)("i",{className:"fas fa-trash"})})]}),(0,Ue.jsx)("div",{className:"relative",children:!(ue||fe||me)||pe||ge?(0,Ue.jsx)("div",{className:"border-2 border-gray-200 rounded-lg p-3 text-center bg-gray-50",children:e.evidence_file?(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsx)("i",{className:"fas fa-file-alt text-gray-400 text-lg"}),(0,Ue.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.evidence_file.split("/").pop()}),(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:"View only"})]}):(0,Ue.jsxs)("div",{className:"space-y-1",children:[(0,Ue.jsx)("i",{className:"fas fa-file text-gray-400 text-lg"}),(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:"No evidence uploaded"})]})}):(0,Ue.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-3 text-center hover:border-blue-400 hover:bg-blue-50 transition-colors duration-200 cursor-pointer",children:[(0,Ue.jsx)("input",{type:"file",onChange:t=>{return a=e.id,n=t.target.files[0],v(e=>Oe(Oe({},e),{},{[a]:n})),void ie(a,h[a],n);var a,n},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx"}),e.evidence_file?(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsx)("i",{className:"fas fa-file-alt text-green-500 text-lg"}),(0,Ue.jsx)("div",{className:"text-xs text-gray-600 truncate",children:e.evidence_file.split("/").pop()}),(0,Ue.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"File uploaded"})]}):(0,Ue.jsxs)("div",{className:"space-y-1",children:[(0,Ue.jsx)("i",{className:"fas fa-upload text-gray-400 text-lg"}),(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:"Drop file or click"})]})]})})]})})]})]},e.id))})]},a)})})()})})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("div",{className:"flex items-center space-x-4",children:(0,Ue.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:()=>t("/meter"),children:[(0,Ue.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]})}),(0,Ue.jsx)("div",{className:"flex space-x-4",children:(0,Ue.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-red-600 to-pink-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:()=>{t("/dashboard")},children:["Complete Setup",(0,Ue.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})})]}),F&&(0,i.createPortal)((0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Upload Results"}),(0,Ue.jsx)("button",{onClick:()=>O(null),className:"text-gray-400 hover:text-gray-600",children:(0,Ue.jsx)("i",{className:"fas fa-times"})})]}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[F.successful.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("h4",{className:"text-sm font-medium text-green-600 mb-2",children:["\u2705 Successfully Uploaded (",F.successful.length,")"]}),(0,Ue.jsx)("div",{className:"space-y-1",children:F.successful.map((e,t)=>(0,Ue.jsxs)("div",{className:"text-xs text-gray-600 bg-green-50 p-2 rounded",children:[(0,Ue.jsx)("div",{className:"font-medium",children:e.filename}),(0,Ue.jsxs)("div",{children:["\u2192 ",e.entryName]})]},t))})]}),F.unmatched.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("h4",{className:"text-sm font-medium text-yellow-600 mb-2",children:["\u26a0\ufe0f No Match Found (",F.unmatched.length,")"]}),(0,Ue.jsx)("div",{className:"space-y-1",children:F.unmatched.map((e,t)=>(0,Ue.jsx)("div",{className:"text-xs text-gray-600 bg-yellow-50 p-2 rounded",children:e},t))})]}),F.failed.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("h4",{className:"text-sm font-medium text-red-600 mb-2",children:["\u274c Failed Uploads (",F.failed.length,")"]}),(0,Ue.jsx)("div",{className:"space-y-1",children:F.failed.map((e,t)=>(0,Ue.jsxs)("div",{className:"text-xs text-gray-600 bg-red-50 p-2 rounded",children:[(0,Ue.jsx)("div",{className:"font-medium",children:e.filename}),(0,Ue.jsxs)("div",{children:["Error: ",e.reason]})]},t))})]})]}),(0,Ue.jsx)("div",{className:"mt-6 flex justify-end",children:(0,Ue.jsx)("button",{onClick:()=>O(null),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Close"})})]})}),document.body),L&&z&&(0,i.createPortal)((0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 max-h-96 overflow-y-auto",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Assign Task"}),(0,Ue.jsx)("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>{U(!1),I(null)},children:(0,Ue.jsx)("i",{className:"fas fa-times"})})]}),(0,Ue.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:z.name}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:z.description}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,Ue.jsxs)("span",{children:["Unit: ",z.unit]}),(0,Ue.jsxs)("span",{children:["Frequency: ",z.frequency]}),z.meter&&(0,Ue.jsxs)("span",{children:["Meter: ",z.meter]})]})]}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select User to Assign:"}),V?(0,Ue.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,Ue.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Loading users..."})]}):0===G.length?(0,Ue.jsx)("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No users available for assignment"}):(0,Ue.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:G.map(e=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>(async(e,t)=>{try{const a=await ze("".concat(Le,"/api/data-collection/assign-task/"),{method:"POST",body:JSON.stringify({task_id:t,assigned_user_id:e})});if(a.ok){const n=await a.json();console.log("Assignment response:",n);const r=G.find(t=>t.id===e),s=r?"".concat(r.first_name||""," ").concat(r.last_name||"").trim()||r.name||r.email:"Unknown User";console.log("Updating entry with assignment:",{taskId:t,assignedName:s,userId:e}),M(a=>a.map(a=>a.id===t?Oe(Oe({},a),{},{assignedTo:s,assignedUserId:e}):a)),U(!1),I(null),console.log("Task assigned successfully to:",s),le()}else{console.error("Failed to assign task, status:",a.status);const e=await a.text();console.error("Error response:",e)}}catch(a){console.error("Error assigning task:",a)}})(e.id,z.id),children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-user text-blue-600 text-sm"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,Ue.jsxs)("div",{className:"text-xs text-gray-500",children:[e.role," \u2022 ",e.email]})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[e.sites&&e.sites.length>0&&(0,Ue.jsxs)("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:[e.sites.length," site",e.sites.length>1?"s":""]}),(0,Ue.jsx)("i",{className:"fas fa-chevron-right text-gray-400 text-xs"})]})]},e.id))})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[(0,Ue.jsxs)("div",{className:"text-xs text-gray-500",children:[xe&&"System-wide assignment",he&&"Company-wide assignment",ye&&"Site-level assignment (Uploaders only)"]}),(0,Ue.jsx)("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm font-medium",onClick:()=>{U(!1),I(null)},children:"Cancel"})]})]})}),document.body)]})},tt=e=>{let{user:t,companies:a=[]}=e;return(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"System Overview"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-building text-blue-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Total Companies"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:a.length})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-users text-green-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Active Users"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"24"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-chart-line text-orange-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Data Points"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"1,247"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-shield-alt text-purple-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Compliance Rate"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"94%"})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Company Performance Comparison"}),(0,Ue.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,Ue.jsx)("i",{className:"fas fa-chart-bar text-4xl mb-4"}),(0,Ue.jsx)("p",{children:"Cross-company analytics dashboard coming soon"})]})]})]})},at=e=>{let{user:t,selectedCompany:a,sites:n=[]}=e;return(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:["Company Overview - ",(null===a||void 0===a?void 0:a.name)||"Select Company"]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-map-marker-alt text-blue-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Active Sites"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:n.length})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-tasks text-green-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Data Completion"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"78%"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-exclamation-triangle text-orange-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Pending Tasks"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"12"})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Site Comparison"}),(0,Ue.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,Ue.jsx)("i",{className:"fas fa-building text-4xl mb-4"}),(0,Ue.jsx)("p",{children:"Site performance comparison dashboard coming soon"})]})]})]})},nt=e=>{let{user:t,selectedSite:a}=e;return(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:["Site Metrics - ",(null===a||void 0===a?void 0:a.name)||"Select Site"]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-users text-blue-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Team Members"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"8"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-chart-line text-green-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Site Performance"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"85%"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-clock text-orange-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Avg Response Time"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"2.3 days"})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Team Performance"}),(0,Ue.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,Ue.jsx)("i",{className:"fas fa-chart-pie text-4xl mb-4"}),(0,Ue.jsx)("p",{children:"Team performance metrics coming soon"})]})]})]})},rt=e=>{let{user:t}=e;return(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"My Tasks"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-exclamation-circle text-red-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Pending Tasks"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"5"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-check-circle text-green-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Completed"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"23"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-percentage text-blue-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Progress"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"82%"})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Task Queue"}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-bolt text-red-600 text-sm"})}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-800",children:"Electricity Data - December"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Due: Tomorrow"})]})]}),(0,Ue.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Start"})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-tint text-blue-600 text-sm"})}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-800",children:"Water Usage Data"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Due: In 3 days"})]})]}),(0,Ue.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Start"})]})]})]})]})},st=e=>{let{user:t}=e;return(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Compliance Overview"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-check-circle text-green-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Compliance Rate"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"94%"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-file-alt text-blue-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Reports Available"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"12"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-calendar text-orange-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Last Updated"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"2 days ago"})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Report Shortcuts"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsx)("button",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-download text-blue-600 text-lg mr-3"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-800",children:"Monthly ESG Report"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"December 2024"})]})]})}),(0,Ue.jsx)("button",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-chart-pie text-green-600 text-lg mr-3"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-800",children:"Compliance Summary"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Q4 2024"})]})]})})]})]})]})},lt=e=>{let{user:t}=e;return(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Meter Management"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-tachometer-alt text-green-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Active Meters"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"15"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-exclamation-triangle text-red-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Needs Maintenance"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"3"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-calendar-check text-orange-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Due This Week"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"2"})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-wrench text-blue-600 text-xl"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Health Score"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:"87%"})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Maintenance Schedule"}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-4 border border-red-200 bg-red-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-bolt text-red-600 text-sm"})}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-800",children:"Electricity Meter #3"}),(0,Ue.jsx)("p",{className:"text-sm text-red-600",children:"Overdue - 2 days"})]})]}),(0,Ue.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Schedule"})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-4 border border-orange-200 bg-orange-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-tint text-orange-600 text-sm"})}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-800",children:"Water Meter #1"}),(0,Ue.jsx)("p",{className:"text-sm text-orange-600",children:"Due tomorrow"})]})]}),(0,Ue.jsx)("button",{className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Schedule"})]})]})]})]})},it=()=>{ae();const{user:e,selectedCompany:t,userSites:a,selectedSite:n,companies:s}=Ge(),[l,i]=(0,r.useState)("This Month"),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(!0),[m,f]=(0,r.useState)(null),[p,g]=(0,r.useState)(0),[x,h]=(0,r.useState)("Scope 2"),[y,b]=(0,r.useState)({isOpen:!1,type:"",data:{}}),[v,j]=(0,r.useState)(!1),w=null===t||void 0===t?void 0:t.id,N=async()=>{if(!w)return console.log("No company selected, skipping dashboard data fetch"),null;try{const[e,t,a]=await Promise.all([fetch("".concat(Le,"/api/dashboard/?company_id=").concat(w),{credentials:"include"}),fetch("".concat(Le,"/api/companies/").concat(w,"/progress/"),{credentials:"include"}),fetch("".concat(Le,"/api/companies/").concat(w,"/frameworks/"),{credentials:"include"})]),n=await e.json(),r=await t.json(),s=await a.json();return Oe(Oe({},n),{},{progress:r,frameworks:Array.isArray(s)?s:s.results||[]})}catch(e){return console.error("Error fetching dashboard data:",e),null}},k=async()=>{if(!w)return console.log("No company selected, skipping chart data fetch"),{meters:[],dataEntries:[]};try{const[e,t]=await Promise.all([fetch("".concat(Le,"/api/meters/?company_id=").concat(w),{credentials:"include"}),fetch("".concat(Le,"/api/data-collection/tasks/?company_id=").concat(w,"&year=2025&month=8"),{credentials:"include"})]),a=await e.json(),n=await t.json();return{meters:a.results||a,dataEntries:n||[]}}catch(e){return console.error("Error fetching chart data:",e),{meters:[],dataEntries:[]}}};(0,r.useEffect)(()=>{(async()=>{u(!0);try{const[e,t]=await Promise.all([N(),k()]);c(e),f(t)}catch(e){console.error("Error loading dashboard:",e),c(null),f(null)}finally{u(!1)}})()},[w,l]);const S=(0,r.useCallback)(e=>{m&&m.meters&&g("next"===e?e=>(e+1)%m.meters.length:e=>(e-1+m.meters.length)%m.meters.length)},[m]);(0,r.useEffect)(()=>{const e=e=>{!m||!m.meters||m.meters.length<=1||("ArrowLeft"===e.key?(e.preventDefault(),S("prev")):"ArrowRight"===e.key&&(e.preventDefault(),S("next")))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[m,S]);o&&(e=>{let t="",a=o.total_data_elements||0,n=0;switch(l){case"Last 7 Days":t="7d",a=(null===m||void 0===m||null===(e=m.dataEntries)||void 0===e?void 0:e.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length)||0,n=15.2;break;case"This Month":t="30d",a=o.total_data_elements||0,n=8.5;break;case"Last Quarter":t="Q3",a=o.total_data_elements||0,n=-2.1;break;case"Last Year":t="12m",a=o.total_data_elements||0,n=24.7}"Data Points (".concat(t,")"),o.active_meters,o.total_frameworks,"Completeness (".concat(t,")"),Math.round(o.data_completeness_percentage||0)})();const _=(e=>{const t=Math.round((null===o||void 0===o?void 0:o.data_completeness_percentage)||0);Math.round((null===o||void 0===o||null===(e=o.progress)||void 0===e?void 0:e.overall_percentage)||0);return null!==o&&void 0!==o&&o.frameworks&&Array.isArray(o.frameworks)?o.frameworks.map(e=>({name:e.name||e.framework_id||"Unknown Framework",progress:t,color:t<30?"red":t<70?"orange":"green",status:t<30?"Just Started":t<70?"In Progress":"On Track",type:e.type||("DST"===e.framework_id?"mandatory_conditional":"mandatory"),framework_id:e.framework_id})):[]})();(null===o||void 0===o?void 0:o.recent_activities)||(()=>{const e=[];let t=1;if(null!==m&&void 0!==m&&m.dataEntries&&Array.isArray(m.dataEntries)&&m.dataEntries.forEach(a=>{if(a.submission&&a.submission.value&&parseFloat(a.submission.value)>0){var n;const r=new Date(a.submission.updated_at||a.submission.created_at),s=Math.floor((new Date-r)/36e5),l=s<1?"Just now":s<24?"".concat(s," hours ago"):"".concat(Math.floor(s/24)," days ago");e.push({id:t++,action:"".concat((null===(n=a.meter)||void 0===n?void 0:n.type)||a.element_name," data submitted"),description:"Value: ".concat(parseFloat(a.submission.value).toLocaleString()," ").concat(a.element_unit),time:l,type:"data",icon:"fas fa-chart-line",color:"green"})}}),null!==o&&void 0!==o&&o.progress){const a=o.progress;a.module_5_complete&&e.push({id:t++,action:"Data collection completed",description:"".concat(Math.round(o.data_completeness_percentage||0),"% data completeness achieved"),time:"2 hours ago",type:"milestone",icon:"fas fa-trophy",color:"yellow"}),a.module_4_complete&&e.push({id:t++,action:"Smart meters activated",description:"".concat(o.active_meters||0," meters configured and monitoring"),time:"1 day ago",type:"system",icon:"fas fa-gauge",color:"blue"}),a.module_3_complete&&e.push({id:t++,action:"ESG profiling completed",description:"Company sustainability profile generated",time:"2 days ago",type:"completion",icon:"fas fa-user-check",color:"purple"}),a.module_2_complete&&e.push({id:t++,action:"Frameworks configured",description:"".concat(o.total_frameworks||0," ESG frameworks activated"),time:"3 days ago",type:"setup",icon:"fas fa-list-check",color:"indigo"})}e.sort((e,t)=>"data"===e.type&&"data"!==t.type?-1:"data"===t.type&&"data"!==e.type?1:e.time.includes("hour")?-1:1).slice(0,4)})(),(null===o||void 0===o?void 0:o.upcoming_deadlines)||(()=>{const e=[],t=new Date;null!==o&&void 0!==o&&o.frameworks&&o.frameworks.forEach(a=>{const n=_.find(e=>e.name===a.name);if(n){let r,s;"mandatory"===a.type?(r=30,s=n.progress<80?"High":"Medium"):"mandatory_conditional"===a.type?(r=45,s=n.progress<70?"High":"Medium"):(r=90,s=n.progress<50?"Medium":"Low");const l=new Date(t);l.setDate(t.getDate()+r),e.push({name:"".concat(a.name," Compliance Report"),date:l.toISOString().split("T")[0],daysLeft:r,priority:s,type:"framework"})}});const a=t.getMonth()+1,n=t.getFullYear(),r=new Date(n,a,0),s=Math.ceil((r-t)/864e5);if(s>0&&s<=31){const t=(null===o||void 0===o?void 0:o.data_completeness_percentage)||0;e.push({name:"".concat(r.toLocaleDateString("en-US",{month:"long"})," Data Collection"),date:r.toISOString().split("T")[0],daysLeft:s,priority:t<50?"High":t<80?"Medium":"Low",type:"data"})}const l=[3,6,9,12].find(e=>e>a)||12,i=new Date(n,l-1,new Date(n,l,0).getDate()),c=Math.ceil((i-t)/864e5);c>0&&c<=120&&e.push({name:"Q".concat(Math.ceil(l/3)," ESG Quarterly Report"),date:i.toISOString().split("T")[0],daysLeft:c,priority:c<=30?"High":c<=60?"Medium":"Low",type:"quarterly"});const d=new Date(n,11,31),u=Math.ceil((d-t)/864e5);u>0&&u<=365&&e.push({name:"Annual ESG Compliance Audit",date:d.toISOString().split("T")[0],daysLeft:u,priority:u<=90?"High":u<=180?"Medium":"Low",type:"annual"}),e.sort((e,t)=>e.daysLeft-t.daysLeft).slice(0,4)})();if(d)return(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto flex items-center justify-center h-64",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("i",{className:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Loading dashboard..."})]})});return(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50",children:(()=>{const r=null===e||void 0===e?void 0:e.role;switch(console.log("Rendering dashboard for role:",r),r){case"super_user":return(0,Ue.jsx)(tt,{user:e,companies:s});case"admin":return(0,Ue.jsx)(at,{user:e,selectedCompany:t,sites:a});case"site_manager":return(0,Ue.jsx)(nt,{user:e,selectedSite:n});case"uploader":return(0,Ue.jsx)(rt,{user:e});case"viewer":default:return(0,Ue.jsx)(st,{user:e});case"meter_manager":return(0,Ue.jsx)(lt,{user:e})}})()})},ot=e=>{var t,a;let{isOpen:n,onClose:r,onConfirm:s,data:l}=e;if(!n)return null;const o=(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[100000] flex items-center justify-center p-4",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},onClick:e=>{e.target===e.currentTarget&&r()},children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[(0,Ue.jsx)("div",{className:"p-6 border-b ".concat("warning"===l.type?"bg-yellow-50":"bg-green-50"),children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:["warning"===l.type?(0,Ue.jsx)("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-exclamation-triangle text-yellow-600 text-xl"})}):(0,Ue.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-check-circle text-green-600 text-xl"})}),(0,Ue.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:l.title})]}),(0,Ue.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,Ue.jsx)("i",{className:"fas fa-times text-xl"})})]})}),(0,Ue.jsx)("div",{className:"p-6",children:"warning"===l.type?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("p",{className:"text-gray-700 mb-4",children:l.message}),(0,Ue.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[(0,Ue.jsx)("h3",{className:"font-semibold text-red-900 mb-2",children:"Missing Data:"}),(0,Ue.jsx)("ul",{className:"space-y-1",children:null===(t=l.missingItems)||void 0===t?void 0:t.map((e,t)=>(0,Ue.jsx)("li",{className:"text-red-700 text-sm",children:e},t))})]}),l.missingMeters&&l.missingMeters.length>0&&(0,Ue.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:[(0,Ue.jsx)("h3",{className:"font-semibold text-orange-900 mb-2",children:"Meters Without Data:"}),(0,Ue.jsx)("div",{className:"flex flex-wrap gap-2",children:l.missingMeters.map((e,t)=>(0,Ue.jsx)("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 rounded text-sm",children:e},t))})]}),(0,Ue.jsx)("p",{className:"text-gray-600 text-sm",children:"Do you want to continue generating the Excel report with incomplete data?"})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"File Name:"}),(0,Ue.jsx)("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:l.filename})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Report Period:"}),(0,Ue.jsx)("span",{className:"font-semibold",children:l.period})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Completeness:"}),(0,Ue.jsxs)("span",{className:"font-semibold ".concat(100===l.completeness?"text-green-600":"text-orange-600"),children:[l.completeness,"%"]})]})]}),(0,Ue.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"Excel Report Includes:"}),(0,Ue.jsx)("ul",{className:"space-y-1",children:null===(a=l.includes)||void 0===a?void 0:a.map((e,t)=>(0,Ue.jsxs)("li",{className:"text-gray-600 text-sm flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-check text-green-500 mr-2"}),e]},t))})]}),l.completeness<100&&(0,Ue.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,Ue.jsxs)("p",{className:"text-yellow-800 text-sm",children:[(0,Ue.jsx)("i",{className:"fas fa-info-circle mr-2"}),"Excel report contains incomplete data (",l.completeness,"% complete)"]})})]})}),(0,Ue.jsx)("div",{className:"p-6 border-t bg-gray-50 flex justify-end space-x-3",children:"warning"===l.type?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("button",{onClick:r,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel & Complete Data"}),(0,Ue.jsx)("button",{onClick:s,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors",children:"Generate Excel Anyway"})]}):(0,Ue.jsx)("button",{onClick:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Done"})})]})});return(0,i.createPortal)(o,document.body)},ct=e=>{let{value:t,total:a,label:n,color:r="blue",showPercentage:s=!0}=e;const l=a>0?Math.round(t/a*100):0,i=Math.min(l,100);return(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:n}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[s&&(0,Ue.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:[l,"%"]}),(0,Ue.jsxs)("span",{className:"text-xs text-gray-500",children:[t,"/",a]})]})]}),(0,Ue.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Ue.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 bg-".concat(r,"-500"),style:{width:"".concat(i,"%")}})})]})},dt=e=>{let{data:t,color:a="blue",height:n="20px"}=e;if(!t||0===t.length)return(0,Ue.jsx)("div",{className:"w-12 h-5 bg-gray-100 rounded"});const r=Math.max(...t.filter(e=>e>0)),s=Math.min(...t.filter(e=>e>=0)),l=r-s||1,i=t.map((e,a)=>{const n=a/(t.length-1)*100,r=100-(e-s)/l*80;return"".concat(n,",").concat(r)}).join(" ");return(0,Ue.jsx)("svg",{width:"48",height:n,viewBox:"0 0 100 100",className:"inline-block",children:(0,Ue.jsx)("polyline",{fill:"none",stroke:"rgb(".concat("green"===a?"34, 197, 94":"blue"===a?"59, 130, 246":"239, 68, 68",")"),strokeWidth:"3",points:i})})},ut=e=>{let{alerts:t}=e;return t&&0!==t.length?(0,Ue.jsxs)("div",{className:"bg-red-50 border-l-4 border-red-400 rounded-lg p-4 mb-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center mb-3",children:[(0,Ue.jsx)("i",{className:"fas fa-exclamation-triangle text-red-600 mr-2"}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-red-900",children:"\u26a0\ufe0f REQUIRES ATTENTION"})]}),(0,Ue.jsx)("div",{className:"space-y-2",children:t.map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-center text-red-800",children:[(0,Ue.jsx)("span",{className:"w-2 h-2 bg-red-500 rounded-full mr-3"}),(0,Ue.jsx)("span",{className:"text-sm",children:e})]},t))})]}):null},mt=e=>{let{frameworks:t,onClick:a}=e;return(0,Ue.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>(0,Ue.jsxs)("div",{className:"cursor-pointer hover:bg-gray-50 p-3 rounded-lg transition-colors",onClick:()=>null===a||void 0===a?void 0:a(e),children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-gray-900",children:e.name}),(0,Ue.jsxs)("span",{className:"text-sm font-bold text-gray-700",children:[e.progress,"%"]})]}),(0,Ue.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-2",children:(0,Ue.jsx)("div",{className:"h-3 rounded-full transition-all duration-500 ".concat(e.progress<30?"bg-red-500":e.progress<70?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(Math.min(e.progress,100),"%")}})}),(0,Ue.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,Ue.jsx)("span",{children:"Click for breakdown \u2193"}),(0,Ue.jsxs)("span",{className:"flex space-x-2",children:[(0,Ue.jsxs)("span",{children:["E: ",e.environmental,"%"]}),(0,Ue.jsxs)("span",{children:["S: ",e.social,"%"]}),(0,Ue.jsxs)("span",{children:["G: ",e.governance,"%"]})]})]}),e.progress<70&&(0,Ue.jsxs)("div",{className:"mt-2 text-xs text-orange-600 bg-orange-50 px-2 py-1 rounded",children:["\u26a0\ufe0f ",e.missingItems," items missing"]})]},t))})},ft=e=>{let{score:t,factors:a}=e;const n=(e=>e>=90?"green":e>=70?"yellow":"red")(t);return(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"System Health Score"}),(0,Ue.jsxs)("div",{className:"text-3xl font-bold text-".concat(n,"-600"),children:[t,"/100"]})]}),(0,Ue.jsx)("div",{className:"space-y-3",children:a.map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsx)("span",{className:"text-sm text-gray-700",children:e.name}),(0,Ue.jsx)("div",{className:"flex items-center space-x-2",children:(0,Ue.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full ".concat("Good"===e.status?"bg-green-100 text-green-800":"Needs Improvement"===e.status?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"),children:["Good"===e.status?"\u2705":"\u26a0\ufe0f"," ",e.status]})})]},t))})]})},pt=e=>{let{data:t}=e;const a=["Jan","Feb","Mar","Apr","May","Jun"],n=e=>{switch(e){case"good":return"bg-green-500";case"warning":return"bg-yellow-500";case"danger":return"bg-red-500";default:return"bg-gray-300"}};return(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Heatmap"}),(0,Ue.jsxs)("div",{className:"overflow-x-auto",children:[(0,Ue.jsxs)("table",{className:"w-full",children:[(0,Ue.jsx)("thead",{children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider py-2"}),a.map(e=>(0,Ue.jsx)("th",{className:"text-center text-xs font-medium text-gray-500 uppercase tracking-wider py-2",children:e},e))]})}),(0,Ue.jsx)("tbody",{children:["Energy","Water","Waste"].map(e=>(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("td",{className:"py-2 pr-4 text-sm font-medium text-gray-900",children:e}),a.map(a=>{var r;return(0,Ue.jsx)("td",{className:"py-2 text-center",children:(0,Ue.jsx)("div",{className:"w-6 h-6 rounded-full mx-auto ".concat(n((null===(r=t[e])||void 0===r?void 0:r[a])||"none"))})},"".concat(e,"-").concat(a))})]},e))})]}),(0,Ue.jsxs)("div",{className:"mt-3 flex items-center space-x-4 text-xs text-gray-600",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ue.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,Ue.jsx)("span",{children:"Good"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ue.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),(0,Ue.jsx)("span",{children:"Warning"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ue.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,Ue.jsx)("span",{children:"Danger"})]})]})]})]})},gt=e=>{let{activities:t}=e;const a=e=>{switch(e){case"data":return"fas fa-chart-line";case"approval":return"fas fa-check-circle";case"system":return"fas fa-exclamation-triangle";case"upload":return"fas fa-upload";default:return"fas fa-info-circle"}},n=e=>{switch(e){case"data":return"text-blue-600 bg-blue-50";case"approval":return"text-green-600 bg-green-50";case"system":return"text-orange-600 bg-orange-50";case"upload":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}};return(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),(0,Ue.jsx)("div",{className:"space-y-4 max-h-64 overflow-y-auto",children:t.map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat(n(e.type)),children:(0,Ue.jsx)("i",{className:"".concat(a(e.type)," text-sm")})}),(0,Ue.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.time})]}),e.trend&&(0,Ue.jsxs)("div",{className:"text-xs px-2 py-1 rounded-full ".concat(e.trend>0?"bg-green-100 text-green-800":e.trend<0?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:[e.trend>0?"\u2191":e.trend<0?"\u2193":"="," ",Math.abs(e.trend),"%"]})]},t))})]})},xt=e=>{let{insights:t}=e;return(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ue.jsx)("i",{className:"fas fa-lightbulb text-yellow-500 mr-2"}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Insights & Recommendations"})]}),(0,Ue.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>(0,Ue.jsxs)("div",{className:"border-l-4 border-blue-400 pl-4 py-2",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-800",children:e.message}),e.action&&(0,Ue.jsxs)("button",{className:"mt-2 text-xs text-blue-600 hover:text-blue-800 font-medium",children:[e.action," \u2192"]})]},t))})]})},ht=e=>{let{selectedPeriod:t,onPeriodChange:a}=e;return(0,Ue.jsx)("div",{className:"flex space-x-2 mb-6",children:["Today","This Week","This Month","This Quarter","YTD","Custom"].map(e=>(0,Ue.jsx)("button",{onClick:()=>a(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(t===e?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:e},e))})},yt=e=>{let{userRole:t,onGenerate:a}=e;const n=(e=>{switch(e){case"super_user":return{label:"Generate System Report",icon:"fas fa-chart-line",color:"indigo",prominent:!0};case"admin":return{label:"Generate Company Report",icon:"fas fa-building",color:"blue",prominent:!0};case"site_manager":return{label:"Generate Site Report",icon:"fas fa-map-marker-alt",color:"green",prominent:!0};case"uploader":return{label:"Export My Data",icon:"fas fa-download",color:"gray",prominent:!1};case"viewer":return{label:"Generate Report",icon:"fas fa-file-alt",color:"purple",prominent:!0,hasDropdown:!0};case"meter_manager":return{label:"Meter Reports",icon:"fas fa-tachometer-alt",color:"orange",prominent:!0};default:return{label:"Generate Report",icon:"fas fa-file-alt",color:"blue",prominent:!1}}})(t),[s,l]=(0,r.useState)(!1),i=["Compliance Report","ESG Summary","Audit Trail","Data Quality Report"];return n.hasDropdown?(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsxs)("button",{onClick:()=>l(!s),className:"".concat(n.prominent?"px-6 py-3 text-base":"px-4 py-2 text-sm"," ").concat("indigo"===n.color?"bg-indigo-600 hover:bg-indigo-700":"blue"===n.color?"bg-blue-600 hover:bg-blue-700":"green"===n.color?"bg-green-600 hover:bg-green-700":"purple"===n.color?"bg-purple-600 hover:bg-purple-700":"orange"===n.color?"bg-orange-600 hover:bg-orange-700":"red"===n.color?"bg-red-600 hover:bg-red-700":"bg-gray-600 hover:bg-gray-700"," text-white rounded-lg font-medium transition-colors flex items-center space-x-2"),children:[(0,Ue.jsx)("i",{className:n.icon}),(0,Ue.jsx)("span",{children:n.label}),(0,Ue.jsx)("i",{className:"fas fa-chevron-down ml-2"})]}),s&&(0,Ue.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10",children:[i.map((e,t)=>(0,Ue.jsx)("button",{onClick:()=>{a(e.toLowerCase().replace(/ /g,"-")),l(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg",children:e},t)),(0,Ue.jsx)("hr",{className:"my-1"}),(0,Ue.jsxs)("button",{onClick:()=>{a("schedule-report"),l(!1)},className:"w-full text-left px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-b-lg",children:[(0,Ue.jsx)("i",{className:"fas fa-calendar mr-2"}),"Schedule Report"]})]})]}):(0,Ue.jsxs)("button",{onClick:()=>a("default"),className:"".concat(n.prominent?"px-6 py-3 text-base":"px-4 py-2 text-sm"," ").concat("indigo"===n.color?"bg-indigo-600 hover:bg-indigo-700":"blue"===n.color?"bg-blue-600 hover:bg-blue-700":"green"===n.color?"bg-green-600 hover:bg-green-700":"purple"===n.color?"bg-purple-600 hover:bg-purple-700":"orange"===n.color?"bg-orange-600 hover:bg-orange-700":"red"===n.color?"bg-red-600 hover:bg-red-700":"bg-gray-600 hover:bg-gray-700"," text-white rounded-lg font-medium transition-colors flex items-center space-x-2"),children:[(0,Ue.jsx)("i",{className:n.icon}),(0,Ue.jsx)("span",{children:n.label})]})},bt=e=>{let{userRole:t,onAction:a}=e;const n=(e=>{switch(e){case"super_user":return[{icon:"fas fa-chart-bar",label:"System Analytics",action:"system-analytics",color:"indigo"},{icon:"fas fa-users",label:"User Management",action:"user-management",color:"blue"},{icon:"fas fa-shield-alt",label:"Security Center",action:"security",color:"red"},{icon:"fas fa-cogs",label:"System Settings",action:"settings",color:"gray"}];case"admin":return[{icon:"fas fa-tasks",label:"Assign Tasks",action:"assign-tasks",color:"green"},{icon:"fas fa-check-circle",label:"Review Pending",action:"review-pending",color:"orange"},{icon:"fas fa-users",label:"Manage Team",action:"manage-team",color:"blue"},{icon:"fas fa-building",label:"Site Overview",action:"site-overview",color:"purple"}];case"site_manager":return[{icon:"fas fa-chart-pie",label:"Site Performance",action:"site-performance",color:"purple"},{icon:"fas fa-users",label:"Team Management",action:"team-management",color:"green"},{icon:"fas fa-clipboard-list",label:"Task Queue",action:"task-queue",color:"blue"},{icon:"fas fa-eye",label:"Review Queue",action:"review-queue",color:"orange"}];case"uploader":return[{icon:"fas fa-edit",label:"3 Data Entries Due",action:"data-entries",color:"red",urgent:!0},{icon:"fas fa-paperclip",label:"2 Evidence Uploads",action:"evidence-uploads",color:"blue",urgent:!0}];case"viewer":return[{icon:"fas fa-chart-line",label:"Compliance Tracking",action:"compliance-tracking",color:"purple"},{icon:"fas fa-search",label:"Audit Trail",action:"audit-trail",color:"blue"},{icon:"fas fa-download",label:"Export Data",action:"export-data",color:"green"},{icon:"fas fa-eye",label:"View Reports",action:"view-reports",color:"gray"}];case"meter_manager":return[{icon:"fas fa-tachometer-alt",label:"Meter Status Grid",action:"meter-status",color:"orange"},{icon:"fas fa-wrench",label:"Maintenance Queue",action:"maintenance",color:"red"},{icon:"fas fa-calendar-check",label:"Calibration Schedule",action:"calibration",color:"blue"},{icon:"fas fa-chart-bar",label:"Health Dashboard",action:"meter-health",color:"green"}];default:return[{icon:"fas fa-download",label:"Export Report",action:"export",color:"blue"},{icon:"fas fa-eye",label:"View Details",action:"view-details",color:"gray"}]}})(t);return(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:(e=>{switch(e){case"super_user":return"SYSTEM CONTROLS";case"admin":return"COMPANY MANAGEMENT";case"site_manager":return"SITE OPERATIONS";case"uploader":return"MY TASKS TODAY";case"viewer":return"COMPLIANCE TOOLS";case"meter_manager":return"METER MANAGEMENT";default:return"QUICK ACTIONS"}})(t)}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-3",children:n.map((e,t)=>{const n=(e=>{const t={indigo:{urgent:"border-indigo-500 bg-indigo-50 hover:bg-indigo-100",normal:"border-dashed border-indigo-300 hover:border-indigo-500 hover:bg-indigo-50",icon:"text-indigo-600"},blue:{urgent:"border-blue-500 bg-blue-50 hover:bg-blue-100",normal:"border-dashed border-blue-300 hover:border-blue-500 hover:bg-blue-50",icon:"text-blue-600"},green:{urgent:"border-green-500 bg-green-50 hover:bg-green-100",normal:"border-dashed border-green-300 hover:border-green-500 hover:bg-green-50",icon:"text-green-600"},red:{urgent:"border-red-500 bg-red-50 hover:bg-red-100",normal:"border-dashed border-red-300 hover:border-red-500 hover:bg-red-50",icon:"text-red-600"},orange:{urgent:"border-orange-500 bg-orange-50 hover:bg-orange-100",normal:"border-dashed border-orange-300 hover:border-orange-500 hover:bg-orange-50",icon:"text-orange-600"},purple:{urgent:"border-purple-500 bg-purple-50 hover:bg-purple-100",normal:"border-dashed border-purple-300 hover:border-purple-500 hover:bg-purple-50",icon:"text-purple-600"},gray:{urgent:"border-gray-500 bg-gray-50 hover:bg-gray-100",normal:"border-dashed border-gray-300 hover:border-gray-500 hover:bg-gray-50",icon:"text-gray-600"}};return t[e]||t.blue})(e.color,e.urgent);return(0,Ue.jsxs)("button",{onClick:()=>a(e.action),className:"p-3 rounded-lg border-2 transition-colors text-center ".concat(e.urgent?n.urgent:n.normal),children:[(0,Ue.jsx)("i",{className:"".concat(e.icon," ").concat(n.icon," text-lg mb-2")}),(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-900 ".concat(e.urgent?"font-bold":""),children:e.label}),e.urgent&&(0,Ue.jsx)("div",{className:"mt-1",children:(0,Ue.jsx)("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"URGENT"})})]},t)})})]})},vt=e=>{let{benchmarks:t}=e;return(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Performance vs Industry"}),(0,Ue.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.metric}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("span",{className:"text-sm font-semibold ".concat("good"===e.status?"text-green-600":"warning"===e.status?"text-orange-600":"text-red-600"),children:e.difference}),(0,Ue.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center ".concat("good"===e.status?"bg-green-100 text-green-600":"warning"===e.status?"bg-orange-100 text-orange-600":"bg-red-100 text-red-600"),children:"good"===e.status?"\u2705":"warning"===e.status?"\u26a0\ufe0f":"\u2550"})]})]},t))})]})},jt=()=>{var e,t,a,n,s,l,i,o,c,d,u;const m=ae(),{user:f,selectedCompany:p,makeAuthenticatedRequest:g}=Ge(),[x,h]=(0,r.useState)("This Month"),[y,b]=(0,r.useState)(null),[v,j]=(0,r.useState)(!0),[w,N]=(0,r.useState)({isOpen:!1,type:"",data:{}}),k=(null===f||void 0===f?void 0:f.role)||"viewer",S=(e=>{const t={super_user:{companyMetrics:!0,siteComparison:!0,taskAssignments:!0,priorityAlerts:!0,activityFeed:"global",generateReport:!0},admin:{companyMetrics:!0,siteComparison:!0,taskAssignments:!0,priorityAlerts:!0,activityFeed:"company",generateReport:!0},site_manager:{companyMetrics:!1,siteComparison:"own_sites_only",taskAssignments:!0,priorityAlerts:"site_level",activityFeed:"site",generateReport:!0},uploader:{companyMetrics:!1,siteComparison:!1,taskAssignments:"own_only",priorityAlerts:"personal",activityFeed:!1,generateReport:"personal"},viewer:{companyMetrics:!0,siteComparison:!1,taskAssignments:!1,priorityAlerts:!0,activityFeed:!1,generateReport:!0},meter_manager:{companyMetrics:!1,siteComparison:!1,taskAssignments:!1,priorityAlerts:"meter_only",activityFeed:!1,generateReport:"meter_only"}};return t[e]||t.viewer})(k),_=null===p||void 0===p?void 0:p.id,C=async()=>{if(!_)return console.log("No company selected, skipping dashboard data fetch"),null;try{console.log("\ud83d\udd04 Fetching dashboard data for company:",_);const[e,t,a,n,r]=await Promise.all([fetch("".concat(Le,"/api/dashboard/?company_id=").concat(_),{credentials:"include"}),fetch("".concat(Le,"/api/companies/").concat(_,"/progress/"),{credentials:"include"}),fetch("".concat(Le,"/api/companies/").concat(_,"/frameworks/"),{credentials:"include"}),fetch("".concat(Le,"/api/meters/?company_id=").concat(_),{credentials:"include"}),fetch("".concat(Le,"/api/data-collection/tasks/?company_id=").concat(_,"&year=").concat((new Date).getFullYear(),"&month=").concat((new Date).getMonth()+1),{credentials:"include"})]);console.log("\ud83d\udcca API Response Status:",{dashboard:e.status,progress:t.status,frameworks:a.status,meters:n.status,data:r.status});const s=e.ok?await e.json():{},l=t.ok?await t.json():{},i=a.ok?await a.json():{},o=n.ok?await n.json():{},c=r.ok?await r.json():[];console.log("\ud83d\udccb Raw Frameworks Data:",i);let d=[];i&&(Array.isArray(i)?d=i:i.results&&Array.isArray(i.results)?d=i.results:i.data&&Array.isArray(i.data)?d=i.data:"object"===typeof i&&(d=[i])),0===d.length&&(console.log("\u26a0\ufe0f No frameworks found, adding mandatory frameworks as fallback"),d=[{framework_id:"ESG",name:"ESG Standards",type:"mandatory"},{framework_id:"DST",name:"Dubai Sustainable Tourism",type:"mandatory_conditional"},{framework_id:"GRI",name:"GRI Standards",type:"voluntary"}]),console.log("\u2705 Processed Frameworks:",d);const u=Array.isArray(o)?o:(null===o||void 0===o?void 0:o.results)||(null===o||void 0===o?void 0:o.data)||[];return console.log("\ud83d\udd27 Processed Meters:",u.length,"meters found"),Oe(Oe({},s),{},{progress:l,frameworks:d,meters:u,dataEntries:c||[]})}catch(e){return console.error("\u274c Error fetching dashboard data:",e),{total_data_elements:0,active_meters:0,data_completeness_percentage:0,evidence_completeness_percentage:0,progress:{},frameworks:[{framework_id:"ESG",name:"ESG Standards",type:"mandatory"},{framework_id:"DST",name:"Dubai Sustainable Tourism",type:"mandatory_conditional"},{framework_id:"GRI",name:"GRI Standards",type:"voluntary"}],meters:[],dataEntries:[]}}};(0,r.useEffect)(()=>{const e=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;j(!0);try{var a,n,r;console.log("\ud83d\ude80 Loading dashboard (attempt ".concat(t+1,")..."));const e=await C();if(!e)throw new Error("No API data received");const s=(e=>{var t,a,n,r,s,l,i,o,c,d;if(!e)return null;const u=Math.round(e.data_completeness_percentage||0),m=Math.round(e.evidence_completeness_percentage||0),f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const a=[];for(let n=0;n<7;n++){const r=.2*(Math.random()-.5)*e,s=t/100*e*(n/6);a.push(Math.max(0,Math.round(e+r+s)))}return a};return{kpiCards:[{title:"Data Points (".concat(x,")"),current:(null===(t=e.dataEntries)||void 0===t?void 0:t.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length)||0,total:2*(e.total_data_elements||0),percentage:Math.round(((null===(a=e.dataEntries)||void 0===a?void 0:a.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length)||0)/Math.max(2*(e.total_data_elements||1),1)*100),change:0,trend:"stable",sparklineData:f((null===(n=e.dataEntries)||void 0===n?void 0:n.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length)||0,0),color:"blue"},{title:"Active Meters",current:e.active_meters||0,total:e.total_meters||(null===(r=e.meters)||void 0===r?void 0:r.length)||0,percentage:Math.round((e.active_meters||0)/Math.max(e.total_meters||(null===(s=e.meters)||void 0===s?void 0:s.length)||1,1)*100),change:0,trend:"stable",sparklineData:f(e.active_meters||0,0),color:"green"},{title:"Data Completeness",current:(null===(l=e.dataEntries)||void 0===l?void 0:l.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length)||0,total:2*(e.total_data_elements||0),percentage:Math.round(((null===(i=e.dataEntries)||void 0===i?void 0:i.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length)||0)/Math.max(2*(e.total_data_elements||1),1)*100),change:0,trend:"stable",sparklineData:f((null===(o=e.dataEntries)||void 0===o?void 0:o.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length)||0,0),color:u>=70?"green":u>=40?"yellow":"red"}],priorityAlerts:((t,a)=>{const n=[],r=(e.total_data_elements||0)-((null===(t=e.dataEntries)||void 0===t?void 0:t.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length)||0);r>0&&n.push("".concat(r," data submissions missing"));const s=((null===(a=e.meters)||void 0===a?void 0:a.length)||0)-(e.active_meters||0);return s>0&&n.push("".concat(s," meters need attention")),m<50&&n.push("Evidence completeness at ".concat(m,"% - needs improvement")),e.progress&&!e.progress.module_3_complete&&n.push("Profiling wizard incomplete - complete to generate checklist"),n.length>0?n:["All systems operating normally"]})(),frameworks:(()=>{if(console.log("\ud83c\udfd7\ufe0f Transforming frameworks:",e.frameworks),!e.frameworks||!Array.isArray(e.frameworks))return console.log("\u26a0\ufe0f No frameworks array found, returning empty array"),[];const t=e.frameworks.map((e,t)=>{let a=u,n=u,r=u,s=u;"mandatory"===e.type?(a=Math.min(u+15,100),n=Math.min(u+20,100),r=Math.max(u-5,0),s=Math.min(u+10,100)):"mandatory_conditional"===e.type?(a=Math.max(u-10,0),n=u,r=Math.max(u-15,0),s=Math.max(u-5,0)):(a=Math.max(u-20,0),n=Math.max(u-10,0),r=Math.max(u-25,0),s=Math.max(u-15,0));const l={id:e.id||t,name:e.name||e.framework_id||"Framework ".concat(t+1),framework_id:e.framework_id||"FW_".concat(t+1),type:e.type||"mandatory",progress:Math.round(a),environmental:Math.round(n),social:Math.round(r),governance:Math.round(s),missingItems:Math.max(20-Math.floor(a/5),0)};return console.log("\ud83c\udfaf Transformed Framework ".concat(t+1,":"),l),l});return console.log("\u2705 All frameworks transformed:",t.length,"frameworks"),t})(),activities:((t,a)=>{const n=[];return e.dataEntries&&Array.isArray(e.dataEntries)&&e.dataEntries.slice(0,3).forEach((e,t)=>{if(e.submission&&e.submission.value&&parseFloat(e.submission.value)>0){var a;const t=e.submission.updated_at||e.submission.created_at?Math.max(1,Math.floor(12*Math.random())+1):2;n.push({title:"".concat((null===(a=e.meter)||void 0===a?void 0:a.type)||e.element_name," data submitted"),description:"".concat(parseFloat(e.submission.value).toLocaleString()," ").concat(e.element_unit||"units"),time:"".concat(t," hours ago"),type:"upload",trend:Math.floor(20*Math.random())-5})}}),null!==(t=e.progress)&&void 0!==t&&t.module_4_complete&&n.push({title:"Meter configuration completed",description:"".concat(e.active_meters||0," meters activated and monitoring"),time:"1 day ago",type:"system"}),null!==(a=e.progress)&&void 0!==a&&a.module_3_complete&&n.push({title:"ESG profiling completed",description:"Company sustainability profile generated",time:"2 days ago",type:"approval"}),n.slice(0,4)})(),healthScore:{score:Math.round((u+m)/2),factors:[{name:"Data Quality",status:u>=80?"Good":u>=50?"Needs Improvement":"Poor"},{name:"Timeliness",status:m>=70?"Good":"Needs Improvement"},{name:"Evidence Upload",status:m>=60?"On Track":"Behind"}]},insights:(t=>{const a=[];return u<50&&a.push({message:"Data completeness at ".concat(u,"% - focus on missing submissions"),action:"View Data Tasks"}),m<40&&a.push({message:"Evidence upload rate is low - consider reminder notifications",action:"Send Reminders"}),(null===(t=e.frameworks)||void 0===t?void 0:t.length)>0&&a.push({message:"".concat(e.frameworks.length," framework(s) active - maintain compliance tracking"),action:"View Frameworks"}),(e.total_meters||0)>(e.active_meters||0)&&a.push({message:"Some meters are inactive - check connectivity and calibration",action:"Review Meters"}),a.slice(0,3)})(),benchmarks:[{metric:"Data Completeness",difference:u>=70?"Above industry average":u>=40?"At industry standard":"Below average",status:u>=70||u>=40?"good":"warning"},{metric:"Response Time",difference:"Standard processing time",status:"good"},{metric:"Framework Coverage",difference:"".concat((null===(c=e.frameworks)||void 0===c?void 0:c.length)||0," frameworks active"),status:((null===(d=e.frameworks)||void 0===d?void 0:d.length)||0)>=2?"good":"warning"}],heatmapData:{Energy:{Jan:"good",Feb:"warning",Mar:"good",Apr:"good",May:u>=70?"good":"warning",Jun:"good"},Water:{Jan:"good",Feb:"good",Mar:"warning",Apr:"warning",May:"good",Jun:m>=60?"good":"warning"},Waste:{Jan:"warning",Feb:"warning",Mar:"good",Apr:"good",May:"good",Jun:"warning"}}}})(e);if(!s)throw new Error("Failed to transform data");console.log("\u2705 Dashboard loaded successfully:",{frameworks:(null===(a=s.frameworks)||void 0===a?void 0:a.length)||0,kpiCards:(null===(n=s.kpiCards)||void 0===n?void 0:n.length)||0,activities:(null===(r=s.activities)||void 0===r?void 0:r.length)||0}),b(s)}catch(s){if(console.error("\u274c Error loading dashboard (attempt ".concat(t+1,"):"),s),0===t)return console.log("\ud83d\udd04 Retrying dashboard load..."),void setTimeout(()=>e(1),1e3);console.log("\ud83d\udee1\ufe0f Using fallback data structure"),b({kpiCards:[{title:"Data Points",current:0,total:0,percentage:0,change:0,trend:"stable",sparklineData:[0,0,0,0,0,0,0],color:"gray"},{title:"Active Meters",current:0,total:0,percentage:0,change:0,trend:"stable",sparklineData:[0,0,0,0,0,0,0],color:"gray"},{title:"Data Completeness",current:0,total:0,percentage:0,change:0,trend:"stable",sparklineData:[0,0,0,0,0,0,0],color:"gray"}],priorityAlerts:["Connection issue - showing offline data"],frameworks:[{name:"ESG Standards",framework_id:"ESG",type:"mandatory",progress:0,environmental:0,social:0,governance:0,missingItems:20},{name:"Dubai Sustainable Tourism",framework_id:"DST",type:"mandatory_conditional",progress:0,environmental:0,social:0,governance:0,missingItems:20},{name:"GRI Standards",framework_id:"GRI",type:"voluntary",progress:0,environmental:0,social:0,governance:0,missingItems:20}],activities:[],healthScore:{score:0,factors:[{name:"Data Quality",status:"Poor"},{name:"Timeliness",status:"Poor"},{name:"Evidence Upload",status:"Poor"}]},insights:[{message:"Check network connection and refresh",action:"Refresh Page"}],benchmarks:[{metric:"Connection",difference:"Offline mode",status:"warning"}],heatmapData:{Energy:{Jan:"danger",Feb:"danger",Mar:"danger",Apr:"danger",May:"danger",Jun:"danger"},Water:{Jan:"danger",Feb:"danger",Mar:"danger",Apr:"danger",May:"danger",Jun:"danger"},Waste:{Jan:"danger",Feb:"danger",Mar:"danger",Apr:"danger",May:"danger",Jun:"danger"}}})}finally{j(!1)}};_?(console.log("\ud83d\udcca Starting dashboard load for company:",_),e()):(console.log("\u26a0\ufe0f No company selected"),j(!1),b(null))},[_,x]);const E=async()=>{if(y)try{var e,t,a,n;const r=Math.round((null===(e=y.healthScore)||void 0===e?void 0:e.score)||0),s=await C(),l=[];if(l.push({name:"Overview",data:[["ESG Dashboard Report - Generated on",(new Date).toLocaleDateString()],["Company",(null===p||void 0===p?void 0:p.name)||"Unknown"],["Report Period",x],["Generated By",(null===f||void 0===f?void 0:f.username)||(null===f||void 0===f?void 0:f.email)||"User"],["User Role",k.replace("_"," ").toUpperCase()],[""],["=== OVERVIEW METRICS ==="],["Metric","Value","Unit","Status"],["Total Data Elements",(null===s||void 0===s?void 0:s.total_data_elements)||0,"items",r>=70?"Good":"Needs Improvement"],["Active Meters",(null===s||void 0===s?void 0:s.active_meters)||0,"units","Active"],["Data Completeness","".concat(r,"%"),"percentage",r>=70?"Good":r>=40?"Fair":"Poor"],["Evidence Completeness","".concat(Math.round((null===s||void 0===s?void 0:s.evidence_completeness_percentage)||0),"%"),"percentage","In Progress"]]}),y.frameworks&&y.frameworks.length>0){const e=[["=== FRAMEWORK PROGRESS ==="],["Framework","Progress (%)","Environmental","Social","Governance","Missing Items"]];y.frameworks.forEach(t=>{e.push([t.name,t.progress,t.environmental,t.social,t.governance,t.missingItems])}),l.push({name:"Frameworks",data:e})}if(null!==s&&void 0!==s&&s.meters&&s.meters.length>0){const e=[["=== METER DATA ==="],["Meter Name","Type","Status","Last Reading","Unit"]];s.meters.forEach(t=>{var a,n;const r=null===(a=s.dataEntries)||void 0===a?void 0:a.find(e=>e.meter&&e.meter.id===t.id);e.push([t.name||"Meter ".concat(t.id),t.type||"Unknown",t.is_active?"Active":"Inactive",(null===r||void 0===r||null===(n=r.submission)||void 0===n?void 0:n.value)||"No Data",t.unit||"units"])}),l.push({name:"Meters",data:e})}if(y.activities&&y.activities.length>0){const e=[["=== RECENT ACTIVITIES ==="],["Activity","Description","Time","Type"]];y.activities.forEach(t=>{e.push([t.title,t.description,t.time,t.type])}),l.push({name:"Activities",data:e})}const i=l[0].data.map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n"),o=k.replace("_","-"),c=x.toLowerCase().replace(/ /g,"-"),d=(new Date).toISOString().split("T")[0],u="esg-".concat(o,"-report-").concat(c,"-").concat(d,".csv"),m=new Blob([i],{type:"text/csv;charset=utf-8;"}),g=window.URL.createObjectURL(m),h=document.createElement("a");h.href=g,h.download=u,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(g),N({isOpen:!0,type:"success",data:{type:"success",title:"Excel Export Successful",filename:u,period:x,completeness:r,includes:["Overview metrics and KPIs","Framework progress (".concat((null===(t=y.frameworks)||void 0===t?void 0:t.length)||0," frameworks)"),"Meter data (".concat((null===s||void 0===s||null===(a=s.meters)||void 0===a?void 0:a.length)||0," meters)"),"Recent activities (".concat((null===(n=y.activities)||void 0===n?void 0:n.length)||0," entries)"),"Health score and benchmarks"]}})}catch(r){console.error("Excel export failed:",r),N({isOpen:!0,type:"error",data:{type:"error",title:"Excel Export Failed",message:"The Excel export failed. Please try again or contact support."}})}},P=e=>{console.log("Generating ".concat(e," report for ").concat(k)),(async()=>{var e;if(!y)return;const t=Math.round((null===(e=y.healthScore)||void 0===e?void 0:e.score)||0),a=await C(),n=Math.round((null===a||void 0===a?void 0:a.evidence_completeness_percentage)||0);if(t<100||n<100){var r;const e=[];t<100&&e.push("Data completeness: ".concat(t,"% (").concat(100-t,"% missing)")),n<100&&e.push("Evidence completeness: ".concat(n,"% (").concat(100-n,"% missing)"));const s=(null===a||void 0===a||null===(r=a.meters)||void 0===r?void 0:r.filter(e=>{var t,n;const r=null===(t=a.dataEntries)||void 0===t?void 0:t.find(t=>t.meter&&t.meter.id===e.id);return!(null!==r&&void 0!==r&&null!==(n=r.submission)&&void 0!==n&&n.value)}))||[];return s.length>0&&e.push("".concat(s.length," meters have no data submitted")),void N({isOpen:!0,type:"warning",data:{type:"warning",title:"Incomplete Data Warning",message:"Your ESG data is incomplete. The Excel report will be missing important information.",missingItems:e,missingMeters:s.map(e=>e.type||"Unknown Meter")}})}E()})()},M=()=>{N({isOpen:!1,type:"",data:{}})};return v?(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto p-6",children:(0,Ue.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("i",{className:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Loading dashboard data..."}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Fetching real-time metrics for ",(null===p||void 0===p?void 0:p.name)||"your company"]})]})})}):_&&y?(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Dashboard",(0,Ue.jsxs)("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",k.replace("_"," ").toUpperCase(),")"]})]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:(null===p||void 0===p?void 0:p.name)||"Select Company"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsx)(ht,{selectedPeriod:x,onPeriodChange:h}),S.generateReport&&(0,Ue.jsx)(yt,{userRole:k,onGenerate:P})]})]}),S.priorityAlerts&&(0,Ue.jsx)(ut,{alerts:"personal"===S.priorityAlerts?y.priorityAlerts.filter(e=>e.includes("My")||e.includes("personal")):"site_level"===S.priorityAlerts?y.priorityAlerts.filter(e=>e.includes("site")||e.includes("Site")):"meter_only"===S.priorityAlerts?y.priorityAlerts.filter(e=>e.includes("meter")||e.includes("calibration")):y.priorityAlerts}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:y.kpiCards.map((e,t)=>(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow cursor-pointer",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-sm font-medium text-gray-600",children:e.title}),(0,Ue.jsx)(dt,{data:e.sparklineData,color:e.color})]}),(0,Ue.jsx)(ct,{value:e.current,total:e.total,label:"".concat(e.current,"/").concat(e.total),color:e.color,showPercentage:!1}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,Ue.jsxs)("span",{className:"text-2xl font-bold text-gray-900",children:[e.percentage,"%"]}),(0,Ue.jsxs)("div",{className:"flex items-center text-sm ".concat(e.change>0?"text-green-600":e.change<0?"text-red-600":"text-gray-600"),children:[0!==e.change&&(0,Ue.jsx)("i",{className:"fas fa-arrow-".concat(e.change>0?"up":"down"," mr-1")}),(0,Ue.jsxs)("span",{children:[e.change>0?"+":"",e.change,"% from last month"]})]})]})]},t))}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,Ue.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:["uploader"!==k&&"meter_manager"!==k&&(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Framework Compliance"}),(0,Ue.jsx)(mt,{frameworks:y.frameworks,onClick:e=>{console.log("Framework clicked:",e),m("/rame")}})]}),S.companyMetrics&&(0,Ue.jsx)(pt,{data:y.heatmapData}),"uploader"!==k&&(0,Ue.jsx)(xt,{insights:y.insights}),"uploader"===k&&(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"My Performance"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(null===(e=y.kpiCards[0])||void 0===e?void 0:e.current)||0}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"Tasks Completed"})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[(null===(t=y.kpiCards[0])||void 0===t?void 0:t.percentage)||0,"%"]}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"Completion Rate"})]})]})]}),"meter_manager"===k&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Meter Health Overview"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,Ue.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(null===(a=y.kpiCards[1])||void 0===a?void 0:a.current)||0}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"Active Meters"})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:((null===(n=y.kpiCards[1])||void 0===n?void 0:n.total)||0)-((null===(s=y.kpiCards[1])||void 0===s?void 0:s.current)||0)}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"Need Maintenance"})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[(null===(l=y.kpiCards[1])||void 0===l?void 0:l.percentage)||0,"%"]}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"Health Score"})]})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Maintenance Schedule"}),(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center p-3 bg-red-50 rounded-lg border border-red-200",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-red-900",children:"Electricity Meter #3"}),(0,Ue.jsx)("span",{className:"text-xs text-red-600 bg-red-100 px-2 py-1 rounded-full",children:"Overdue"})]}),(0,Ue.jsxs)("div",{className:"flex justify-between items-center p-3 bg-orange-50 rounded-lg border border-orange-200",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium text-orange-900",children:"Water Meter #1"}),(0,Ue.jsx)("span",{className:"text-xs text-orange-600 bg-orange-100 px-2 py-1 rounded-full",children:"Due Tomorrow"})]})]})]})]})]}),(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsx)(bt,{userRole:k,onAction:e=>{switch(e){case"system-analytics":case"site-performance":case"compliance-tracking":case"view-reports":m("/dashboard");break;case"user-management":case"manage-team":case"team-management":m("/team");break;case"security":console.log("Security center - future implementation");break;case"settings":console.log("System settings - future implementation");break;case"assign-tasks":case"task-queue":m("/tasks");break;case"review-pending":case"review-queue":case"data-entries":case"evidence-uploads":m("/data");break;case"site-overview":m("/sites");break;case"audit-trail":console.log("Audit trail - future implementation");break;case"export-data":P("data-export");break;case"meter-status":case"maintenance":case"calibration":case"meter-health":m("/meter");break;default:console.log("Action:",e)}}}),S.activityFeed&&(0,Ue.jsx)(gt,{activities:"site"===S.activityFeed?y.activities.filter(e=>e.description.includes("site")):y.activities}),"uploader"!==k&&(0,Ue.jsx)(ft,{score:y.healthScore.score,factors:y.healthScore.factors}),S.companyMetrics&&(0,Ue.jsx)(vt,{benchmarks:y.benchmarks}),"uploader"===k&&(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"My Statistics"}),(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-sm text-gray-600",children:"This Week"}),(0,Ue.jsx)("span",{className:"text-sm font-semibold text-green-600",children:"5 tasks completed"})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-sm text-gray-600",children:"Average Response Time"}),(0,Ue.jsx)("span",{className:"text-sm font-semibold text-blue-600",children:"1.2 days"})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-sm text-gray-600",children:"Quality Score"}),(0,Ue.jsx)("span",{className:"text-sm font-semibold text-purple-600",children:"94%"})]})]})]})]})]}),(0,Ue.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ue.jsx)("i",{className:"fas fa-chart-line text-blue-600 mr-2"}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-blue-900",children:"Projections"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Month-end Progress"}),(0,Ue.jsxs)("p",{className:"text-lg font-bold text-blue-900",children:["On track to complete ",(null===(i=y.kpiCards[2])||void 0===i?void 0:i.percentage)||0,"%"]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Remaining Tasks"}),(0,Ue.jsxs)("p",{className:"text-lg font-bold text-blue-900",children:[Math.max(((null===(o=y.kpiCards[2])||void 0===o?void 0:o.total)||0)-((null===(c=y.kpiCards[2])||void 0===c?void 0:c.current)||0),0)," more submissions needed"]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Data Completeness"}),(0,Ue.jsxs)("p",{className:"text-lg font-bold text-blue-900",children:[(null===(d=y.kpiCards[2])||void 0===d?void 0:d.current)||0,"/",(null===(u=y.kpiCards[2])||void 0===u?void 0:u.total)||0," entries"]})]})]})]}),(0,Ue.jsx)(ot,{isOpen:w.isOpen,onClose:M,onConfirm:()=>{M(),E()},data:w.data})]}):(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto p-6",children:(0,Ue.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("i",{className:"fas fa-building text-4xl text-gray-400 mb-4"}),(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No Company Selected"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Please select a company to view dashboard data"})]})})})},wt=()=>{const e=ae();return(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto p-4",children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Dashboard Test"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"This is a minimal test version to verify the dashboard can render."}),(0,Ue.jsx)("button",{onClick:()=>e("/"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Main"}),(0,Ue.jsxs)("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,Ue.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Card 1"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:"123"})]}),(0,Ue.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Card 2"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-green-600",children:"456"})]}),(0,Ue.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Card 3"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:"789"})]}),(0,Ue.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Card 4"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:"101"})]})]})]})},Nt=()=>{const{user:e,selectedCompany:t,hasPermission:a,userSites:n}=Ge(),[s,l]=(0,r.useState)([]),[o,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1),[m,f]=(0,r.useState)(null),[p,g]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null),[w,N]=(0,r.useState)(null),[k,S]=(0,r.useState)(!1),[_,C]=(0,r.useState)({show:!1,type:"",title:"",message:"",details:""}),E=[{value:"admin",label:"Admin",description:"Company-level administrator"},{value:"site_manager",label:"Site Manager",description:"Site/location manager"},{value:"uploader",label:"Uploader",description:"Data entry specialist"},{value:"viewer",label:"Viewer/Auditor",description:"Read-only access with reports"},{value:"meter_manager",label:"Meter Manager",description:"Meter infrastructure specialist"}],P=()=>{if(!e)return[];switch(e.role){case"super_user":return E;case"admin":return E.filter(e=>"super_user"!==e.value);case"site_manager":return E.filter(e=>!["super_user","admin"].includes(e.value));default:return[]}},M=t=>{if(!e)return!1;return({super_user:["super_user","admin","site_manager","uploader","viewer","meter_manager"],admin:["site_manager","uploader","viewer","meter_manager"],site_manager:["uploader","viewer","meter_manager"],uploader:[],viewer:[],meter_manager:[]}[e.role]||[]).includes(t)},T=async()=>{try{c(!0);const t="super_user"===e.role?"".concat(Le,"/api/users/"):"".concat(Le,"/api/users/my-team/"),a=await ze(t);if(a.ok){const e=await a.json();l(Array.isArray(e)?e:e.results||[])}}catch(t){console.error("Failed to fetch users:",t)}finally{c(!1)}};(0,r.useEffect)(()=>{a("userManagement","read")&&T()},[t,a]);const A=function(e,t,a){C({show:!0,type:e,title:t,message:a,details:arguments.length>3&&void 0!==arguments[3]?arguments[3]:""})},D=e=>{let{isOpen:t,onClose:a,onRoleSelect:n}=e;if(!t)return null;const r=P(),s=(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Select User Role"}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(e=>(0,Ue.jsx)("button",{onClick:()=>{f(e),n(e),a()},className:"text-left p-4 border border-gray-200 rounded-lg hover:border-purple-300 hover:bg-purple-50 transition-colors",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas ".concat(R(e.value)," text-purple-600")})}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("h4",{className:"font-medium text-gray-900",children:e.label}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.value))}),(0,Ue.jsx)("div",{className:"flex justify-end pt-6",children:(0,Ue.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"})})]})});return(0,i.createPortal)(s,document.body)},R=e=>{switch(e){case"admin":return"fa-user-shield";case"site_manager":return"fa-building";case"uploader":return"fa-upload";case"viewer":return"fa-eye";case"meter_manager":return"fa-tachometer-alt";default:return"fa-user"}},F=e=>{let{isOpen:t,onClose:a,onSuccess:s,selectedRole:l}=e;const[i,o]=(0,r.useState)({email:"",name:"",role:(null===l||void 0===l?void 0:l.value)||"",sites:[],sendWelcomeEmail:!0}),[c,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l&&o(e=>Oe(Oe({},e),{},{role:l.value}))},[l]);return t?(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Add New ",null===l||void 0===l?void 0:l.label]}),(0,Ue.jsx)("button",{type:"button",onClick:()=>{a(),u(!0)},className:"text-sm text-purple-600 hover:text-purple-800",children:"Change Role"})]}),(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-purple-50 rounded-lg border border-purple-200",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas ".concat(R(null===l||void 0===l?void 0:l.value)," text-purple-600 text-sm")})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium text-purple-900",children:null===l||void 0===l?void 0:l.label}),(0,Ue.jsx)("p",{className:"text-xs text-purple-700",children:null===l||void 0===l?void 0:l.description})]})]})}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),d(!0);try{const e=await ze("".concat(Le,"/api/users/"),{method:"POST",body:JSON.stringify(i)});if(e.ok){await e.json();A("success","User Created Successfully","".concat(i.name," has been added to the system"),"A welcome email has been sent with login credentials"),s(),o({email:"",name:"",role:"",sites:[],sendWelcomeEmail:!0})}else{const t=await e.json();A("error","User Creation Failed","Unable to create new user",t.error||"Unknown error occurred")}}catch(t){console.error("Failed to create user:",t),A("error","User Creation Failed","Network error occurred","Please check your connection and try again")}finally{d(!1)}},className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,Ue.jsx)("input",{type:"email",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",value:i.email,onChange:e=>o(Oe(Oe({},i),{},{email:e.target.value}))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),(0,Ue.jsx)("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",value:i.name,onChange:e=>o(Oe(Oe({},i),{},{name:e.target.value}))})]}),["site_manager","uploader","meter_manager"].includes(i.role)&&n.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assign Sites"}),(0,Ue.jsx)("div",{className:"mt-1 space-y-2 max-h-32 overflow-y-auto border border-gray-300 rounded-md p-2",children:n.map(e=>(0,Ue.jsxs)("label",{className:"flex items-center",children:[(0,Ue.jsx)("input",{type:"checkbox",className:"mr-2",checked:i.sites.includes(e.id),onChange:t=>{const a=t.target.checked?[...i.sites,e.id]:i.sites.filter(t=>t!==e.id);o(Oe(Oe({},i),{},{sites:a}))}}),(0,Ue.jsx)("span",{className:"text-sm",children:e.name})]},e.id))})]}),(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("input",{type:"checkbox",className:"mr-2",checked:i.sendWelcomeEmail,onChange:e=>o(Oe(Oe({},i),{},{sendWelcomeEmail:e.target.checked}))}),(0,Ue.jsx)("label",{className:"text-sm text-gray-700",children:"Send welcome email"})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,Ue.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:c?"Creating...":"Create User"})]})]})]})}):null},O=e=>{var t;let{isOpen:a,onClose:s,user:l,onSuccess:i}=e;const[o,c]=(0,r.useState)({email:"",name:"",role:"",sites:[],is_active:!0}),[d,u]=(0,r.useState)(!1),[m,f]=(0,r.useState)({show:!1,message:"",type:"error"}),[p,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l&&c({email:l.email||"",name:l.name||"",role:l.role||"",sites:l.sites||[],is_active:!1!==l.is_active}),f({show:!1,message:"",type:"error"})},[l,a]);if(!a||!l)return null;const x=P();return(0,Ue.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,Ue.jsx)("div",{className:"bg-white rounded-md p-5 border w-full max-w-md shadow-lg mx-4",children:(0,Ue.jsxs)("div",{className:"mt-3",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Edit User"}),(0,Ue.jsx)("button",{type:"button",onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,Ue.jsx)("i",{className:"fas fa-times"})})]}),m.show&&(0,Ue.jsx)("div",{className:"p-3 rounded-lg mb-4 ".concat("error"===m.type?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"),children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("i",{className:"fas ".concat("error"===m.type?"fa-exclamation-triangle":"fa-info-circle")}),(0,Ue.jsx)("span",{className:"text-sm",children:m.message})]})}),(0,Ue.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l)if(o.email.trim()&&o.name.trim()&&o.role){f({show:!1,message:"",type:"error"}),u(!0);try{const e=await ze("".concat(Le,"/api/users/").concat(l.id,"/"),{method:"PUT",body:JSON.stringify(o)});if(e.ok)A("success","User Updated Successfully","".concat(l.name,"'s information has been updated"),"Changes have been saved to the system"),i();else{const t=await e.json();A("error","Update Failed","Unable to update user information",t.error||"Unknown error occurred")}}catch(t){console.error("Failed to update user:",t),A("error","Update Failed","Network error occurred","Please check your connection and try again")}finally{u(!1)}}else f({show:!0,message:"Please fill in required fields (Email, Name, and Role)",type:"error"})},className:"space-y-6",children:[p?(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Select the role for this user:"}),(0,Ue.jsx)("div",{className:"space-y-2",children:x.map(e=>(0,Ue.jsx)("button",{type:"button",className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",onClick:()=>{c(Oe(Oe({},o),{},{role:e.value})),g(!1)},children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas ".concat(R(e.value)," text-gray-600")})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:e.label}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.value))})]}):(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"User Role"}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas ".concat(R(o.role)," text-purple-600")})}),(0,Ue.jsx)("span",{className:"font-medium text-gray-900",children:(null===(t=E.find(e=>e.value===o.role))||void 0===t?void 0:t.label)||o.role})]}),(0,Ue.jsx)("button",{type:"button",className:"text-sm text-blue-600 hover:text-blue-800",onClick:()=>g(!0),children:"Change Role"})]})]}),!p&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email Address ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsx)("input",{type:"email",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., john.doe@company.com",value:o.email,onChange:e=>c(Oe(Oe({},o),{},{email:e.target.value}))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Full Name ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., John Doe",value:o.name,onChange:e=>c(Oe(Oe({},o),{},{name:e.target.value}))})]}),["site_manager","uploader","meter_manager"].includes(o.role)&&n.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assign Sites"}),(0,Ue.jsx)("div",{className:"mt-1 space-y-2 max-h-32 overflow-y-auto border border-gray-300 rounded-md p-2",children:n.map(e=>(0,Ue.jsxs)("label",{className:"flex items-center",children:[(0,Ue.jsx)("input",{type:"checkbox",className:"mr-2",checked:o.sites.includes(e.id),onChange:t=>{const a=t.target.checked?[...o.sites,e.id]:o.sites.filter(t=>t!==e.id);c(Oe(Oe({},o),{},{sites:a}))}}),(0,Ue.jsx)("span",{className:"text-sm",children:e.name})]},e.id))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Status"}),(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>c(Oe(Oe({},o),{},{is_active:!0})),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(o.is_active?"bg-green-100 text-green-800 border border-green-200":"bg-gray-100 text-gray-600 border border-gray-200 hover:bg-gray-200"),children:"Active"}),(0,Ue.jsx)("button",{type:"button",onClick:()=>c(Oe(Oe({},o),{},{is_active:!1})),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(o.is_active?"bg-gray-100 text-gray-600 border border-gray-200 hover:bg-gray-200":"bg-red-100 text-red-800 border border-red-200"),children:"Inactive"})]}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:o.is_active?"User can log in and access the system":"User cannot log in or access the system"})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,Ue.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",onClick:s,children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:d?"Saving Changes...":"Save Changes"})]})]})]})]})})})},L=e=>{let{isOpen:t,onClose:a,user:n,onConfirm:r,isProcessing:s}=e;return t&&n?(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-red-900",children:"Delete User"}),(0,Ue.jsx)("button",{type:"button",onClick:a,className:"text-gray-400 hover:text-gray-600",children:(0,Ue.jsx)("i",{className:"fas fa-times"})})]}),(0,Ue.jsx)("div",{className:"mb-6",children:(0,Ue.jsxs)("div",{className:"text-center mb-4",children:[(0,Ue.jsx)("i",{className:"fas fa-exclamation-triangle text-red-500 text-4xl mb-4"}),(0,Ue.jsxs)("p",{className:"text-gray-700",children:["Are you sure you want to delete ",(0,Ue.jsx)("strong",{children:n.name})," (",n.email,")?"]}),(0,Ue.jsx)("p",{className:"text-sm text-red-600 mt-2",children:"This action cannot be undone. The user will lose access to the system immediately."})]})}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Ue.jsx)("button",{type:"button",onClick:a,disabled:s,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),(0,Ue.jsx)("button",{type:"button",onClick:r,disabled:s,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:s?"Deleting...":"Delete User"})]})]})}):null},U=e=>{let{notification:t,onClose:a}=e;if(!t.show)return null;return(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:t.title}),(0,Ue.jsx)("button",{type:"button",onClick:a,className:"text-gray-400 hover:text-gray-600",children:(0,Ue.jsx)("i",{className:"fas fa-times"})})]}),(0,Ue.jsx)("div",{className:"p-4 rounded-lg border ".concat((()=>{switch(t.type){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-yellow-50 border-yellow-200";default:return"bg-blue-50 border-blue-200"}})()," mb-4"),children:(0,Ue.jsxs)("div",{className:"flex items-start",children:[(0,Ue.jsx)("div",{className:"flex-shrink-0",children:(0,Ue.jsx)("i",{className:"".concat((()=>{switch(t.type){case"success":return"fas fa-check-circle text-green-500";case"error":return"fas fa-exclamation-triangle text-red-500";case"warning":return"fas fa-exclamation-triangle text-yellow-500";default:return"fas fa-info-circle text-blue-500"}})()," text-2xl")})}),(0,Ue.jsxs)("div",{className:"ml-3 flex-1",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-900",children:t.message}),t.details&&(0,Ue.jsx)("div",{className:"mt-2",children:(0,Ue.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:t.details})})]})]})}),(0,Ue.jsx)("div",{className:"flex justify-end",children:(0,Ue.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"OK"})})]})})};return e&&["super_user","admin","site_manager"].includes(e.role)?o?(0,Ue.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),(0,Ue.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading users..."})]}):(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Team Management"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Manage users and their access to the platform"})]}),a("userManagement","create")&&(0,Ue.jsxs)("button",{onClick:()=>u(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-plus mr-2"}),"Add User"]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,Ue.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company ID"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sites/Access"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>{var t,n,r,s,l,i,o,c;return(0,Ue.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"h-10 w-10 bg-gray-300 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-gray-700 font-medium",children:(null===(t=e.name)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase())||"U"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat((c=e.role,{super_user:"bg-red-100 text-red-800",admin:"bg-purple-100 text-purple-800",site_manager:"bg-blue-100 text-blue-800",uploader:"bg-green-100 text-green-800",viewer:"bg-gray-100 text-gray-800",meter_manager:"bg-orange-100 text-orange-800"}[c]||"bg-gray-100 text-gray-800")),children:(null===(r=E.find(t=>t.value===e.role))||void 0===r?void 0:r.label)||e.role})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("span",{className:"font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:(null===(s=e.company)||void 0===s?void 0:s.company_code)||"N/A"}),(0,Ue.jsxs)("span",{className:"text-gray-500 text-xs",children:["(ID: ",(null===(l=e.company)||void 0===l?void 0:l.id)||"N/A",")"]})]})}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(null===(i=e.sites)||void 0===i?void 0:i.length)||0," sites"]}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(o=e.last_login,o?new Date(o).toLocaleDateString():"Never")}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[a("userManagement","update")&&(0,Ue.jsx)("button",{className:"text-purple-600 hover:text-purple-900 disabled:opacity-50",onClick:()=>(e=>{M(e.role)?(j(e),h(!0)):C({show:!0,type:"error",title:"Update Failed",message:"Unable to update user information",details:"You cannot manage users with ".concat(e.role," role")})})(e),disabled:k,title:"Edit User",children:(0,Ue.jsx)("i",{className:"fas fa-edit"})}),a("userManagement","delete")&&(0,Ue.jsx)("button",{className:"text-red-600 hover:text-red-900 disabled:opacity-50",onClick:()=>(e=>{M(e.role)?(N(e),b(!0)):C({show:!0,type:"error",title:"Delete Failed",message:"Unable to delete user",details:"You cannot manage users with ".concat(e.role," role")})})(e),disabled:k,title:"Delete User",children:(0,Ue.jsx)("i",{className:"fas fa-trash"})}),!1]})]},e.id)})})]}),0===s.length&&(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("i",{className:"fas fa-users text-4xl text-gray-400 mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-500",children:"No users found. Create your first team member!"})]})]}),(0,Ue.jsx)(D,{isOpen:d,onClose:()=>u(!1),onRoleSelect:t=>{if(a=t.value,!e||!({super_user:["super_user","admin","site_manager","uploader","viewer","meter_manager"],admin:["admin","site_manager","uploader","viewer","meter_manager"],site_manager:["uploader","viewer","meter_manager"],uploader:[],viewer:[],meter_manager:[]}[e.role]||[]).includes(a))return C({show:!0,type:"error",title:"Create User Failed",message:"Unable to create user",details:"You cannot create users with ".concat(t.value," role")}),void u(!1);var a;f(t),g(!0)}}),(0,Ue.jsx)(F,{isOpen:p,onClose:()=>{g(!1),f(null)},selectedRole:m,onSuccess:()=>{g(!1),f(null),T()}}),(0,Ue.jsx)(O,{isOpen:x,onClose:()=>{h(!1),j(null)},user:v,onSuccess:()=>{h(!1),j(null),T()}}),(0,Ue.jsx)(L,{isOpen:y,onClose:()=>{b(!1),N(null)},user:w,onConfirm:async()=>{if(w){S(!0);try{const e=await ze("".concat(Le,"/api/users/").concat(w.id,"/"),{method:"DELETE"});if(e.ok)A("success","User Deleted Successfully","".concat(w.name," has been removed from the system"),"The user no longer has access to the platform"),T(),b(!1),N(null);else{const t=await e.json();A("error","Delete Failed","Unable to delete user",t.error||"Unknown error occurred")}}catch(e){console.error("Delete user failed:",e),A("error","Delete Failed","Network error occurred","Please check your connection and try again")}finally{S(!1)}}},isProcessing:k}),(0,Ue.jsx)(U,{notification:_,onClose:()=>{C({show:!1,type:"",title:"",message:"",details:""})}})]}):(0,Ue.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,Ue.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access user management."}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})})},kt=()=>{const{user:e,selectedCompany:t,hasPermission:a}=Ge(),[n,s]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null),f=["Abu Dhabi","Dubai","Sharjah","Ajman","Umm Al Quwain","Ras Al Khaimah","Fujairah"];(0,r.useEffect)(()=>{t&&a("siteManagement","read")&&p()},[t]);const p=async()=>{try{o(!0);const e=await ze("".concat(Le,"/api/companies/").concat(t.id,"/sites/"));if(e.ok){const t=await e.json();s(Array.isArray(t)?t:t.results||[])}}catch(e){console.error("Failed to fetch sites:",e)}finally{o(!1)}},g=e=>{let{isOpen:a,onClose:n,onSuccess:s,editSite:l=null}=e;const[o,c]=(0,r.useState)({name:"",emirate:"",address:"",description:""}),[d,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c(l?{name:l.name||"",emirate:l.emirate||"",address:l.address||"",description:l.description||""}:{name:"",emirate:"",address:"",description:""})},[l]);if(!a)return null;const m=(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:l?"Edit Site":"Add New Site"}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(!0);try{const e=l?"".concat(Le,"/api/sites/").concat(l.id,"/"):"".concat(Le,"/api/companies/").concat(t.id,"/sites/"),a=l?"PUT":"POST";(await ze(e,{method:a,body:JSON.stringify(o)})).ok&&(s(),c({name:"",emirate:"",address:"",description:""}))}catch(a){console.error("Failed to save site:",a)}finally{u(!1)}},className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Site Name"}),(0,Ue.jsx)("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Dubai Main Hotel",value:o.name,onChange:e=>c(Oe(Oe({},o),{},{name:e.target.value}))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Emirate"}),(0,Ue.jsxs)("select",{required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",value:o.emirate,onChange:e=>c(Oe(Oe({},o),{},{emirate:e.target.value})),children:[(0,Ue.jsx)("option",{value:"",children:"Select Emirate"}),f.map(e=>(0,Ue.jsx)("option",{value:e,children:e},e))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),(0,Ue.jsx)("textarea",{rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Full address of the site",value:o.address,onChange:e=>c(Oe(Oe({},o),{},{address:e.target.value}))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description (Optional)"}),(0,Ue.jsx)("textarea",{rows:2,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Additional details about this site",value:o.description,onChange:e=>c(Oe(Oe({},o),{},{description:e.target.value}))})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,Ue.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:d?l?"Updating...":"Creating...":l?"Update Site":"Create Site"})]})]})]})});return(0,i.createPortal)(m,document.body)};return a("siteManagement","read")?l?(0,Ue.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),(0,Ue.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading sites..."})]}):(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Site Management"}),(0,Ue.jsxs)("p",{className:"text-gray-600",children:["Manage locations and sites for ",null===t||void 0===t?void 0:t.name]})]}),a("siteManagement","create")&&(0,Ue.jsxs)("button",{onClick:()=>d(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-plus mr-2"}),"Add Site"]})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,Ue.jsx)("p",{className:"text-sm text-purple-600 font-medium",children:e.emirate})]}),(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[a("siteManagement","update")&&(0,Ue.jsx)("button",{onClick:()=>{m(e),d(!0)},className:"text-gray-500 hover:text-purple-600",title:"Edit Site",children:(0,Ue.jsx)("i",{className:"fas fa-edit"})}),a("siteManagement","delete")&&(0,Ue.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this site? This action cannot be undone."))try{(await ze("".concat(Le,"/api/sites/").concat(e,"/"),{method:"DELETE"})).ok&&s(n.filter(t=>t.id!==e))}catch(t){console.error("Failed to delete site:",t)}})(e.id),className:"text-gray-500 hover:text-red-600",title:"Delete Site",children:(0,Ue.jsx)("i",{className:"fas fa-trash"})})]})]}),e.address&&(0,Ue.jsx)("div",{className:"mb-4",children:(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,Ue.jsx)("i",{className:"fas fa-map-marker-alt mr-2"}),e.address]})}),e.description&&(0,Ue.jsx)("div",{className:"mb-4",children:(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:e.description})}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:e.users_count||0}),(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:"Assigned Users"})]}),(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:e.meters_count||0}),(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:"Active Meters"})]})]}),(0,Ue.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-between",children:[(0,Ue.jsxs)("button",{className:"text-sm text-purple-600 hover:text-purple-700 flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-users mr-1"}),"Manage Users"]}),(0,Ue.jsxs)("button",{className:"text-sm text-purple-600 hover:text-purple-700 flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-chart-bar mr-1"}),"View Data"]})]})]},e.id))}),0===n.length&&(0,Ue.jsxs)("div",{className:"text-center py-12",children:[(0,Ue.jsx)("div",{className:"text-gray-400 mb-4",children:(0,Ue.jsx)("i",{className:"fas fa-building text-6xl"})}),(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sites configured"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-6",children:"Create your first site to start collecting ESG data across multiple locations."}),a("siteManagement","create")&&(0,Ue.jsx)("button",{onClick:()=>d(!0),className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700",children:"Create First Site"})]}),(0,Ue.jsx)(g,{isOpen:c,onClose:()=>{d(!1),m(null)},onSuccess:()=>{d(!1),m(null),p()},editSite:u})]}):(0,Ue.jsx)("div",{className:"text-center py-8",children:(0,Ue.jsxs)("div",{className:"text-gray-500",children:[(0,Ue.jsx)("i",{className:"fas fa-lock text-4xl mb-4"}),(0,Ue.jsx)("p",{children:"You don't have permission to access site management."})]})})},St=()=>{const{user:e,selectedCompany:t,userSites:a,hasPermission:n}=Ge(),[s,l]=(0,r.useState)([]),[o,c]=(0,r.useState)([]),[d,u]=(0,r.useState)([]),[m,f]=(0,r.useState)(!0),[p,g]=(0,r.useState)(null),[x,h]=(0,r.useState)(null),[y,b]=(0,r.useState)("all"),[v,j]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&n("dataChecklist","assign")&&w()},[t]);const w=async()=>{try{f(!0),await Promise.all([N(),k(),S()])}catch(e){console.error("Failed to fetch data:",e)}finally{f(!1)}},N=async()=>{try{const e=await ze("".concat(Le,"/api/companies/").concat(t.id,"/data-elements/"));if(e.ok){const t=await e.json();l(Array.isArray(t)?t:t.results||[])}}catch(e){console.error("Failed to fetch data elements:",e)}},k=async()=>{try{const e=await ze("".concat(Le,"/api/tasks/assignments/"));if(e.ok){const t=await e.json();c(Array.isArray(t)?t:t.results||[])}}catch(e){console.error("Failed to fetch assignments:",e)}},S=async()=>{try{const e=await ze("".concat(Le,"/api/users/my-team/"));if(e.ok){const t=await e.json();u(Array.isArray(t)?t:t.results||[])}}catch(e){console.error("Failed to fetch users:",e)}},_=(e,t)=>o.find(a=>a.data_element_id===e&&a.site_id===t),C=e=>{if(!e)return(0,Ue.jsx)("i",{className:"fas fa-user-plus text-gray-400",title:"Unassigned"});const t={pending:(0,Ue.jsx)("i",{className:"fas fa-clock text-yellow-500",title:"Pending"}),in_progress:(0,Ue.jsx)("i",{className:"fas fa-play text-orange-500",title:"In Progress"}),completed:(0,Ue.jsx)("i",{className:"fas fa-check text-green-500",title:"Completed"}),overdue:(0,Ue.jsx)("i",{className:"fas fa-exclamation-triangle text-red-500",title:"Overdue"})};return t[e.status]||t.pending},E=s.filter(e=>"assigned"===y?a.some(t=>_(e.id,t.id)):"unassigned"!==y||a.some(t=>!_(e.id,t.id))),P=e=>{let{isOpen:t,onClose:n,onSuccess:l}=e;const[o,c]=(0,r.useState)({assignTo:"",site:"",elements:[],action:"assign"});if(!t)return null;const u=(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Bulk Assignment"}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assign To"}),(0,Ue.jsxs)("select",{className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",value:o.assignTo,onChange:e=>c(Oe(Oe({},o),{},{assignTo:e.target.value})),children:[(0,Ue.jsx)("option",{value:"",children:"Select User"}),d.filter(e=>["uploader","site_manager"].includes(e.role)).map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Site"}),(0,Ue.jsxs)("select",{className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",value:o.site,onChange:e=>c(Oe(Oe({},o),{},{site:e.target.value})),children:[(0,Ue.jsx)("option",{value:"",children:"Select Site"}),a.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Options"}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsxs)("button",{type:"button",className:"w-full text-left p-3 border rounded-lg hover:bg-gray-50",onClick:()=>{c(Oe(Oe({},o),{},{elements:s.filter(e=>"Environmental"===e.category).map(e=>e.id)}))},children:[(0,Ue.jsx)("div",{className:"font-medium",children:"Assign all Environmental tasks"}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"All electricity, water, waste, and energy tasks"})]}),(0,Ue.jsxs)("button",{type:"button",className:"w-full text-left p-3 border rounded-lg hover:bg-gray-50",onClick:()=>{c(Oe(Oe({},o),{},{elements:s.filter(e=>"Social"===e.category).map(e=>e.id)}))},children:[(0,Ue.jsx)("div",{className:"font-medium",children:"Assign all Social tasks"}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"Employee training, community initiatives"})]}),(0,Ue.jsxs)("button",{type:"button",className:"w-full text-left p-3 border rounded-lg hover:bg-gray-50",onClick:()=>{c(Oe(Oe({},o),{},{elements:s.filter(e=>e.is_metered).map(e=>e.id)}))},children:[(0,Ue.jsx)("div",{className:"font-medium",children:"Assign all metered tasks"}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"Tasks requiring meter readings"})]})]})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,Ue.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,Ue.jsx)("button",{type:"button",onClick:async()=>{try{(await ze("".concat(Le,"/api/tasks/bulk-assign/"),{method:"POST",body:JSON.stringify(o)})).ok&&l()}catch(e){console.error("Failed to bulk assign:",e)}},className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Apply Assignment"})]})]})]})});return(0,i.createPortal)(u,document.body)};return n("dataChecklist","assign")?m?(0,Ue.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),(0,Ue.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading task assignments..."})]}):(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Task Assignment"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Assign data collection tasks to team members"})]}),(0,Ue.jsx)("div",{className:"flex space-x-3",children:(0,Ue.jsxs)("button",{onClick:()=>j(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center",children:[(0,Ue.jsx)("i",{className:"fas fa-layer-group mr-2"}),"Bulk Assign"]})})]}),(0,Ue.jsxs)("div",{className:"flex space-x-4",children:[(0,Ue.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-2 bg-white",value:y,onChange:e=>b(e.target.value),children:[(0,Ue.jsx)("option",{value:"all",children:"All Tasks"}),(0,Ue.jsx)("option",{value:"assigned",children:"Assigned Tasks"}),(0,Ue.jsx)("option",{value:"unassigned",children:"Unassigned Tasks"})]}),(0,Ue.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-2 bg-white",value:x||"",onChange:e=>h(e.target.value||null),children:[(0,Ue.jsx)("option",{value:"",children:"All Users"}),d.map(e=>(0,Ue.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,Ue.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data Element"}),a.map(e=>(0,Ue.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.name},e.id))]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(e=>(0,Ue.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"px-6 py-4",children:(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[e.category," \u2022 ",e.frequency,e.is_metered&&(0,Ue.jsx)("span",{className:"ml-2 text-purple-600",children:"\ud83d\udcca Metered"})]})]})}),a.map(t=>{var a;const n=_(e.id,t.id);return(0,Ue.jsx)("td",{className:"px-6 py-4 text-center",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[C(n),n?(0,Ue.jsxs)("div",{className:"text-sm",children:[(0,Ue.jsx)("div",{className:"font-medium text-gray-900",children:(null===(a=d.find(e=>e.id===n.assigned_to))||void 0===a?void 0:a.name)||"Unknown User"}),(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:new Date(n.assigned_at).toLocaleDateString()}),(0,Ue.jsx)("button",{onClick:()=>(async e=>{try{(await ze("".concat(Le,"/api/tasks/assignments/").concat(e,"/"),{method:"DELETE"})).ok&&k()}catch(t){console.error("Failed to unassign task:",t)}})(n.id),className:"text-xs text-red-600 hover:text-red-800 mt-1",children:"Unassign"})]}):(0,Ue.jsxs)("select",{className:"text-sm border border-gray-300 rounded px-2 py-1",onChange:a=>{a.target.value&&(async(e,t,a)=>{try{(await ze("".concat(Le,"/api/tasks/assign/"),{method:"POST",body:JSON.stringify({data_element_id:e,site_id:t,assigned_to:a})})).ok&&k()}catch(n){console.error("Failed to assign task:",n)}})(e.id,t.id,a.target.value)},children:[(0,Ue.jsx)("option",{value:"",children:"Assign to..."}),d.filter(e=>["uploader","site_manager"].includes(e.role)).map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))]})]})},t.id)})]},e.id))})]}),0===E.length&&(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("i",{className:"fas fa-tasks text-4xl text-gray-400 mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-500",children:"No data elements found matching the selected filters."})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,Ue.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:s.length}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"Total Tasks"})]}),(0,Ue.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-green-600",children:o.filter(e=>"completed"===e.status).length}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"Completed"})]}),(0,Ue.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:o.filter(e=>"in_progress"===e.status).length}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"In Progress"})]}),(0,Ue.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold text-red-600",children:o.filter(e=>"overdue"===e.status).length}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"Overdue"})]})]}),(0,Ue.jsx)(P,{isOpen:v,onClose:()=>j(!1),onSuccess:()=>{j(!1),k()}})]}):(0,Ue.jsx)("div",{className:"text-center py-8",children:(0,Ue.jsxs)("div",{className:"text-gray-500",children:[(0,Ue.jsx)("i",{className:"fas fa-lock text-4xl mb-4"}),(0,Ue.jsx)("p",{children:"You don't have permission to assign tasks."})]})})},_t=()=>{const e=ae(),{user:t,resetPassword:a}=Ge(),[n,s]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[l,o]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1);r.useEffect(()=>{t&&!t.must_reset_password&&e("/dashboard")},[t,e]);const f=e=>{s(Oe(Oe({},n),{},{[e.target.name]:e.target.value})),o("")},p=()=>{m(!1),e("/dashboard")},g=()=>{const e=(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,Ue.jsx)("div",{className:"bg-white rounded-xl p-8 max-w-md w-full mx-4 shadow-2xl",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-6",children:(0,Ue.jsx)("i",{className:"fas fa-check text-green-600 text-2xl"})}),(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Password Reset Successfully!"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-8",children:"Your password has been updated successfully. You can now access the dashboard with your new password."}),(0,Ue.jsx)("div",{className:"flex space-x-4",children:(0,Ue.jsxs)("button",{onClick:p,className:"flex-1 bg-gradient-to-r from-green-600 to-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:from-green-700 hover:to-blue-700 transition-all duration-200",children:[(0,Ue.jsx)("i",{className:"fas fa-arrow-right mr-2"}),"Continue to Dashboard"]})})]})})});return(0,i.createPortal)(e,document.body)};return(0,Ue.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[(0,Ue.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"mx-auto h-12 w-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-key text-yellow-600 text-xl"})}),(0,Ue.jsx)("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Reset Your Password"}),(0,Ue.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"You must reset your password to continue"})]}),"super_user"===(null===t||void 0===t?void 0:t.role)?null:(0,Ue.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("i",{className:"fas fa-info-circle text-blue-600"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-blue-800",children:"First time login?"}),(0,Ue.jsx)("p",{className:"text-sm text-blue-700",children:"Use your company code as the current password. You can get this from your administrator."})]})]})}),(0,Ue.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async e=>{if(e.preventDefault(),o(""),d(!0),!n.currentPassword||!n.newPassword||!n.confirmPassword)return o("All fields are required"),void d(!1);if(n.newPassword!==n.confirmPassword)return o("New passwords do not match"),void d(!1);if(n.newPassword.length<6)return o("New password must be at least 6 characters long"),void d(!1);if(n.currentPassword===n.newPassword)return o("New password must be different from current password"),void d(!1);try{const e=await a(n.currentPassword,n.newPassword);e.success?m(!0):o(e.error)}catch(l){o("An error occurred. Please try again.")}finally{d(!1)}},children:[(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"currentPassword",name:"currentPassword",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your current password",value:n.currentPassword,onChange:f}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"newPassword",name:"newPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your new password",value:n.newPassword,onChange:f}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,Ue.jsx)("i",{className:"fas fa-key text-gray-400"})})]}),(0,Ue.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters long"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,Ue.jsxs)("div",{className:"mt-1 relative",children:[(0,Ue.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Confirm your new password",value:n.confirmPassword,onChange:f}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,Ue.jsx)("i",{className:"fas fa-check text-gray-400"})})]})]})]}),l&&(0,Ue.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,Ue.jsxs)("div",{className:"flex",children:[(0,Ue.jsx)("div",{className:"flex-shrink-0",children:(0,Ue.jsx)("i",{className:"fas fa-exclamation-circle text-red-400"})}),(0,Ue.jsx)("div",{className:"ml-3",children:(0,Ue.jsx)("h3",{className:"text-sm font-medium text-red-800",children:l})})]})}),(0,Ue.jsx)("div",{children:(0,Ue.jsx)("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:c?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Resetting Password..."]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("i",{className:"fas fa-save mr-2"}),"Reset Password"]})})}),(0,Ue.jsx)("div",{className:"text-center",children:(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Need help? Contact your system administrator"})})]})]}),u&&(0,Ue.jsx)(g,{})]})},Ct=()=>{const{user:e,resetPassword:t}=Ge(),[a,n]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[s,l]=(0,r.useState)(""),[i,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)({isOpen:!1,type:"info",title:"",message:""}),u=e=>{n(Oe(Oe({},a),{},{[e.target.name]:e.target.value})),l("")};return(0,Ue.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("i",{className:"fas fa-key text-blue-600"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Change Password"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Update your account password"})]})]}),(0,Ue.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l(""),o(!0),!a.currentPassword||!a.newPassword||!a.confirmPassword)return l("All fields are required"),void o(!1);if(a.newPassword!==a.confirmPassword)return l("New passwords do not match"),void o(!1);if(a.newPassword.length<6)return l("New password must be at least 6 characters long"),void o(!1);if(a.currentPassword===a.newPassword)return l("New password must be different from current password"),void o(!1);try{const e=await t(a.currentPassword,a.newPassword);e.success?(n({currentPassword:"",newPassword:"",confirmPassword:""}),d({isOpen:!0,type:"success",title:"Password Changed Successfully",message:"Your password has been updated successfully."})):l(e.error)}catch(s){l("An error occurred. Please try again.")}finally{o(!1)}},className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{type:"password",id:"currentPassword",name:"currentPassword",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your current password",value:a.currentPassword,onChange:u}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,Ue.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{type:"password",id:"newPassword",name:"newPassword",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your new password",value:a.newPassword,onChange:u}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,Ue.jsx)("i",{className:"fas fa-key text-gray-400"})})]}),(0,Ue.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters long"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Confirm your new password",value:a.confirmPassword,onChange:u}),(0,Ue.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,Ue.jsx)("i",{className:"fas fa-check text-gray-400"})})]})]}),s&&(0,Ue.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,Ue.jsxs)("div",{className:"flex",children:[(0,Ue.jsx)("i",{className:"fas fa-exclamation-circle text-red-400 mr-2 mt-0.5"}),(0,Ue.jsx)("p",{className:"text-sm text-red-600",children:s})]})}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between pt-4",children:[(0,Ue.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,Ue.jsx)("i",{className:"fas fa-info-circle text-blue-500 mr-1"}),"Password will be changed immediately"]}),(0,Ue.jsx)("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Updating..."]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("i",{className:"fas fa-save mr-2"}),"Change Password"]})})]})]}),(0,Ue.jsx)(Ye,{isOpen:c.isOpen,onClose:()=>{d({isOpen:!1,type:"info",title:"",message:""})},type:c.type,title:c.title,message:c.message})]})};console.log("App.js loaded");const Et=function(){return console.log("App component rendering"),(0,Ue.jsx)(_e,{children:(0,Ue.jsx)(We,{children:(0,Ue.jsx)("div",{className:"App min-h-screen bg-gray-50",children:(0,Ue.jsxs)(ve,{children:[(0,Ue.jsx)(ye,{path:"/login",element:(0,Ue.jsx)(Be,{})}),(0,Ue.jsx)(ye,{path:"/signup",element:(0,Ue.jsx)(qe,{})}),(0,Ue.jsx)(ye,{path:"/reset-password",element:(0,Ue.jsx)(Ve,{children:(0,Ue.jsx)(_t,{})})}),(0,Ue.jsx)(ye,{path:"/",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)($e,{})})]})}),(0,Ue.jsx)(ye,{path:"/onboard",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)($e,{})})]})}),(0,Ue.jsx)(ye,{path:"/rame",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(Ke,{})})]})}),(0,Ue.jsx)(ye,{path:"/list",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(Je,{})})]})}),(0,Ue.jsx)(ye,{path:"/meter",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(Ze,{})})]})}),(0,Ue.jsx)(ye,{path:"/data",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(et,{})})]})}),(0,Ue.jsx)(ye,{path:"/dashboard",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)(jt,{})]})}),(0,Ue.jsx)(ye,{path:"/dashboard-test",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(wt,{})})]})}),(0,Ue.jsx)(ye,{path:"/dashboard-old",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(it,{})})]})}),(0,Ue.jsx)(ye,{path:"/team",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(Nt,{})})]})}),(0,Ue.jsx)(ye,{path:"/sites",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(kt,{})})]})}),(0,Ue.jsx)(ye,{path:"/tasks",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(St,{})})]})}),(0,Ue.jsx)(ye,{path:"/change-password",element:(0,Ue.jsxs)(Ve,{children:[(0,Ue.jsx)(Qe,{}),(0,Ue.jsx)("div",{className:"container mx-auto p-8",children:(0,Ue.jsx)(Ct,{})})]})})]})})})})};console.log("index.js loaded");const Pt=document.getElementById("root");if(console.log("Root element:",Pt),Pt){const e=l.createRoot(Pt);console.log("Rendering App..."),e.render((0,Ue.jsx)(Et,{})),console.log("App render called")}else console.error("Root element not found!")})();
//# sourceMappingURL=main.9f5cb466.js.map